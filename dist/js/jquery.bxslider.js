!function(t){var e={mode:"horizontal",slideSelector:"",infiniteLoop:!0,hideControlOnEnd:!1,speed:500,easing:null,slideMargin:0,startSlide:0,randomStart:!1,captions:!1,ticker:!1,tickerHover:!1,adaptiveHeight:!1,adaptiveHeightSpeed:500,video:!1,useCSS:!0,preloadImages:"visible",responsive:!0,slideZIndex:50,wrapperClass:"bx-wrapper",touchEnabled:!0,swipeThreshold:50,oneToOneTouch:!0,preventDefaultSwipeX:!0,preventDefaultSwipeY:!1,ariaLive:!0,ariaHidden:!0,keyboardEnabled:!1,pager:!0,pagerType:"full",pagerShortSeparator:" / ",pagerSelector:null,buildPager:null,pagerCustom:null,controls:!0,nextText:"Next",prevText:"Prev",nextSelector:null,prevSelector:null,autoControls:!1,startText:"Start",stopText:"Stop",autoControlsCombine:!1,autoControlsSelector:null,auto:!1,pause:4e3,autoStart:!0,autoDirection:"next",stopAutoOnClick:!1,autoHover:!1,autoDelay:0,autoSlideForOnePage:!1,minSlides:1,maxSlides:1,moveSlides:0,slideWidth:0,shrinkItems:!1,onSliderLoad:function(){return!0},onSlideBefore:function(){return!0},onSlideAfter:function(){return!0},onSlideNext:function(){return!0},onSlidePrev:function(){return!0},onSliderResize:function(){return!0}};t.fn.bxSlider=function(n){if(0===this.length)return this;if(this.length>1)return this.each(function(){t(this).bxSlider(n)}),this;var s={},o=this,r=t(window).width(),a=t(window).height();if(!t(o).data("bxSlider")){var l=function(){t(o).data("bxSlider")||(s.settings=t.extend({},e,n),s.settings.slideWidth=parseInt(s.settings.slideWidth),s.children=o.children(s.settings.slideSelector),s.children.length<s.settings.minSlides&&(s.settings.minSlides=s.children.length),s.children.length<s.settings.maxSlides&&(s.settings.maxSlides=s.children.length),s.settings.randomStart&&(s.settings.startSlide=Math.floor(Math.random()*s.children.length)),s.active={index:s.settings.startSlide},s.carousel=s.settings.minSlides>1||s.settings.maxSlides>1,s.carousel&&(s.settings.preloadImages="all"),s.minThreshold=s.settings.minSlides*s.settings.slideWidth+(s.settings.minSlides-1)*s.settings.slideMargin,s.maxThreshold=s.settings.maxSlides*s.settings.slideWidth+(s.settings.maxSlides-1)*s.settings.slideMargin,s.working=!1,s.controls={},s.interval=null,s.animProp="vertical"===s.settings.mode?"top":"left",s.usingCSS=s.settings.useCSS&&"fade"!==s.settings.mode&&function(){for(var t=document.createElement("div"),e=["WebkitPerspective","MozPerspective","OPerspective","msPerspective"],i=0;i<e.length;i++)if(void 0!==t.style[e[i]])return s.cssPrefix=e[i].replace("Perspective","").toLowerCase(),s.animProp="-"+s.cssPrefix+"-transform",!0;return!1}(),"vertical"===s.settings.mode&&(s.settings.maxSlides=s.settings.minSlides),o.data("origStyle",o.attr("style")),o.children(s.settings.slideSelector).each(function(){t(this).data("origStyle",t(this).attr("style"))}),d())},d=function(){var e=s.children.eq(s.settings.startSlide);o.wrap('<div class="'+s.settings.wrapperClass+'"><div class="bx-viewport"></div></div>'),s.viewport=o.parent(),s.settings.ariaLive&&!s.settings.ticker&&s.viewport.attr("aria-live","polite"),s.loader=t('<div class="bx-loading" />'),s.viewport.prepend(s.loader),o.css({width:"horizontal"===s.settings.mode?1e3*s.children.length+215+"%":"auto",position:"relative"}),s.usingCSS&&s.settings.easing?o.css("-"+s.cssPrefix+"-transition-timing-function",s.settings.easing):s.settings.easing||(s.settings.easing="swing"),s.viewport.css({width:"100%",overflow:"hidden",position:"relative"}),s.viewport.parent().css({maxWidth:h()}),s.children.css({float:"horizontal"===s.settings.mode?"left":"none",listStyle:"none",position:"relative"}),s.children.css("width",u()),"horizontal"===s.settings.mode&&s.settings.slideMargin>0&&s.children.css("marginRight",s.settings.slideMargin),"vertical"===s.settings.mode&&s.settings.slideMargin>0&&s.children.css("marginBottom",s.settings.slideMargin),"fade"===s.settings.mode&&(s.children.css({position:"absolute",zIndex:0,display:"none"}),s.children.eq(s.settings.startSlide).css({zIndex:s.settings.slideZIndex,display:"block"})),s.controls.el=t('<div class="bx-controls" />'),s.settings.captions&&P(),s.active.last=s.settings.startSlide===f()-1,s.settings.video&&o.fitVids(),("all"===s.settings.preloadImages||s.settings.ticker)&&(e=s.children),s.settings.ticker?s.settings.pager=!1:(s.settings.controls&&C(),s.settings.auto&&s.settings.autoControls&&T(),s.settings.pager&&w(),(s.settings.controls||s.settings.autoControls||s.settings.pager)&&s.viewport.after(s.controls.el)),c(e,g)},c=function(e,i){var n=e.find('img:not([src=""]), iframe').length,s=0;0!==n?e.find('img:not([src=""]), iframe').each(function(){t(this).one("load error",function(){++s===n&&i()}).each(function(){this.complete&&t(this).trigger("load")})}):i()},g=function(){if(s.settings.infiniteLoop&&"fade"!==s.settings.mode&&!s.settings.ticker){var e="vertical"===s.settings.mode?s.settings.minSlides:s.settings.maxSlides,i=s.children.slice(0,e).clone(!0).addClass("bx-clone"),n=s.children.slice(-e).clone(!0).addClass("bx-clone");s.settings.ariaHidden&&(i.attr("aria-hidden",!0),n.attr("aria-hidden",!0)),o.append(i).prepend(n)}s.loader.remove(),m(),"vertical"===s.settings.mode&&(s.settings.adaptiveHeight=!0),s.viewport.height(p()),o.redrawSlider(),s.settings.onSliderLoad.call(o,s.active.index),s.initialized=!0,s.settings.responsive&&t(window).bind("resize",Z),s.settings.auto&&s.settings.autoStart&&(f()>1||s.settings.autoSlideForOnePage)&&H(),s.settings.ticker&&W(),s.settings.pager&&I(s.settings.startSlide),s.settings.controls&&D(),s.settings.touchEnabled&&!s.settings.ticker&&N(),s.settings.keyboardEnabled&&!s.settings.ticker&&t(document).keydown(F)},p=function(){var e=0,n=t();if("vertical"===s.settings.mode||s.settings.adaptiveHeight)if(s.carousel){var o=1===s.settings.moveSlides?s.active.index:s.active.index*x();for(n=s.children.eq(o),i=1;i<=s.settings.maxSlides-1;i++)n=o+i>=s.children.length?n.add(s.children.eq(i-1)):n.add(s.children.eq(o+i))}else n=s.children.eq(s.active.index);else n=s.children;return"vertical"===s.settings.mode?(n.each(function(i){e+=t(this).outerHeight()}),s.settings.slideMargin>0&&(e+=s.settings.slideMargin*(s.settings.minSlides-1))):e=Math.max.apply(Math,n.map(function(){return t(this).outerHeight(!1)}).get()),"border-box"===s.viewport.css("box-sizing")?e+=parseFloat(s.viewport.css("padding-top"))+parseFloat(s.viewport.css("padding-bottom"))+parseFloat(s.viewport.css("border-top-width"))+parseFloat(s.viewport.css("border-bottom-width")):"padding-box"===s.viewport.css("box-sizing")&&(e+=parseFloat(s.viewport.css("padding-top"))+parseFloat(s.viewport.css("padding-bottom"))),e},h=function(){var t="100%";return s.settings.slideWidth>0&&(t="horizontal"===s.settings.mode?s.settings.maxSlides*s.settings.slideWidth+(s.settings.maxSlides-1)*s.settings.slideMargin:s.settings.slideWidth),t},u=function(){var t=s.settings.slideWidth,e=s.viewport.width();if(0===s.settings.slideWidth||s.settings.slideWidth>e&&!s.carousel||"vertical"===s.settings.mode)t=e;else if(s.settings.maxSlides>1&&"horizontal"===s.settings.mode){if(e>s.maxThreshold)return t;e<s.minThreshold?t=(e-s.settings.slideMargin*(s.settings.minSlides-1))/s.settings.minSlides:s.settings.shrinkItems&&(t=Math.floor((e+s.settings.slideMargin)/Math.ceil((e+s.settings.slideMargin)/(t+s.settings.slideMargin))-s.settings.slideMargin))}return t},v=function(){var t=1,e=null;return"horizontal"===s.settings.mode&&s.settings.slideWidth>0?s.viewport.width()<s.minThreshold?t=s.settings.minSlides:s.viewport.width()>s.maxThreshold?t=s.settings.maxSlides:(e=s.children.first().width()+s.settings.slideMargin,t=Math.floor((s.viewport.width()+s.settings.slideMargin)/e)):"vertical"===s.settings.mode&&(t=s.settings.minSlides),t},f=function(){var t=0,e=0,i=0;if(s.settings.moveSlides>0)if(s.settings.infiniteLoop)t=Math.ceil(s.children.length/x());else for(;e<s.children.length;)++t,e=i+v(),i+=s.settings.moveSlides<=v()?s.settings.moveSlides:v();else t=Math.ceil(s.children.length/v());return t},x=function(){return s.settings.moveSlides>0&&s.settings.moveSlides<=v()?s.settings.moveSlides:v()},m=function(){var t,e,i;s.children.length>s.settings.maxSlides&&s.active.last&&!s.settings.infiniteLoop?"horizontal"===s.settings.mode?(t=(e=s.children.last()).position(),S(-(t.left-(s.viewport.width()-e.outerWidth())),"reset",0)):"vertical"===s.settings.mode&&(i=s.children.length-s.settings.minSlides,t=s.children.eq(i).position(),S(-t.top,"reset",0)):(t=s.children.eq(s.active.index*x()).position(),s.active.index===f()-1&&(s.active.last=!0),void 0!==t&&("horizontal"===s.settings.mode?S(-t.left,"reset",0):"vertical"===s.settings.mode&&S(-t.top,"reset",0)))},S=function(e,i,n,r){var a,l;s.usingCSS?(l="vertical"===s.settings.mode?"translate3d(0, "+e+"px, 0)":"translate3d("+e+"px, 0, 0)",o.css("-"+s.cssPrefix+"-transition-duration",n/1e3+"s"),"slide"===i?(o.css(s.animProp,l),0!==n?o.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(e){t(e.target).is(o)&&(o.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd"),q())}):q()):"reset"===i?o.css(s.animProp,l):"ticker"===i&&(o.css("-"+s.cssPrefix+"-transition-timing-function","linear"),o.css(s.animProp,l),0!==n?o.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(e){t(e.target).is(o)&&(o.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd"),S(r.resetValue,"reset",0),L())}):(S(r.resetValue,"reset",0),L()))):((a={})[s.animProp]=e,"slide"===i?o.animate(a,n,s.settings.easing,function(){q()}):"reset"===i?o.css(s.animProp,e):"ticker"===i&&o.animate(a,n,"linear",function(){S(r.resetValue,"reset",0),L()}))},b=function(){for(var e="",i="",n=f(),o=0;o<n;o++)i="",s.settings.buildPager&&t.isFunction(s.settings.buildPager)||s.settings.pagerCustom?(i=s.settings.buildPager(o),s.pagerEl.addClass("bx-custom-pager")):(i=o+1,s.pagerEl.addClass("bx-default-pager")),e+='<div class="bx-pager-item"><a href="" data-slide-index="'+o+'" class="bx-pager-link">'+i+"</a></div>";s.pagerEl.html(e)},w=function(){s.settings.pagerCustom?s.pagerEl=t(s.settings.pagerCustom):(s.pagerEl=t('<div class="bx-pager" />'),s.settings.pagerSelector?t(s.settings.pagerSelector).html(s.pagerEl):s.controls.el.addClass("bx-has-pager").append(s.pagerEl),b()),s.pagerEl.on("click touchend","a",z)},C=function(){s.controls.next=t('<a class="bx-next" href="">'+s.settings.nextText+"</a>"),s.controls.prev=t('<a class="bx-prev" href="">'+s.settings.prevText+"</a>"),s.controls.next.bind("click touchend",E),s.controls.prev.bind("click touchend",k),s.settings.nextSelector&&t(s.settings.nextSelector).append(s.controls.next),s.settings.prevSelector&&t(s.settings.prevSelector).append(s.controls.prev),s.settings.nextSelector||s.settings.prevSelector||(s.controls.directionEl=t('<div class="bx-controls-direction" />'),s.controls.directionEl.append(s.controls.prev).append(s.controls.next),s.controls.el.addClass("bx-has-controls-direction").append(s.controls.directionEl))},T=function(){s.controls.start=t('<div class="bx-controls-auto-item"><a class="bx-start" href="">'+s.settings.startText+"</a></div>"),s.controls.stop=t('<div class="bx-controls-auto-item"><a class="bx-stop" href="">'+s.settings.stopText+"</a></div>"),s.controls.autoEl=t('<div class="bx-controls-auto" />'),s.controls.autoEl.on("click",".bx-start",M),s.controls.autoEl.on("click",".bx-stop",y),s.settings.autoControlsCombine?s.controls.autoEl.append(s.controls.start):s.controls.autoEl.append(s.controls.start).append(s.controls.stop),s.settings.autoControlsSelector?t(s.settings.autoControlsSelector).html(s.controls.autoEl):s.controls.el.addClass("bx-has-controls-auto").append(s.controls.autoEl),A(s.settings.autoStart?"stop":"start")},P=function(){s.children.each(function(e){var i=t(this).find("img:first").attr("title");void 0!==i&&(""+i).length&&t(this).append('<div class="bx-caption"><span>'+i+"</span></div>")})},E=function(t){t.preventDefault(),s.controls.el.hasClass("disabled")||(s.settings.auto&&s.settings.stopAutoOnClick&&o.stopAuto(),o.goToNextSlide())},k=function(t){t.preventDefault(),s.controls.el.hasClass("disabled")||(s.settings.auto&&s.settings.stopAutoOnClick&&o.stopAuto(),o.goToPrevSlide())},M=function(t){o.startAuto(),t.preventDefault()},y=function(t){o.stopAuto(),t.preventDefault()},z=function(e){var i,n;e.preventDefault(),s.controls.el.hasClass("disabled")||(s.settings.auto&&s.settings.stopAutoOnClick&&o.stopAuto(),void 0!==(i=t(e.currentTarget)).attr("data-slide-index")&&(n=parseInt(i.attr("data-slide-index")))!==s.active.index&&o.goToSlide(n))},I=function(e){var i=s.children.length;if("short"===s.settings.pagerType)return s.settings.maxSlides>1&&(i=Math.ceil(s.children.length/s.settings.maxSlides)),void s.pagerEl.html(e+1+s.settings.pagerShortSeparator+i);s.pagerEl.find("a").removeClass("active"),s.pagerEl.each(function(i,n){t(n).find("a").eq(e).addClass("active")})},q=function(){if(s.settings.infiniteLoop){var t="";0===s.active.index?t=s.children.eq(0).position():s.active.index===f()-1&&s.carousel?t=s.children.eq((f()-1)*x()).position():s.active.index===s.children.length-1&&(t=s.children.eq(s.children.length-1).position()),t&&("horizontal"===s.settings.mode?S(-t.left,"reset",0):"vertical"===s.settings.mode&&S(-t.top,"reset",0))}s.working=!1,s.settings.onSlideAfter.call(o,s.children.eq(s.active.index),s.oldIndex,s.active.index)},A=function(t){s.settings.autoControlsCombine?s.controls.autoEl.html(s.controls[t]):(s.controls.autoEl.find("a").removeClass("active"),s.controls.autoEl.find("a:not(.bx-"+t+")").addClass("active"))},D=function(){1===f()?(s.controls.prev.addClass("disabled"),s.controls.next.addClass("disabled")):!s.settings.infiniteLoop&&s.settings.hideControlOnEnd&&(0===s.active.index?(s.controls.prev.addClass("disabled"),s.controls.next.removeClass("disabled")):s.active.index===f()-1?(s.controls.next.addClass("disabled"),s.controls.prev.removeClass("disabled")):(s.controls.prev.removeClass("disabled"),s.controls.next.removeClass("disabled")))},H=function(){s.settings.autoDelay>0?setTimeout(o.startAuto,s.settings.autoDelay):(o.startAuto(),t(window).focus(function(){o.startAuto()}).blur(function(){o.stopAuto()})),s.settings.autoHover&&o.hover(function(){s.interval&&(o.stopAuto(!0),s.autoPaused=!0)},function(){s.autoPaused&&(o.startAuto(!0),s.autoPaused=null)})},W=function(){var e,i,n,r,a,l,d,c,g=0;"next"===s.settings.autoDirection?o.append(s.children.clone().addClass("bx-clone")):(o.prepend(s.children.clone().addClass("bx-clone")),e=s.children.first().position(),g="horizontal"===s.settings.mode?-e.left:-e.top),S(g,"reset",0),s.settings.pager=!1,s.settings.controls=!1,s.settings.autoControls=!1,s.settings.tickerHover&&(s.usingCSS?(r="horizontal"===s.settings.mode?4:5,s.viewport.hover(function(){i=o.css("-"+s.cssPrefix+"-transform"),n=parseFloat(i.split(",")[r]),S(n,"reset",0)},function(){c=0,s.children.each(function(e){c+="horizontal"===s.settings.mode?t(this).outerWidth(!0):t(this).outerHeight(!0)}),a=s.settings.speed/c,l="horizontal"===s.settings.mode?"left":"top",d=a*(c-Math.abs(parseInt(n))),L(d)})):s.viewport.hover(function(){o.stop()},function(){c=0,s.children.each(function(e){c+="horizontal"===s.settings.mode?t(this).outerWidth(!0):t(this).outerHeight(!0)}),a=s.settings.speed/c,l="horizontal"===s.settings.mode?"left":"top",d=a*(c-Math.abs(parseInt(o.css(l)))),L(d)})),L()},L=function(t){var e,i,n=t||s.settings.speed,r={left:0,top:0},a={left:0,top:0};"next"===s.settings.autoDirection?r=o.find(".bx-clone").first().position():a=s.children.first().position(),e="horizontal"===s.settings.mode?-r.left:-r.top,i="horizontal"===s.settings.mode?-a.left:-a.top,S(e,"ticker",n,{resetValue:i})},O=function(e){var i=t(window),n={top:i.scrollTop(),left:i.scrollLeft()},s=e.offset();return n.right=n.left+i.width(),n.bottom=n.top+i.height(),s.right=s.left+e.outerWidth(),s.bottom=s.top+e.outerHeight(),!(n.right<s.left||n.left>s.right||n.bottom<s.top||n.top>s.bottom)},F=function(t){var e=document.activeElement.tagName.toLowerCase();if(null==new RegExp(e,["i"]).exec("input|textarea")&&O(o)){if(39===t.keyCode)return E(t),!1;if(37===t.keyCode)return k(t),!1}},N=function(){s.touch={start:{x:0,y:0},end:{x:0,y:0}},s.viewport.bind("touchstart MSPointerDown pointerdown",X),s.viewport.on("click",".bxslider a",function(t){s.viewport.hasClass("click-disabled")&&(t.preventDefault(),s.viewport.removeClass("click-disabled"))})},X=function(t){if(s.controls.el.addClass("disabled"),s.working)t.preventDefault(),s.controls.el.removeClass("disabled");else{s.touch.originalPos=o.position();var e=t.originalEvent,i=void 0!==e.changedTouches?e.changedTouches:[e];s.touch.start.x=i[0].pageX,s.touch.start.y=i[0].pageY,s.viewport.get(0).setPointerCapture&&(s.pointerId=e.pointerId,s.viewport.get(0).setPointerCapture(s.pointerId)),s.viewport.bind("touchmove MSPointerMove pointermove",V),s.viewport.bind("touchend MSPointerUp pointerup",R),s.viewport.bind("MSPointerCancel pointercancel",Y)}},Y=function(t){S(s.touch.originalPos.left,"reset",0),s.controls.el.removeClass("disabled"),s.viewport.unbind("MSPointerCancel pointercancel",Y),s.viewport.unbind("touchmove MSPointerMove pointermove",V),s.viewport.unbind("touchend MSPointerUp pointerup",R),s.viewport.get(0).releasePointerCapture&&s.viewport.get(0).releasePointerCapture(s.pointerId)},V=function(t){var e=t.originalEvent,i=void 0!==e.changedTouches?e.changedTouches:[e],n=Math.abs(i[0].pageX-s.touch.start.x),o=Math.abs(i[0].pageY-s.touch.start.y),r=0,a=0;3*n>o&&s.settings.preventDefaultSwipeX?t.preventDefault():3*o>n&&s.settings.preventDefaultSwipeY&&t.preventDefault(),"fade"!==s.settings.mode&&s.settings.oneToOneTouch&&("horizontal"===s.settings.mode?(a=i[0].pageX-s.touch.start.x,r=s.touch.originalPos.left+a):(a=i[0].pageY-s.touch.start.y,r=s.touch.originalPos.top+a),S(r,"reset",0))},R=function(t){s.viewport.unbind("touchmove MSPointerMove pointermove",V),s.controls.el.removeClass("disabled");var e=t.originalEvent,i=void 0!==e.changedTouches?e.changedTouches:[e],n=0,r=0;s.touch.end.x=i[0].pageX,s.touch.end.y=i[0].pageY,"fade"===s.settings.mode?(r=Math.abs(s.touch.start.x-s.touch.end.x))>=s.settings.swipeThreshold&&(s.touch.start.x>s.touch.end.x?o.goToNextSlide():o.goToPrevSlide(),o.stopAuto()):("horizontal"===s.settings.mode?(r=s.touch.end.x-s.touch.start.x,n=s.touch.originalPos.left):(r=s.touch.end.y-s.touch.start.y,n=s.touch.originalPos.top),!s.settings.infiniteLoop&&(0===s.active.index&&r>0||s.active.last&&r<0)?S(n,"reset",200):Math.abs(r)>=s.settings.swipeThreshold?(r<0?o.goToNextSlide():o.goToPrevSlide(),o.stopAuto()):S(n,"reset",200)),s.viewport.unbind("touchend MSPointerUp pointerup",R),s.viewport.get(0).releasePointerCapture&&s.viewport.get(0).releasePointerCapture(s.pointerId)},Z=function(e){if(s.initialized)if(s.working)window.setTimeout(Z,10);else{var i=t(window).width(),n=t(window).height();r===i&&a===n||(r=i,a=n,o.redrawSlider(),s.settings.onSliderResize.call(o,s.active.index))}},B=function(t){var e=v();s.settings.ariaHidden&&!s.settings.ticker&&(s.children.attr("aria-hidden","true"),s.children.slice(t,t+e).attr("aria-hidden","false"))},U=function(t){return t<0?s.settings.infiniteLoop?f()-1:s.active.index:t>=f()?s.settings.infiniteLoop?0:s.active.index:t};return o.goToSlide=function(e,i){var n,r,a,l,d=!0,c=0,g={left:0,top:0},h=null;if(s.oldIndex=s.active.index,s.active.index=U(e),!s.working&&s.active.index!==s.oldIndex){if(s.working=!0,void 0!==(d=s.settings.onSlideBefore.call(o,s.children.eq(s.active.index),s.oldIndex,s.active.index))&&!d)return s.active.index=s.oldIndex,void(s.working=!1);"next"===i?s.settings.onSlideNext.call(o,s.children.eq(s.active.index),s.oldIndex,s.active.index)||(d=!1):"prev"===i&&(s.settings.onSlidePrev.call(o,s.children.eq(s.active.index),s.oldIndex,s.active.index)||(d=!1)),s.active.last=s.active.index>=f()-1,(s.settings.pager||s.settings.pagerCustom)&&I(s.active.index),s.settings.controls&&D(),"fade"===s.settings.mode?(s.settings.adaptiveHeight&&s.viewport.height()!==p()&&s.viewport.animate({height:p()},s.settings.adaptiveHeightSpeed),s.children.filter(":visible").fadeOut(s.settings.speed).css({zIndex:0}),s.children.eq(s.active.index).css("zIndex",s.settings.slideZIndex+1).fadeIn(s.settings.speed,function(){t(this).css("zIndex",s.settings.slideZIndex),q()})):(s.settings.adaptiveHeight&&s.viewport.height()!==p()&&s.viewport.animate({height:p()},s.settings.adaptiveHeightSpeed),!s.settings.infiniteLoop&&s.carousel&&s.active.last?"horizontal"===s.settings.mode?(g=(h=s.children.eq(s.children.length-1)).position(),c=s.viewport.width()-h.outerWidth()):(n=s.children.length-s.settings.minSlides,g=s.children.eq(n).position()):s.carousel&&s.active.last&&"prev"===i?(r=1===s.settings.moveSlides?s.settings.maxSlides-x():(f()-1)*x()-(s.children.length-s.settings.maxSlides),g=(h=o.children(".bx-clone").eq(r)).position()):"next"===i&&0===s.active.index?(g=o.find("> .bx-clone").eq(s.settings.maxSlides).position(),s.active.last=!1):e>=0&&(l=e*parseInt(x()),g=s.children.eq(l).position()),void 0!==g?(a="horizontal"===s.settings.mode?-(g.left-c):-g.top,S(a,"slide",s.settings.speed)):s.working=!1),s.settings.ariaHidden&&B(s.active.index*x())}},o.goToNextSlide=function(){if(s.settings.infiniteLoop||!s.active.last){var t=parseInt(s.active.index)+1;o.goToSlide(t,"next")}},o.goToPrevSlide=function(){if(s.settings.infiniteLoop||0!==s.active.index){var t=parseInt(s.active.index)-1;o.goToSlide(t,"prev")}},o.startAuto=function(t){s.interval||(s.interval=setInterval(function(){"next"===s.settings.autoDirection?o.goToNextSlide():o.goToPrevSlide()},s.settings.pause),s.settings.autoControls&&!0!==t&&A("stop"))},o.stopAuto=function(t){s.interval&&(clearInterval(s.interval),s.interval=null,s.settings.autoControls&&!0!==t&&A("start"))},o.getCurrentSlide=function(){return s.active.index},o.getCurrentSlideElement=function(){return s.children.eq(s.active.index)},o.getSlideElement=function(t){return s.children.eq(t)},o.getSlideCount=function(){return s.children.length},o.isWorking=function(){return s.working},o.redrawSlider=function(){s.children.add(o.find(".bx-clone")).outerWidth(u()),s.viewport.css("height",p()),s.settings.ticker||m(),s.active.last&&(s.active.index=f()-1),s.active.index>=f()&&(s.active.last=!0),s.settings.pager&&!s.settings.pagerCustom&&(b(),I(s.active.index)),s.settings.ariaHidden&&B(s.active.index*x())},o.destroySlider=function(){s.initialized&&(s.initialized=!1,t(".bx-clone",this).remove(),s.children.each(function(){void 0!==t(this).data("origStyle")?t(this).attr("style",t(this).data("origStyle")):t(this).removeAttr("style")}),void 0!==t(this).data("origStyle")?this.attr("style",t(this).data("origStyle")):t(this).removeAttr("style"),t(this).unwrap().unwrap(),s.controls.el&&s.controls.el.remove(),s.controls.next&&s.controls.next.remove(),s.controls.prev&&s.controls.prev.remove(),s.pagerEl&&s.settings.controls&&!s.settings.pagerCustom&&s.pagerEl.remove(),t(".bx-caption",this).remove(),s.controls.autoEl&&s.controls.autoEl.remove(),clearInterval(s.interval),s.settings.responsive&&t(window).unbind("resize",Z),s.settings.keyboardEnabled&&t(document).unbind("keydown",F),t(this).removeData("bxSlider"))},o.reloadSlider=function(e){void 0!==e&&(n=e),o.destroySlider(),l(),t(o).data("bxSlider",this)},l(),t(o).data("bxSlider",this),this}}}(jQuery);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpxdWVyeS5ieHNsaWRlci5qcyJdLCJuYW1lcyI6WyIkIiwiZGVmYXVsdHMiLCJtb2RlIiwic2xpZGVTZWxlY3RvciIsImluZmluaXRlTG9vcCIsImhpZGVDb250cm9sT25FbmQiLCJzcGVlZCIsImVhc2luZyIsInNsaWRlTWFyZ2luIiwic3RhcnRTbGlkZSIsInJhbmRvbVN0YXJ0IiwiY2FwdGlvbnMiLCJ0aWNrZXIiLCJ0aWNrZXJIb3ZlciIsImFkYXB0aXZlSGVpZ2h0IiwiYWRhcHRpdmVIZWlnaHRTcGVlZCIsInZpZGVvIiwidXNlQ1NTIiwicHJlbG9hZEltYWdlcyIsInJlc3BvbnNpdmUiLCJzbGlkZVpJbmRleCIsIndyYXBwZXJDbGFzcyIsInRvdWNoRW5hYmxlZCIsInN3aXBlVGhyZXNob2xkIiwib25lVG9PbmVUb3VjaCIsInByZXZlbnREZWZhdWx0U3dpcGVYIiwicHJldmVudERlZmF1bHRTd2lwZVkiLCJhcmlhTGl2ZSIsImFyaWFIaWRkZW4iLCJrZXlib2FyZEVuYWJsZWQiLCJwYWdlciIsInBhZ2VyVHlwZSIsInBhZ2VyU2hvcnRTZXBhcmF0b3IiLCJwYWdlclNlbGVjdG9yIiwiYnVpbGRQYWdlciIsInBhZ2VyQ3VzdG9tIiwiY29udHJvbHMiLCJuZXh0VGV4dCIsInByZXZUZXh0IiwibmV4dFNlbGVjdG9yIiwicHJldlNlbGVjdG9yIiwiYXV0b0NvbnRyb2xzIiwic3RhcnRUZXh0Iiwic3RvcFRleHQiLCJhdXRvQ29udHJvbHNDb21iaW5lIiwiYXV0b0NvbnRyb2xzU2VsZWN0b3IiLCJhdXRvIiwicGF1c2UiLCJhdXRvU3RhcnQiLCJhdXRvRGlyZWN0aW9uIiwic3RvcEF1dG9PbkNsaWNrIiwiYXV0b0hvdmVyIiwiYXV0b0RlbGF5IiwiYXV0b1NsaWRlRm9yT25lUGFnZSIsIm1pblNsaWRlcyIsIm1heFNsaWRlcyIsIm1vdmVTbGlkZXMiLCJzbGlkZVdpZHRoIiwic2hyaW5rSXRlbXMiLCJvblNsaWRlckxvYWQiLCJvblNsaWRlQmVmb3JlIiwib25TbGlkZUFmdGVyIiwib25TbGlkZU5leHQiLCJvblNsaWRlUHJldiIsIm9uU2xpZGVyUmVzaXplIiwiZm4iLCJieFNsaWRlciIsIm9wdGlvbnMiLCJ0aGlzIiwibGVuZ3RoIiwiZWFjaCIsInNsaWRlciIsImVsIiwid2luZG93V2lkdGgiLCJ3aW5kb3ciLCJ3aWR0aCIsIndpbmRvd0hlaWdodCIsImhlaWdodCIsImRhdGEiLCJpbml0Iiwic2V0dGluZ3MiLCJleHRlbmQiLCJwYXJzZUludCIsImNoaWxkcmVuIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwiYWN0aXZlIiwiaW5kZXgiLCJjYXJvdXNlbCIsIm1pblRocmVzaG9sZCIsIm1heFRocmVzaG9sZCIsIndvcmtpbmciLCJpbnRlcnZhbCIsImFuaW1Qcm9wIiwidXNpbmdDU1MiLCJkaXYiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJwcm9wcyIsImkiLCJzdHlsZSIsImNzc1ByZWZpeCIsInJlcGxhY2UiLCJ0b0xvd2VyQ2FzZSIsImF0dHIiLCJzZXR1cCIsInByZWxvYWRTZWxlY3RvciIsImVxIiwid3JhcCIsInZpZXdwb3J0IiwicGFyZW50IiwibG9hZGVyIiwicHJlcGVuZCIsImNzcyIsInBvc2l0aW9uIiwib3ZlcmZsb3ciLCJtYXhXaWR0aCIsImdldFZpZXdwb3J0TWF4V2lkdGgiLCJmbG9hdCIsImxpc3RTdHlsZSIsImdldFNsaWRlV2lkdGgiLCJ6SW5kZXgiLCJkaXNwbGF5IiwiYXBwZW5kQ2FwdGlvbnMiLCJsYXN0IiwiZ2V0UGFnZXJRdHkiLCJmaXRWaWRzIiwiYXBwZW5kQ29udHJvbHMiLCJhcHBlbmRDb250cm9sc0F1dG8iLCJhcHBlbmRQYWdlciIsImFmdGVyIiwibG9hZEVsZW1lbnRzIiwic3RhcnQiLCJzZWxlY3RvciIsImNhbGxiYWNrIiwidG90YWwiLCJmaW5kIiwiY291bnQiLCJvbmUiLCJjb21wbGV0ZSIsInRyaWdnZXIiLCJzbGljZSIsInNsaWNlQXBwZW5kIiwiY2xvbmUiLCJhZGRDbGFzcyIsInNsaWNlUHJlcGVuZCIsImFwcGVuZCIsInJlbW92ZSIsInNldFNsaWRlUG9zaXRpb24iLCJnZXRWaWV3cG9ydEhlaWdodCIsInJlZHJhd1NsaWRlciIsImNhbGwiLCJpbml0aWFsaXplZCIsImJpbmQiLCJyZXNpemVXaW5kb3ciLCJpbml0QXV0byIsImluaXRUaWNrZXIiLCJ1cGRhdGVQYWdlckFjdGl2ZSIsInVwZGF0ZURpcmVjdGlvbkNvbnRyb2xzIiwiaW5pdFRvdWNoIiwia2V5ZG93biIsImtleVByZXNzIiwiY3VycmVudEluZGV4IiwiZ2V0TW92ZUJ5IiwiYWRkIiwib3V0ZXJIZWlnaHQiLCJtYXgiLCJhcHBseSIsIm1hcCIsImdldCIsInBhcnNlRmxvYXQiLCJuZXdFbFdpZHRoIiwid3JhcFdpZHRoIiwiY2VpbCIsImdldE51bWJlclNsaWRlc1Nob3dpbmciLCJzbGlkZXNTaG93aW5nIiwiY2hpbGRXaWR0aCIsImZpcnN0IiwicGFnZXJRdHkiLCJicmVha1BvaW50IiwiY291bnRlciIsImxhc3RDaGlsZCIsImxhc3RTaG93aW5nSW5kZXgiLCJzZXRQb3NpdGlvblByb3BlcnR5IiwibGVmdCIsIm91dGVyV2lkdGgiLCJ0b3AiLCJ2YWx1ZSIsInR5cGUiLCJkdXJhdGlvbiIsInBhcmFtcyIsImFuaW1hdGVPYmoiLCJwcm9wVmFsdWUiLCJlIiwidGFyZ2V0IiwiaXMiLCJ1bmJpbmQiLCJ1cGRhdGVBZnRlclNsaWRlVHJhbnNpdGlvbiIsInJlc2V0VmFsdWUiLCJ0aWNrZXJMb29wIiwiYW5pbWF0ZSIsInBvcHVsYXRlUGFnZXIiLCJwYWdlckh0bWwiLCJsaW5rQ29udGVudCIsImlzRnVuY3Rpb24iLCJwYWdlckVsIiwiaHRtbCIsIm9uIiwiY2xpY2tQYWdlckJpbmQiLCJuZXh0IiwicHJldiIsImNsaWNrTmV4dEJpbmQiLCJjbGlja1ByZXZCaW5kIiwiZGlyZWN0aW9uRWwiLCJzdG9wIiwiYXV0b0VsIiwiY2xpY2tTdGFydEJpbmQiLCJjbGlja1N0b3BCaW5kIiwidXBkYXRlQXV0b0NvbnRyb2xzIiwidGl0bGUiLCJwcmV2ZW50RGVmYXVsdCIsImhhc0NsYXNzIiwic3RvcEF1dG8iLCJnb1RvTmV4dFNsaWRlIiwiZ29Ub1ByZXZTbGlkZSIsInN0YXJ0QXV0byIsInBhZ2VyTGluayIsInBhZ2VySW5kZXgiLCJjdXJyZW50VGFyZ2V0IiwiZ29Ub1NsaWRlIiwic2xpZGVJbmRleCIsImxlbiIsInJlbW92ZUNsYXNzIiwib2xkSW5kZXgiLCJzdGF0ZSIsInNldFRpbWVvdXQiLCJmb2N1cyIsImJsdXIiLCJob3ZlciIsImF1dG9QYXVzZWQiLCJ0cmFuc2Zvcm0iLCJpZHgiLCJyYXRpbyIsInByb3BlcnR5IiwibmV3U3BlZWQiLCJ0b3RhbERpbWVucyIsInN0YXJ0UG9zaXRpb24iLCJzcGxpdCIsImFicyIsInJlc3VtZVNwZWVkIiwiYW5pbWF0ZVByb3BlcnR5IiwicmVzZXQiLCJpc09uU2NyZWVuIiwid2luIiwic2Nyb2xsVG9wIiwic2Nyb2xsTGVmdCIsImJvdW5kcyIsIm9mZnNldCIsInJpZ2h0IiwiYm90dG9tIiwiYWN0aXZlRWxlbWVudFRhZyIsImFjdGl2ZUVsZW1lbnQiLCJ0YWdOYW1lIiwiUmVnRXhwIiwiZXhlYyIsImtleUNvZGUiLCJ0b3VjaCIsIngiLCJ5IiwiZW5kIiwib25Ub3VjaFN0YXJ0Iiwib3JpZ2luYWxQb3MiLCJvcmlnIiwib3JpZ2luYWxFdmVudCIsInRvdWNoUG9pbnRzIiwiY2hhbmdlZFRvdWNoZXMiLCJwYWdlWCIsInBhZ2VZIiwic2V0UG9pbnRlckNhcHR1cmUiLCJwb2ludGVySWQiLCJvblRvdWNoTW92ZSIsIm9uVG91Y2hFbmQiLCJvblBvaW50ZXJDYW5jZWwiLCJyZWxlYXNlUG9pbnRlckNhcHR1cmUiLCJ4TW92ZW1lbnQiLCJ5TW92ZW1lbnQiLCJjaGFuZ2UiLCJkaXN0YW5jZSIsIndpbmRvd1dpZHRoTmV3Iiwid2luZG93SGVpZ2h0TmV3IiwiYXBwbHlBcmlhSGlkZGVuQXR0cmlidXRlcyIsInN0YXJ0VmlzaWJsZUluZGV4IiwibnVtYmVyT2ZTbGlkZXNTaG93aW5nIiwic2V0U2xpZGVJbmRleCIsImRpcmVjdGlvbiIsInJlcXVlc3RFbCIsInBlcmZvcm1UcmFuc2l0aW9uIiwibW92ZUJ5IiwiZmlsdGVyIiwiZmFkZU91dCIsImZhZGVJbiIsImciLCJwcmV2ZW50Q29udHJvbFVwZGF0ZSIsInNldEludGVydmFsIiwiY2xlYXJJbnRlcnZhbCIsImdldEN1cnJlbnRTbGlkZSIsImdldEN1cnJlbnRTbGlkZUVsZW1lbnQiLCJnZXRTbGlkZUVsZW1lbnQiLCJnZXRTbGlkZUNvdW50IiwiaXNXb3JraW5nIiwiZGVzdHJveVNsaWRlciIsInJlbW92ZUF0dHIiLCJ1bndyYXAiLCJyZW1vdmVEYXRhIiwicmVsb2FkU2xpZGVyIiwialF1ZXJ5Il0sIm1hcHBpbmdzIjoiQ0FPQyxTQUFVQSxHQUVULElBQUlDLEdBR0ZDLEtBQU0sYUFDTkMsY0FBZSxHQUNmQyxjQUFBQSxFQUNBQyxrQkFBQUEsRUFDQUMsTUFBTyxJQUNQQyxPQUFRLEtBQ1JDLFlBQWEsRUFDYkMsV0FBWSxFQUNaQyxhQUFBQSxFQUNBQyxVQUFBQSxFQUNBQyxRQUFBQSxFQUNBQyxhQUFBQSxFQUNBQyxnQkFBQUEsRUFDQUMsb0JBQXFCLElBQ3JCQyxPQUFBQSxFQUNBQyxRQUFBQSxFQUNBQyxjQUFlLFVBQ2ZDLFlBQUFBLEVBQ0FDLFlBQWEsR0FDYkMsYUFBYyxhQUdkQyxjQUFBQSxFQUNBQyxlQUFnQixHQUNoQkMsZUFBQUEsRUFDQUMsc0JBQUFBLEVBQ0FDLHNCQUFBQSxFQUdBQyxVQUFBQSxFQUNBQyxZQUFBQSxFQUdBQyxpQkFBQUEsRUFHQUMsT0FBQUEsRUFDQUMsVUFBVyxPQUNYQyxvQkFBcUIsTUFDckJDLGNBQWUsS0FDZkMsV0FBWSxLQUNaQyxZQUFhLEtBR2JDLFVBQUFBLEVBQ0FDLFNBQVUsT0FDVkMsU0FBVSxPQUNWQyxhQUFjLEtBQ2RDLGFBQWMsS0FDZEMsY0FBQUEsRUFDQUMsVUFBVyxRQUNYQyxTQUFVLE9BQ1ZDLHFCQUFBQSxFQUNBQyxxQkFBc0IsS0FHdEJDLE1BQUFBLEVBQ0FDLE1BQU8sSUFDUEMs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LGlCQUFtQjdCLEVBQUVpRyxVQUFVb0csT0FBTyxVQUFXbkMsR0FFckVsSyxFQUFFb0UsTUFBTXNQLFdBQVcsY0FNckJsUCxFQUFHbVAsYUFBZSxTQUFTM08sUUFBQUEsSUFDckJBLElBQTBCYixFQUFVYSxHQUN4Q1IsRUFBRytPLGdCQUNIeE8sSUFFQS9FLEVBQUV3RSxHQUFJTSxLQUFLLFdBQVlWLE9BR3pCVyxJQUVBL0UsRUFBRXdFLEdBQUlNLEtBQUssV0FBWVYsTUFHaEJBLE9BNWpEVixDQStqREV3UCIsImZpbGUiOiJqcXVlcnkuYnhzbGlkZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIGJ4U2xpZGVyIHY0LjIuMTJcbiAqIENvcHlyaWdodCAyMDEzLTIwMTUgU3RldmVuIFdhbmRlcnNraVxuICogV3JpdHRlbiB3aGlsZSBkcmlua2luZyBCZWxnaWFuIGFsZXMgYW5kIGxpc3RlbmluZyB0byBqYXp6XG4gKiBMaWNlbnNlZCB1bmRlciBNSVQgKGh0dHA6Ly9vcGVuc291cmNlLm9yZy9saWNlbnNlcy9NSVQpXG4gKi9cblxuOyhmdW5jdGlvbigkKSB7XG5cbiAgdmFyIGRlZmF1bHRzID0ge1xuXG4gICAgLy8gR0VORVJBTFxuICAgIG1vZGU6ICdob3Jpem9udGFsJyxcbiAgICBzbGlkZVNlbGVjdG9yOiAnJyxcbiAgICBpbmZpbml0ZUxvb3A6IHRydWUsXG4gICAgaGlkZUNvbnRyb2xPbkVuZDogZmFsc2UsXG4gICAgc3BlZWQ6IDUwMCxcbiAgICBlYXNpbmc6IG51bGwsXG4gICAgc2xpZGVNYXJnaW46IDAsXG4gICAgc3RhcnRTbGlkZTogMCxcbiAgICByYW5kb21TdGFydDogZmFsc2UsXG4gICAgY2FwdGlvbnM6IGZhbHNlLFxuICAgIHRpY2tlcjogZmFsc2UsXG4gICAgdGlja2VySG92ZXI6IGZhbHNlLFxuICAgIGFkYXB0aXZlSGVpZ2h0OiBmYWxzZSxcbiAgICBhZGFwdGl2ZUhlaWdodFNwZWVkOiA1MDAsXG4gICAgdmlkZW86IGZhbHNlLFxuICAgIHVzZUNTUzogdHJ1ZSxcbiAgICBwcmVsb2FkSW1hZ2VzOiAndmlzaWJsZScsXG4gICAgcmVzcG9uc2l2ZTogdHJ1ZSxcbiAgICBzbGlkZVpJbmRleDogNTAsXG4gICAgd3JhcHBlckNsYXNzOiAnYngtd3JhcHBlcicsXG5cbiAgICAvLyBUT1VDSFxuICAgIHRvdWNoRW5hYmxlZDogdHJ1ZSxcbiAgICBzd2lwZVRocmVzaG9sZDogNTAsXG4gICAgb25lVG9PbmVUb3VjaDogdHJ1ZSxcbiAgICBwcmV2ZW50RGVmYXVsdFN3aXBlWDogdHJ1ZSxcbiAgICBwcmV2ZW50RGVmYXVsdFN3aXBlWTogZmFsc2UsXG5cbiAgICAvLyBBQ0NFU1NJQklMSVRZXG4gICAgYXJpYUxpdmU6IHRydWUsXG4gICAgYXJpYUhpZGRlbjogdHJ1ZSxcblxuICAgIC8vIEtFWUJPQVJEXG4gICAga2V5Ym9hcmRFbmFibGVkOiBmYWxzZSxcblxuICAgIC8vIFBBR0VSXG4gICAgcGFnZXI6IHRydWUsXG4gICAgcGFnZXJUeXBlOiAnZnVsbCcsXG4gICAgcGFnZXJTaG9ydFNlcGFyYXRvcjogJyAvICcsXG4gICAgcGFnZXJTZWxlY3RvcjogbnVsbCxcbiAgICBidWlsZFBhZ2VyOiBudWxsLFxuICAgIHBhZ2VyQ3VzdG9tOiBudWxsLFxuXG4gICAgLy8gQ09OVFJPTFNcbiAgICBjb250cm9sczogdHJ1ZSxcbiAgICBuZXh0VGV4dDogJ05leHQnLFxuICAgIHByZXZUZXh0OiAnUHJldicsXG4gICAgbmV4dFNlbGVjdG9yOiBudWxsLFxuICAgIHByZXZTZWxlY3RvcjogbnVsbCxcbiAgICBhdXRvQ29udHJvbHM6IGZhbHNlLFxuICAgIHN0YXJ0VGV4dDogJ1N0YXJ0JyxcbiAgICBzdG9wVGV4dDogJ1N0b3AnLFxuICAgIGF1dG9Db250cm9sc0NvbWJpbmU6IGZhbHNlLFxuICAgIGF1dG9Db250cm9sc1NlbGVjdG9yOiBudWxsLFxuXG4gICAgLy8gQVVUT1xuICAgIGF1dG86IGZhbHNlLFxuICAgIHBhdXNlOiA0MDAwLFxuICAgIGF1dG9TdGFydDogdHJ1ZSxcbiAgICBhdXRvRGlyZWN0aW9uOiAnbmV4dCcsXG4gICAgc3RvcEF1dG9PbkNsaWNrOiBmYWxzZSxcbiAgICBhdXRvSG92ZXI6IGZhbHNlLFxuICAgIGF1dG9EZWxheTogMCxcbiAgICBhdXRvU2xpZGVGb3JPbmVQYWdlOiBmYWxzZSxcblxuICAgIC8vIENBUk9VU0VMXG4gICAgbWluU2xpZGVzOiAxLFxuICAgIG1heFNsaWRlczogMSxcbiAgICBtb3ZlU2xpZGVzOiAwLFxuICAgIHNsaWRlV2lkdGg6IDAsXG4gICAgc2hyaW5rSXRlbXM6IGZhbHNlLFxuXG4gICAgLy8gQ0FMTEJBQ0tTXG4gICAgb25TbGlkZXJMb2FkOiBmdW5jdGlvbigpIHsgcmV0dXJuIHRydWU7IH0sXG4gICAgb25TbGlkZUJlZm9yZTogZnVuY3Rpb24oKSB7IHJldHVybiB0cnVlOyB9LFxuICAgIG9uU2xpZGVBZnRlcjogZnVuY3Rpb24oKSB7IHJldHVybiB0cnVlOyB9LFxuICAgIG9uU2xpZGVOZXh0OiBmdW5jdGlvbigpIHsgcmV0dXJuIHRydWU7IH0sXG4gICAgb25TbGlkZVByZXY6IGZ1bmN0aW9uKCkgeyByZXR1cm4gdHJ1ZTsgfSxcbiAgICBvblNsaWRlclJlc2l6ZTogZnVuY3Rpb24oKSB7IHJldHVybiB0cnVlOyB9XG4gIH07XG5cbiAgJC5mbi5ieFNsaWRlciA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblxuICAgIGlmICh0aGlzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLy8gc3VwcG9ydCBtdWx0aXBsZSBlbGVtZW50c1xuICAgIGlmICh0aGlzLmxlbmd0aCA+IDEpIHtcbiAgICAgIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgJCh0aGlzKS5ieFNsaWRlcihvcHRpb25zKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLy8gY3JlYXRlIGEgbmFtZXNwYWNlIHRvIGJlIHVzZWQgdGhyb3VnaG91dCB0aGUgcGx1Z2luXG4gICAgdmFyIHNsaWRlciA9IHt9LFxuICAgIC8vIHNldCBhIHJlZmVyZW5jZSB0byBvdXIgc2xpZGVyIGVsZW1lbnRcbiAgICBlbCA9IHRoaXMsXG4gICAgLy8gZ2V0IHRoZSBvcmlnaW5hbCB3aW5kb3cgZGltZW5zICh0aGFua3MgYSBsb3QgSUUpXG4gICAgd2luZG93V2lkdGggPSAkKHdpbmRvdykud2lkdGgoKSxcbiAgICB3aW5kb3dIZWlnaHQgPSAkKHdpbmRvdykuaGVpZ2h0KCk7XG5cbiAgICAvLyBSZXR1cm4gaWYgc2xpZGVyIGlzIGFscmVhZHkgaW5pdGlhbGl6ZWRcbiAgICBpZiAoJChlbCkuZGF0YSgnYnhTbGlkZXInKSkgeyByZXR1cm47IH1cblxuICAgIC8qKlxuICAgICAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICogPSBQUklWQVRFIEZVTkNUSU9OU1xuICAgICAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICovXG5cbiAgICAvKipcbiAgICAgKiBJbml0aWFsaXplcyBuYW1lc3BhY2Ugc2V0dGluZ3MgdG8gYmUgdXNlZCB0aHJvdWdob3V0IHBsdWdpblxuICAgICAqL1xuICAgIHZhciBpbml0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAvLyBSZXR1cm4gaWYgc2xpZGVyIGlzIGFscmVhZHkgaW5pdGlhbGl6ZWRcbiAgICAgIGlmICgkKGVsKS5kYXRhKCdieFNsaWRlcicpKSB7IHJldHVybjsgfVxuICAgICAgLy8gbWVyZ2UgdXNlci1zdXBwbGllZCBvcHRpb25zIHdpdGggdGhlIGRlZmF1bHRzXG4gICAgICBzbGlkZXIuc2V0dGluZ3MgPSAkLmV4dGVuZCh7fSwgZGVmYXVsdHMsIG9wdGlvbnMpO1xuICAgICAgLy8gcGFyc2Ugc2xpZGVXaWR0aCBzZXR0aW5nXG4gICAgICBzbGlkZXIuc2V0dGluZ3Muc2xpZGVXaWR0aCA9IHBhcnNlSW50KHNsaWRlci5zZXR0aW5ncy5zbGlkZVdpZHRoKTtcbiAgICAgIC8vIHN0b3JlIHRoZSBvcmlnaW5hbCBjaGlsZHJlblxuICAgICAgc2xpZGVyLmNoaWxkcmVuID0gZWwuY2hpbGRyZW4oc2xpZGVyLnNldHRpbmdzLnNsaWRlU2VsZWN0b3IpO1xuICAgICAgLy8gY2hlY2sgaWYgYWN0dWFsIG51bWJlciBvZiBzbGlkZXMgaXMgbGVzcyB0aGFuIG1pblNsaWRlcyAvIG1heFNsaWRlc1xuICAgICAgaWYgKHNsaWRlci5jaGlsZHJlbi5sZW5ndGggPCBzbGlkZXIuc2V0dGluZ3MubWluU2xpZGVzKSB7IHNsaWRlci5zZXR0aW5ncy5taW5TbGlkZXMgPSBzbGlkZXIuY2hpbGRyZW4ubGVuZ3RoOyB9XG4gICAgICBpZiAoc2xpZGVyLmNoaWxkcmVuLmxlbmd0aCA8IHNsaWRlci5zZXR0aW5ncy5tYXhTbGlkZXMpIHsgc2xpZGVyLnNldHRpbmdzLm1heFNsaWRlcyA9IHNsaWRlci5jaGlsZHJlbi5sZW5ndGg7IH1cbiAgICAgIC8vIGlmIHJhbmRvbSBzdGFydCwgc2V0IHRoZSBzdGFydFNsaWRlIHNldHRpbmcgdG8gcmFuZG9tIG51bWJlclxuICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5yYW5kb21TdGFydCkgeyBzbGlkZXIuc2V0dGluZ3Muc3RhcnRTbGlkZSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHNsaWRlci5jaGlsZHJlbi5sZW5ndGgpOyB9XG4gICAgICAvLyBzdG9yZSBhY3RpdmUgc2xpZGUgaW5mb3JtYXRpb25cbiAgICAgIHNsaWRlci5hY3RpdmUgPSB7IGluZGV4OiBzbGlkZXIuc2V0dGluZ3Muc3RhcnRTbGlkZSB9O1xuICAgICAgLy8gc3RvcmUgaWYgdGhlIHNsaWRlciBpcyBpbiBjYXJvdXNlbCBtb2RlIChkaXNwbGF5aW5nIC8gbW92aW5nIG11bHRpcGxlIHNsaWRlcylcbiAgICAgIHNsaWRlci5jYXJvdXNlbCA9IHNsaWRlci5zZXR0aW5ncy5taW5TbGlkZXMgPiAxIHx8IHNsaWRlci5zZXR0aW5ncy5tYXhTbGlkZXMgPiAxID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgLy8gaWYgY2Fyb3VzZWwsIGZvcmNlIHByZWxvYWRJbWFnZXMgPSAnYWxsJ1xuICAgICAgaWYgKHNsaWRlci5jYXJvdXNlbCkgeyBzbGlkZXIuc2V0dGluZ3MucHJlbG9hZEltYWdlcyA9ICdhbGwnOyB9XG4gICAgICAvLyBjYWxjdWxhdGUgdGhlIG1pbiAvIG1heCB3aWR0aCB0aHJlc2hvbGRzIGJhc2VkIG9uIG1pbiAvIG1heCBudW1iZXIgb2Ygc2xpZGVzXG4gICAgICAvLyB1c2VkIHRvIHNldHVwIGFuZCB1cGRhdGUgY2Fyb3VzZWwgc2xpZGVzIGRpbWVuc2lvbnNcbiAgICAgIHNsaWRlci5taW5UaHJlc2hvbGQgPSAoc2xpZGVyLnNldHRpbmdzLm1pblNsaWRlcyAqIHNsaWRlci5zZXR0aW5ncy5zbGlkZVdpZHRoKSArICgoc2xpZGVyLnNldHRpbmdzLm1pblNsaWRlcyAtIDEpICogc2xpZGVyLnNldHRpbmdzLnNsaWRlTWFyZ2luKTtcbiAgICAgIHNsaWRlci5tYXhUaHJlc2hvbGQgPSAoc2xpZGVyLnNldHRpbmdzLm1heFNsaWRlcyAqIHNsaWRlci5zZXR0aW5ncy5zbGlkZVdpZHRoKSArICgoc2xpZGVyLnNldHRpbmdzLm1heFNsaWRlcyAtIDEpICogc2xpZGVyLnNldHRpbmdzLnNsaWRlTWFyZ2luKTtcbiAgICAgIC8vIHN0b3JlIHRoZSBjdXJyZW50IHN0YXRlIG9mIHRoZSBzbGlkZXIgKGlmIGN1cnJlbnRseSBhbmltYXRpbmcsIHdvcmtpbmcgaXMgdHJ1ZSlcbiAgICAgIHNsaWRlci53b3JraW5nID0gZmFsc2U7XG4gICAgICAvLyBpbml0aWFsaXplIHRoZSBjb250cm9scyBvYmplY3RcbiAgICAgIHNsaWRlci5jb250cm9scyA9IHt9O1xuICAgICAgLy8gaW5pdGlhbGl6ZSBhbiBhdXRvIGludGVydmFsXG4gICAgICBzbGlkZXIuaW50ZXJ2YWwgPSBudWxsO1xuICAgICAgLy8gZGV0ZXJtaW5lIHdoaWNoIHByb3BlcnR5IHRvIHVzZSBmb3IgdHJhbnNpdGlvbnNcbiAgICAgIHNsaWRlci5hbmltUHJvcCA9IHNsaWRlci5zZXR0aW5ncy5tb2RlID09PSAndmVydGljYWwnID8gJ3RvcCcgOiAnbGVmdCc7XG4gICAgICAvLyBkZXRlcm1pbmUgaWYgaGFyZHdhcmUgYWNjZWxlcmF0aW9uIGNhbiBiZSB1c2VkXG4gICAgICBzbGlkZXIudXNpbmdDU1MgPSBzbGlkZXIuc2V0dGluZ3MudXNlQ1NTICYmIHNsaWRlci5zZXR0aW5ncy5tb2RlICE9PSAnZmFkZScgJiYgKGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBjcmVhdGUgb3VyIHRlc3QgZGl2IGVsZW1lbnRcbiAgICAgICAgdmFyIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpLFxuICAgICAgICAvLyBjc3MgdHJhbnNpdGlvbiBwcm9wZXJ0aWVzXG4gICAgICAgIHByb3BzID0gWydXZWJraXRQZXJzcGVjdGl2ZScsICdNb3pQZXJzcGVjdGl2ZScsICdPUGVyc3BlY3RpdmUnLCAnbXNQZXJzcGVjdGl2ZSddO1xuICAgICAgICAvLyB0ZXN0IGZvciBlYWNoIHByb3BlcnR5XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBpZiAoZGl2LnN0eWxlW3Byb3BzW2ldXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBzbGlkZXIuY3NzUHJlZml4ID0gcHJvcHNbaV0ucmVwbGFjZSgnUGVyc3BlY3RpdmUnLCAnJykudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIHNsaWRlci5hbmltUHJvcCA9ICctJyArIHNsaWRlci5jc3NQcmVmaXggKyAnLXRyYW5zZm9ybSc7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfSgpKTtcbiAgICAgIC8vIGlmIHZlcnRpY2FsIG1vZGUgYWx3YXlzIG1ha2UgbWF4U2xpZGVzIGFuZCBtaW5TbGlkZXMgZXF1YWxcbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MubW9kZSA9PT0gJ3ZlcnRpY2FsJykgeyBzbGlkZXIuc2V0dGluZ3MubWF4U2xpZGVzID0gc2xpZGVyLnNldHRpbmdzLm1pblNsaWRlczsgfVxuICAgICAgLy8gc2F2ZSBvcmlnaW5hbCBzdHlsZSBkYXRhXG4gICAgICBlbC5kYXRhKCdvcmlnU3R5bGUnLCBlbC5hdHRyKCdzdHlsZScpKTtcbiAgICAgIGVsLmNoaWxkcmVuKHNsaWRlci5zZXR0aW5ncy5zbGlkZVNlbGVjdG9yKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAkKHRoaXMpLmRhdGEoJ29yaWdTdHlsZScsICQodGhpcykuYXR0cignc3R5bGUnKSk7XG4gICAgICB9KTtcblxuICAgICAgLy8gcGVyZm9ybSBhbGwgRE9NIC8gQ1NTIG1vZGlmaWNhdGlvbnNcbiAgICAgIHNldHVwKCk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFBlcmZvcm1zIGFsbCBET00gYW5kIENTUyBtb2RpZmljYXRpb25zXG4gICAgICovXG4gICAgdmFyIHNldHVwID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcHJlbG9hZFNlbGVjdG9yID0gc2xpZGVyLmNoaWxkcmVuLmVxKHNsaWRlci5zZXR0aW5ncy5zdGFydFNsaWRlKTsgLy8gc2V0IHRoZSBkZWZhdWx0IHByZWxvYWQgc2VsZWN0b3IgKHZpc2libGUpXG5cbiAgICAgIC8vIHdyYXAgZWwgaW4gYSB3cmFwcGVyXG4gICAgICBlbC53cmFwKCc8ZGl2IGNsYXNzPVwiJyArIHNsaWRlci5zZXR0aW5ncy53cmFwcGVyQ2xhc3MgKyAnXCI+PGRpdiBjbGFzcz1cImJ4LXZpZXdwb3J0XCI+PC9kaXY+PC9kaXY+Jyk7XG4gICAgICAvLyBzdG9yZSBhIG5hbWVzcGFjZSByZWZlcmVuY2UgdG8gLmJ4LXZpZXdwb3J0XG4gICAgICBzbGlkZXIudmlld3BvcnQgPSBlbC5wYXJlbnQoKTtcblxuICAgICAgLy8gYWRkIGFyaWEtbGl2ZSBpZiB0aGUgc2V0dGluZyBpcyBlbmFibGVkIGFuZCB0aWNrZXIgbW9kZSBpcyBkaXNhYmxlZFxuICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5hcmlhTGl2ZSAmJiAhc2xpZGVyLnNldHRpbmdzLnRpY2tlcikge1xuICAgICAgICBzbGlkZXIudmlld3BvcnQuYXR0cignYXJpYS1saXZlJywgJ3BvbGl0ZScpO1xuICAgICAgfVxuICAgICAgLy8gYWRkIGEgbG9hZGluZyBkaXYgdG8gZGlzcGxheSB3aGlsZSBpbWFnZXMgYXJlIGxvYWRpbmdcbiAgICAgIHNsaWRlci5sb2FkZXIgPSAkKCc8ZGl2IGNsYXNzPVwiYngtbG9hZGluZ1wiIC8+Jyk7XG4gICAgICBzbGlkZXIudmlld3BvcnQucHJlcGVuZChzbGlkZXIubG9hZGVyKTtcbiAgICAgIC8vIHNldCBlbCB0byBhIG1hc3NpdmUgd2lkdGgsIHRvIGhvbGQgYW55IG5lZWRlZCBzbGlkZXNcbiAgICAgIC8vIGFsc28gc3RyaXAgYW55IG1hcmdpbiBhbmQgcGFkZGluZyBmcm9tIGVsXG4gICAgICBlbC5jc3Moe1xuICAgICAgICB3aWR0aDogc2xpZGVyLnNldHRpbmdzLm1vZGUgPT09ICdob3Jpem9udGFsJyA/IChzbGlkZXIuY2hpbGRyZW4ubGVuZ3RoICogMTAwMCArIDIxNSkgKyAnJScgOiAnYXV0bycsXG4gICAgICAgIHBvc2l0aW9uOiAncmVsYXRpdmUnXG4gICAgICB9KTtcbiAgICAgIC8vIGlmIHVzaW5nIENTUywgYWRkIHRoZSBlYXNpbmcgcHJvcGVydHlcbiAgICAgIGlmIChzbGlkZXIudXNpbmdDU1MgJiYgc2xpZGVyLnNldHRpbmdzLmVhc2luZykge1xuICAgICAgICBlbC5jc3MoJy0nICsgc2xpZGVyLmNzc1ByZWZpeCArICctdHJhbnNpdGlvbi10aW1pbmctZnVuY3Rpb24nLCBzbGlkZXIuc2V0dGluZ3MuZWFzaW5nKTtcbiAgICAgIC8vIGlmIG5vdCB1c2luZyBDU1MgYW5kIG5vIGVhc2luZyB2YWx1ZSB3YXMgc3VwcGxpZWQsIHVzZSB0aGUgZGVmYXVsdCBKUyBhbmltYXRpb24gZWFzaW5nIChzd2luZylcbiAgICAgIH0gZWxzZSBpZiAoIXNsaWRlci5zZXR0aW5ncy5lYXNpbmcpIHtcbiAgICAgICAgc2xpZGVyLnNldHRpbmdzLmVhc2luZyA9ICdzd2luZyc7XG4gICAgICB9XG4gICAgICAvLyBtYWtlIG1vZGlmaWNhdGlvbnMgdG8gdGhlIHZpZXdwb3J0ICguYngtdmlld3BvcnQpXG4gICAgICBzbGlkZXIudmlld3BvcnQuY3NzKHtcbiAgICAgICAgd2lkdGg6ICcxMDAlJyxcbiAgICAgICAgb3ZlcmZsb3c6ICdoaWRkZW4nLFxuICAgICAgICBwb3NpdGlvbjogJ3JlbGF0aXZlJ1xuICAgICAgfSk7XG4gICAgICBzbGlkZXIudmlld3BvcnQucGFyZW50KCkuY3NzKHtcbiAgICAgICAgbWF4V2lkdGg6IGdldFZpZXdwb3J0TWF4V2lkdGgoKVxuICAgICAgfSk7XG4gICAgICAvLyBhcHBseSBjc3MgdG8gYWxsIHNsaWRlciBjaGlsZHJlblxuICAgICAgc2xpZGVyLmNoaWxkcmVuLmNzcyh7XG4gICAgICAgIGZsb2F0OiBzbGlkZXIuc2V0dGluZ3MubW9kZSA9PT0gJ2hvcml6b250YWwnID8gJ2xlZnQnIDogJ25vbmUnLFxuICAgICAgICBsaXN0U3R5bGU6ICdub25lJyxcbiAgICAgICAgcG9zaXRpb246ICdyZWxhdGl2ZSdcbiAgICAgIH0pO1xuICAgICAgLy8gYXBwbHkgdGhlIGNhbGN1bGF0ZWQgd2lkdGggYWZ0ZXIgdGhlIGZsb2F0IGlzIGFwcGxpZWQgdG8gcHJldmVudCBzY3JvbGxiYXIgaW50ZXJmZXJlbmNlXG4gICAgICBzbGlkZXIuY2hpbGRyZW4uY3NzKCd3aWR0aCcsIGdldFNsaWRlV2lkdGgoKSk7XG4gICAgICAvLyBpZiBzbGlkZU1hcmdpbiBpcyBzdXBwbGllZCwgYWRkIHRoZSBjc3NcbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MubW9kZSA9PT0gJ2hvcml6b250YWwnICYmIHNsaWRlci5zZXR0aW5ncy5zbGlkZU1hcmdpbiA+IDApIHsgc2xpZGVyLmNoaWxkcmVuLmNzcygnbWFyZ2luUmlnaHQnLCBzbGlkZXIuc2V0dGluZ3Muc2xpZGVNYXJnaW4pOyB9XG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLm1vZGUgPT09ICd2ZXJ0aWNhbCcgJiYgc2xpZGVyLnNldHRpbmdzLnNsaWRlTWFyZ2luID4gMCkgeyBzbGlkZXIuY2hpbGRyZW4uY3NzKCdtYXJnaW5Cb3R0b20nLCBzbGlkZXIuc2V0dGluZ3Muc2xpZGVNYXJnaW4pOyB9XG4gICAgICAvLyBpZiBcImZhZGVcIiBtb2RlLCBhZGQgcG9zaXRpb25pbmcgYW5kIHotaW5kZXggQ1NTXG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLm1vZGUgPT09ICdmYWRlJykge1xuICAgICAgICBzbGlkZXIuY2hpbGRyZW4uY3NzKHtcbiAgICAgICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcbiAgICAgICAgICB6SW5kZXg6IDAsXG4gICAgICAgICAgZGlzcGxheTogJ25vbmUnXG4gICAgICAgIH0pO1xuICAgICAgICAvLyBwcmVwYXJlIHRoZSB6LWluZGV4IG9uIHRoZSBzaG93aW5nIGVsZW1lbnRcbiAgICAgICAgc2xpZGVyLmNoaWxkcmVuLmVxKHNsaWRlci5zZXR0aW5ncy5zdGFydFNsaWRlKS5jc3Moe3pJbmRleDogc2xpZGVyLnNldHRpbmdzLnNsaWRlWkluZGV4LCBkaXNwbGF5OiAnYmxvY2snfSk7XG4gICAgICB9XG4gICAgICAvLyBjcmVhdGUgYW4gZWxlbWVudCB0byBjb250YWluIGFsbCBzbGlkZXIgY29udHJvbHMgKHBhZ2VyLCBzdGFydCAvIHN0b3AsIGV0YylcbiAgICAgIHNsaWRlci5jb250cm9scy5lbCA9ICQoJzxkaXYgY2xhc3M9XCJieC1jb250cm9sc1wiIC8+Jyk7XG4gICAgICAvLyBpZiBjYXB0aW9ucyBhcmUgcmVxdWVzdGVkLCBhZGQgdGhlbVxuICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5jYXB0aW9ucykgeyBhcHBlbmRDYXB0aW9ucygpOyB9XG4gICAgICAvLyBjaGVjayBpZiBzdGFydFNsaWRlIGlzIGxhc3Qgc2xpZGVcbiAgICAgIHNsaWRlci5hY3RpdmUubGFzdCA9IHNsaWRlci5zZXR0aW5ncy5zdGFydFNsaWRlID09PSBnZXRQYWdlclF0eSgpIC0gMTtcbiAgICAgIC8vIGlmIHZpZGVvIGlzIHRydWUsIHNldCB1cCB0aGUgZml0VmlkcyBwbHVnaW5cbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MudmlkZW8pIHsgZWwuZml0VmlkcygpOyB9XG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLnByZWxvYWRJbWFnZXMgPT09ICdhbGwnIHx8IHNsaWRlci5zZXR0aW5ncy50aWNrZXIpIHsgcHJlbG9hZFNlbGVjdG9yID0gc2xpZGVyLmNoaWxkcmVuOyB9XG4gICAgICAvLyBvbmx5IGNoZWNrIGZvciBjb250cm9sIGFkZGl0aW9uIGlmIG5vdCBpbiBcInRpY2tlclwiIG1vZGVcbiAgICAgIGlmICghc2xpZGVyLnNldHRpbmdzLnRpY2tlcikge1xuICAgICAgICAvLyBpZiBjb250cm9scyBhcmUgcmVxdWVzdGVkLCBhZGQgdGhlbVxuICAgICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmNvbnRyb2xzKSB7IGFwcGVuZENvbnRyb2xzKCk7IH1cbiAgICAgICAgLy8gaWYgYXV0byBpcyB0cnVlLCBhbmQgYXV0byBjb250cm9scyBhcmUgcmVxdWVzdGVkLCBhZGQgdGhlbVxuICAgICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmF1dG8gJiYgc2xpZGVyLnNldHRpbmdzLmF1dG9Db250cm9scykgeyBhcHBlbmRDb250cm9sc0F1dG8oKTsgfVxuICAgICAgICAvLyBpZiBwYWdlciBpcyByZXF1ZXN0ZWQsIGFkZCBpdFxuICAgICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLnBhZ2VyKSB7IGFwcGVuZFBhZ2VyKCk7IH1cbiAgICAgICAgLy8gaWYgYW55IGNvbnRyb2wgb3B0aW9uIGlzIHJlcXVlc3RlZCwgYWRkIHRoZSBjb250cm9scyB3cmFwcGVyXG4gICAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MuY29udHJvbHMgfHwgc2xpZGVyLnNldHRpbmdzLmF1dG9Db250cm9scyB8fCBzbGlkZXIuc2V0dGluZ3MucGFnZXIpIHsgc2xpZGVyLnZpZXdwb3J0LmFmdGVyKHNsaWRlci5jb250cm9scy5lbCk7IH1cbiAgICAgIC8vIGlmIHRpY2tlciBtb2RlLCBkbyBub3QgYWxsb3cgYSBwYWdlclxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2xpZGVyLnNldHRpbmdzLnBhZ2VyID0gZmFsc2U7XG4gICAgICB9XG4gICAgICBsb2FkRWxlbWVudHMocHJlbG9hZFNlbGVjdG9yLCBzdGFydCk7XG4gICAgfTtcblxuICAgIHZhciBsb2FkRWxlbWVudHMgPSBmdW5jdGlvbihzZWxlY3RvciwgY2FsbGJhY2spIHtcbiAgICAgIHZhciB0b3RhbCA9IHNlbGVjdG9yLmZpbmQoJ2ltZzpub3QoW3NyYz1cIlwiXSksIGlmcmFtZScpLmxlbmd0aCxcbiAgICAgIGNvdW50ID0gMDtcbiAgICAgIGlmICh0b3RhbCA9PT0gMCkge1xuICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBzZWxlY3Rvci5maW5kKCdpbWc6bm90KFtzcmM9XCJcIl0pLCBpZnJhbWUnKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAkKHRoaXMpLm9uZSgnbG9hZCBlcnJvcicsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGlmICgrK2NvdW50ID09PSB0b3RhbCkgeyBjYWxsYmFjaygpOyB9XG4gICAgICAgIH0pLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaWYgKHRoaXMuY29tcGxldGUpIHsgJCh0aGlzKS50cmlnZ2VyKCdsb2FkJyk7IH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogU3RhcnQgdGhlIHNsaWRlclxuICAgICAqL1xuICAgIHZhciBzdGFydCA9IGZ1bmN0aW9uKCkge1xuICAgICAgLy8gaWYgaW5maW5pdGUgbG9vcCwgcHJlcGFyZSBhZGRpdGlvbmFsIHNsaWRlc1xuICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5pbmZpbml0ZUxvb3AgJiYgc2xpZGVyLnNldHRpbmdzLm1vZGUgIT09ICdmYWRlJyAmJiAhc2xpZGVyLnNldHRpbmdzLnRpY2tlcikge1xuICAgICAgICB2YXIgc2xpY2UgICAgPSBzbGlkZXIuc2V0dGluZ3MubW9kZSA9PT0gJ3ZlcnRpY2FsJyA/IHNsaWRlci5zZXR0aW5ncy5taW5TbGlkZXMgOiBzbGlkZXIuc2V0dGluZ3MubWF4U2xpZGVzLFxuICAgICAgICBzbGljZUFwcGVuZCAgPSBzbGlkZXIuY2hpbGRyZW4uc2xpY2UoMCwgc2xpY2UpLmNsb25lKHRydWUpLmFkZENsYXNzKCdieC1jbG9uZScpLFxuICAgICAgICBzbGljZVByZXBlbmQgPSBzbGlkZXIuY2hpbGRyZW4uc2xpY2UoLXNsaWNlKS5jbG9uZSh0cnVlKS5hZGRDbGFzcygnYngtY2xvbmUnKTtcbiAgICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5hcmlhSGlkZGVuKSB7XG4gICAgICAgICAgc2xpY2VBcHBlbmQuYXR0cignYXJpYS1oaWRkZW4nLCB0cnVlKTtcbiAgICAgICAgICBzbGljZVByZXBlbmQuYXR0cignYXJpYS1oaWRkZW4nLCB0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBlbC5hcHBlbmQoc2xpY2VBcHBlbmQpLnByZXBlbmQoc2xpY2VQcmVwZW5kKTtcbiAgICAgIH1cbiAgICAgIC8vIHJlbW92ZSB0aGUgbG9hZGluZyBET00gZWxlbWVudFxuICAgICAgc2xpZGVyLmxvYWRlci5yZW1vdmUoKTtcbiAgICAgIC8vIHNldCB0aGUgbGVmdCAvIHRvcCBwb3NpdGlvbiBvZiBcImVsXCJcbiAgICAgIHNldFNsaWRlUG9zaXRpb24oKTtcbiAgICAgIC8vIGlmIFwidmVydGljYWxcIiBtb2RlLCBhbHdheXMgdXNlIGFkYXB0aXZlSGVpZ2h0IHRvIHByZXZlbnQgb2RkIGJlaGF2aW9yXG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLm1vZGUgPT09ICd2ZXJ0aWNhbCcpIHsgc2xpZGVyLnNldHRpbmdzLmFkYXB0aXZlSGVpZ2h0ID0gdHJ1ZTsgfVxuICAgICAgLy8gc2V0IHRoZSB2aWV3cG9ydCBoZWlnaHRcbiAgICAgIHNsaWRlci52aWV3cG9ydC5oZWlnaHQoZ2V0Vmlld3BvcnRIZWlnaHQoKSk7XG4gICAgICAvLyBtYWtlIHN1cmUgZXZlcnl0aGluZyBpcyBwb3NpdGlvbmVkIGp1c3QgcmlnaHQgKHNhbWUgYXMgYSB3aW5kb3cgcmVzaXplKVxuICAgICAgZWwucmVkcmF3U2xpZGVyKCk7XG4gICAgICAvLyBvblNsaWRlckxvYWQgY2FsbGJhY2tcbiAgICAgIHNsaWRlci5zZXR0aW5ncy5vblNsaWRlckxvYWQuY2FsbChlbCwgc2xpZGVyLmFjdGl2ZS5pbmRleCk7XG4gICAgICAvLyBzbGlkZXIgaGFzIGJlZW4gZnVsbHkgaW5pdGlhbGl6ZWRcbiAgICAgIHNsaWRlci5pbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAvLyBiaW5kIHRoZSByZXNpemUgY2FsbCB0byB0aGUgd2luZG93XG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLnJlc3BvbnNpdmUpIHsgJCh3aW5kb3cpLmJpbmQoJ3Jlc2l6ZScsIHJlc2l6ZVdpbmRvdyk7IH1cbiAgICAgIC8vIGlmIGF1dG8gaXMgdHJ1ZSBhbmQgaGFzIG1vcmUgdGhhbiAxIHBhZ2UsIHN0YXJ0IHRoZSBzaG93XG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmF1dG8gJiYgc2xpZGVyLnNldHRpbmdzLmF1dG9TdGFydCAmJiAoZ2V0UGFnZXJRdHkoKSA+IDEgfHwgc2xpZGVyLnNldHRpbmdzLmF1dG9TbGlkZUZvck9uZVBhZ2UpKSB7IGluaXRBdXRvKCk7IH1cbiAgICAgIC8vIGlmIHRpY2tlciBpcyB0cnVlLCBzdGFydCB0aGUgdGlja2VyXG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLnRpY2tlcikgeyBpbml0VGlja2VyKCk7IH1cbiAgICAgIC8vIGlmIHBhZ2VyIGlzIHJlcXVlc3RlZCwgbWFrZSB0aGUgYXBwcm9wcmlhdGUgcGFnZXIgbGluayBhY3RpdmVcbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MucGFnZXIpIHsgdXBkYXRlUGFnZXJBY3RpdmUoc2xpZGVyLnNldHRpbmdzLnN0YXJ0U2xpZGUpOyB9XG4gICAgICAvLyBjaGVjayBmb3IgYW55IHVwZGF0ZXMgdG8gdGhlIGNvbnRyb2xzIChsaWtlIGhpZGVDb250cm9sT25FbmQgdXBkYXRlcylcbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MuY29udHJvbHMpIHsgdXBkYXRlRGlyZWN0aW9uQ29udHJvbHMoKTsgfVxuICAgICAgLy8gaWYgdG91Y2hFbmFibGVkIGlzIHRydWUsIHNldHVwIHRoZSB0b3VjaCBldmVudHNcbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MudG91Y2hFbmFibGVkICYmICFzbGlkZXIuc2V0dGluZ3MudGlja2VyKSB7IGluaXRUb3VjaCgpOyB9XG4gICAgICAvLyBpZiBrZXlib2FyZEVuYWJsZWQgaXMgdHJ1ZSwgc2V0dXAgdGhlIGtleWJvYXJkIGV2ZW50c1xuICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5rZXlib2FyZEVuYWJsZWQgJiYgIXNsaWRlci5zZXR0aW5ncy50aWNrZXIpIHtcbiAgICAgICAgJChkb2N1bWVudCkua2V5ZG93bihrZXlQcmVzcyk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGNhbGN1bGF0ZWQgaGVpZ2h0IG9mIHRoZSB2aWV3cG9ydCwgdXNlZCB0byBkZXRlcm1pbmUgZWl0aGVyIGFkYXB0aXZlSGVpZ2h0IG9yIHRoZSBtYXhIZWlnaHQgdmFsdWVcbiAgICAgKi9cbiAgICB2YXIgZ2V0Vmlld3BvcnRIZWlnaHQgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBoZWlnaHQgPSAwO1xuICAgICAgLy8gZmlyc3QgZGV0ZXJtaW5lIHdoaWNoIGNoaWxkcmVuIChzbGlkZXMpIHNob3VsZCBiZSB1c2VkIGluIG91ciBoZWlnaHQgY2FsY3VsYXRpb25cbiAgICAgIHZhciBjaGlsZHJlbiA9ICQoKTtcbiAgICAgIC8vIGlmIG1vZGUgaXMgbm90IFwidmVydGljYWxcIiBhbmQgYWRhcHRpdmVIZWlnaHQgaXMgZmFsc2UsIGluY2x1ZGUgYWxsIGNoaWxkcmVuXG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLm1vZGUgIT09ICd2ZXJ0aWNhbCcgJiYgIXNsaWRlci5zZXR0aW5ncy5hZGFwdGl2ZUhlaWdodCkge1xuICAgICAgICBjaGlsZHJlbiA9IHNsaWRlci5jaGlsZHJlbjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIGlmIG5vdCBjYXJvdXNlbCwgcmV0dXJuIHRoZSBzaW5nbGUgYWN0aXZlIGNoaWxkXG4gICAgICAgIGlmICghc2xpZGVyLmNhcm91c2VsKSB7XG4gICAgICAgICAgY2hpbGRyZW4gPSBzbGlkZXIuY2hpbGRyZW4uZXEoc2xpZGVyLmFjdGl2ZS5pbmRleCk7XG4gICAgICAgIC8vIGlmIGNhcm91c2VsLCByZXR1cm4gYSBzbGljZSBvZiBjaGlsZHJlblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIGdldCB0aGUgaW5kaXZpZHVhbCBzbGlkZSBpbmRleFxuICAgICAgICAgIHZhciBjdXJyZW50SW5kZXggPSBzbGlkZXIuc2V0dGluZ3MubW92ZVNsaWRlcyA9PT0gMSA/IHNsaWRlci5hY3RpdmUuaW5kZXggOiBzbGlkZXIuYWN0aXZlLmluZGV4ICogZ2V0TW92ZUJ5KCk7XG4gICAgICAgICAgLy8gYWRkIHRoZSBjdXJyZW50IHNsaWRlIHRvIHRoZSBjaGlsZHJlblxuICAgICAgICAgIGNoaWxkcmVuID0gc2xpZGVyLmNoaWxkcmVuLmVxKGN1cnJlbnRJbmRleCk7XG4gICAgICAgICAgLy8gY3ljbGUgdGhyb3VnaCB0aGUgcmVtYWluaW5nIFwic2hvd2luZ1wiIHNsaWRlc1xuICAgICAgICAgIGZvciAoaSA9IDE7IGkgPD0gc2xpZGVyLnNldHRpbmdzLm1heFNsaWRlcyAtIDE7IGkrKykge1xuICAgICAgICAgICAgLy8gaWYgbG9vcGVkIGJhY2sgdG8gdGhlIHN0YXJ0XG4gICAgICAgICAgICBpZiAoY3VycmVudEluZGV4ICsgaSA+PSBzbGlkZXIuY2hpbGRyZW4ubGVuZ3RoKSB7XG4gICAgICAgICAgICAgIGNoaWxkcmVuID0gY2hpbGRyZW4uYWRkKHNsaWRlci5jaGlsZHJlbi5lcShpIC0gMSkpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgY2hpbGRyZW4gPSBjaGlsZHJlbi5hZGQoc2xpZGVyLmNoaWxkcmVuLmVxKGN1cnJlbnRJbmRleCArIGkpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIC8vIGlmIFwidmVydGljYWxcIiBtb2RlLCBjYWxjdWxhdGUgdGhlIHN1bSBvZiB0aGUgaGVpZ2h0cyBvZiB0aGUgY2hpbGRyZW5cbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MubW9kZSA9PT0gJ3ZlcnRpY2FsJykge1xuICAgICAgICBjaGlsZHJlbi5lYWNoKGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgICAgICAgaGVpZ2h0ICs9ICQodGhpcykub3V0ZXJIZWlnaHQoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIGFkZCB1c2VyLXN1cHBsaWVkIG1hcmdpbnNcbiAgICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5zbGlkZU1hcmdpbiA+IDApIHtcbiAgICAgICAgICBoZWlnaHQgKz0gc2xpZGVyLnNldHRpbmdzLnNsaWRlTWFyZ2luICogKHNsaWRlci5zZXR0aW5ncy5taW5TbGlkZXMgLSAxKTtcbiAgICAgICAgfVxuICAgICAgLy8gaWYgbm90IFwidmVydGljYWxcIiBtb2RlLCBjYWxjdWxhdGUgdGhlIG1heCBoZWlnaHQgb2YgdGhlIGNoaWxkcmVuXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBoZWlnaHQgPSBNYXRoLm1heC5hcHBseShNYXRoLCBjaGlsZHJlbi5tYXAoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuICQodGhpcykub3V0ZXJIZWlnaHQoZmFsc2UpO1xuICAgICAgICB9KS5nZXQoKSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChzbGlkZXIudmlld3BvcnQuY3NzKCdib3gtc2l6aW5nJykgPT09ICdib3JkZXItYm94Jykge1xuICAgICAgICBoZWlnaHQgKz0gcGFyc2VGbG9hdChzbGlkZXIudmlld3BvcnQuY3NzKCdwYWRkaW5nLXRvcCcpKSArIHBhcnNlRmxvYXQoc2xpZGVyLnZpZXdwb3J0LmNzcygncGFkZGluZy1ib3R0b20nKSkgK1xuICAgICAgICAgICAgICBwYXJzZUZsb2F0KHNsaWRlci52aWV3cG9ydC5jc3MoJ2JvcmRlci10b3Atd2lkdGgnKSkgKyBwYXJzZUZsb2F0KHNsaWRlci52aWV3cG9ydC5jc3MoJ2JvcmRlci1ib3R0b20td2lkdGgnKSk7XG4gICAgICB9IGVsc2UgaWYgKHNsaWRlci52aWV3cG9ydC5jc3MoJ2JveC1zaXppbmcnKSA9PT0gJ3BhZGRpbmctYm94Jykge1xuICAgICAgICBoZWlnaHQgKz0gcGFyc2VGbG9hdChzbGlkZXIudmlld3BvcnQuY3NzKCdwYWRkaW5nLXRvcCcpKSArIHBhcnNlRmxvYXQoc2xpZGVyLnZpZXdwb3J0LmNzcygncGFkZGluZy1ib3R0b20nKSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBoZWlnaHQ7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGNhbGN1bGF0ZWQgd2lkdGggdG8gYmUgdXNlZCBmb3IgdGhlIG91dGVyIHdyYXBwZXIgLyB2aWV3cG9ydFxuICAgICAqL1xuICAgIHZhciBnZXRWaWV3cG9ydE1heFdpZHRoID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgd2lkdGggPSAnMTAwJSc7XG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLnNsaWRlV2lkdGggPiAwKSB7XG4gICAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MubW9kZSA9PT0gJ2hvcml6b250YWwnKSB7XG4gICAgICAgICAgd2lkdGggPSAoc2xpZGVyLnNldHRpbmdzLm1heFNsaWRlcyAqIHNsaWRlci5zZXR0aW5ncy5zbGlkZVdpZHRoKSArICgoc2xpZGVyLnNldHRpbmdzLm1heFNsaWRlcyAtIDEpICogc2xpZGVyLnNldHRpbmdzLnNsaWRlTWFyZ2luKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB3aWR0aCA9IHNsaWRlci5zZXR0aW5ncy5zbGlkZVdpZHRoO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gd2lkdGg7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGNhbGN1bGF0ZWQgd2lkdGggdG8gYmUgYXBwbGllZCB0byBlYWNoIHNsaWRlXG4gICAgICovXG4gICAgdmFyIGdldFNsaWRlV2lkdGggPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBuZXdFbFdpZHRoID0gc2xpZGVyLnNldHRpbmdzLnNsaWRlV2lkdGgsIC8vIHN0YXJ0IHdpdGggYW55IHVzZXItc3VwcGxpZWQgc2xpZGUgd2lkdGhcbiAgICAgIHdyYXBXaWR0aCAgICAgID0gc2xpZGVyLnZpZXdwb3J0LndpZHRoKCk7ICAgIC8vIGdldCB0aGUgY3VycmVudCB2aWV3cG9ydCB3aWR0aFxuICAgICAgLy8gaWYgc2xpZGUgd2lkdGggd2FzIG5vdCBzdXBwbGllZCwgb3IgaXMgbGFyZ2VyIHRoYW4gdGhlIHZpZXdwb3J0IHVzZSB0aGUgdmlld3BvcnQgd2lkdGhcbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3Muc2xpZGVXaWR0aCA9PT0gMCB8fFxuICAgICAgICAoc2xpZGVyLnNldHRpbmdzLnNsaWRlV2lkdGggPiB3cmFwV2lkdGggJiYgIXNsaWRlci5jYXJvdXNlbCkgfHxcbiAgICAgICAgc2xpZGVyLnNldHRpbmdzLm1vZGUgPT09ICd2ZXJ0aWNhbCcpIHtcbiAgICAgICAgbmV3RWxXaWR0aCA9IHdyYXBXaWR0aDtcbiAgICAgIC8vIGlmIGNhcm91c2VsLCB1c2UgdGhlIHRocmVzaG9sZHMgdG8gZGV0ZXJtaW5lIHRoZSB3aWR0aFxuICAgICAgfSBlbHNlIGlmIChzbGlkZXIuc2V0dGluZ3MubWF4U2xpZGVzID4gMSAmJiBzbGlkZXIuc2V0dGluZ3MubW9kZSA9PT0gJ2hvcml6b250YWwnKSB7XG4gICAgICAgIGlmICh3cmFwV2lkdGggPiBzbGlkZXIubWF4VGhyZXNob2xkKSB7XG4gICAgICAgICAgcmV0dXJuIG5ld0VsV2lkdGg7XG4gICAgICAgIH0gZWxzZSBpZiAod3JhcFdpZHRoIDwgc2xpZGVyLm1pblRocmVzaG9sZCkge1xuICAgICAgICAgIG5ld0VsV2lkdGggPSAod3JhcFdpZHRoIC0gKHNsaWRlci5zZXR0aW5ncy5zbGlkZU1hcmdpbiAqIChzbGlkZXIuc2V0dGluZ3MubWluU2xpZGVzIC0gMSkpKSAvIHNsaWRlci5zZXR0aW5ncy5taW5TbGlkZXM7XG4gICAgICAgIH0gZWxzZSBpZiAoc2xpZGVyLnNldHRpbmdzLnNocmlua0l0ZW1zKSB7XG4gICAgICAgICAgbmV3RWxXaWR0aCA9IE1hdGguZmxvb3IoKHdyYXBXaWR0aCArIHNsaWRlci5zZXR0aW5ncy5zbGlkZU1hcmdpbikgLyAoTWF0aC5jZWlsKCh3cmFwV2lkdGggKyBzbGlkZXIuc2V0dGluZ3Muc2xpZGVNYXJnaW4pIC8gKG5ld0VsV2lkdGggKyBzbGlkZXIuc2V0dGluZ3Muc2xpZGVNYXJnaW4pKSkgLSBzbGlkZXIuc2V0dGluZ3Muc2xpZGVNYXJnaW4pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gbmV3RWxXaWR0aDtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgbnVtYmVyIG9mIHNsaWRlcyBjdXJyZW50bHkgdmlzaWJsZSBpbiB0aGUgdmlld3BvcnQgKGluY2x1ZGVzIHBhcnRpYWxseSB2aXNpYmxlIHNsaWRlcylcbiAgICAgKi9cbiAgICB2YXIgZ2V0TnVtYmVyU2xpZGVzU2hvd2luZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHNsaWRlc1Nob3dpbmcgPSAxLFxuICAgICAgY2hpbGRXaWR0aCA9IG51bGw7XG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLm1vZGUgPT09ICdob3Jpem9udGFsJyAmJiBzbGlkZXIuc2V0dGluZ3Muc2xpZGVXaWR0aCA+IDApIHtcbiAgICAgICAgLy8gaWYgdmlld3BvcnQgaXMgc21hbGxlciB0aGFuIG1pblRocmVzaG9sZCwgcmV0dXJuIG1pblNsaWRlc1xuICAgICAgICBpZiAoc2xpZGVyLnZpZXdwb3J0LndpZHRoKCkgPCBzbGlkZXIubWluVGhyZXNob2xkKSB7XG4gICAgICAgICAgc2xpZGVzU2hvd2luZyA9IHNsaWRlci5zZXR0aW5ncy5taW5TbGlkZXM7XG4gICAgICAgIC8vIGlmIHZpZXdwb3J0IGlzIGxhcmdlciB0aGFuIG1heFRocmVzaG9sZCwgcmV0dXJuIG1heFNsaWRlc1xuICAgICAgICB9IGVsc2UgaWYgKHNsaWRlci52aWV3cG9ydC53aWR0aCgpID4gc2xpZGVyLm1heFRocmVzaG9sZCkge1xuICAgICAgICAgIHNsaWRlc1Nob3dpbmcgPSBzbGlkZXIuc2V0dGluZ3MubWF4U2xpZGVzO1xuICAgICAgICAvLyBpZiB2aWV3cG9ydCBpcyBiZXR3ZWVuIG1pbiAvIG1heCB0aHJlc2hvbGRzLCBkaXZpZGUgdmlld3BvcnQgd2lkdGggYnkgZmlyc3QgY2hpbGQgd2lkdGhcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjaGlsZFdpZHRoID0gc2xpZGVyLmNoaWxkcmVuLmZpcnN0KCkud2lkdGgoKSArIHNsaWRlci5zZXR0aW5ncy5zbGlkZU1hcmdpbjtcbiAgICAgICAgICBzbGlkZXNTaG93aW5nID0gTWF0aC5mbG9vcigoc2xpZGVyLnZpZXdwb3J0LndpZHRoKCkgK1xuICAgICAgICAgICAgc2xpZGVyLnNldHRpbmdzLnNsaWRlTWFyZ2luKSAvIGNoaWxkV2lkdGgpO1xuICAgICAgICB9XG4gICAgICAvLyBpZiBcInZlcnRpY2FsXCIgbW9kZSwgc2xpZGVzIHNob3dpbmcgd2lsbCBhbHdheXMgYmUgbWluU2xpZGVzXG4gICAgICB9IGVsc2UgaWYgKHNsaWRlci5zZXR0aW5ncy5tb2RlID09PSAndmVydGljYWwnKSB7XG4gICAgICAgIHNsaWRlc1Nob3dpbmcgPSBzbGlkZXIuc2V0dGluZ3MubWluU2xpZGVzO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHNsaWRlc1Nob3dpbmc7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIG51bWJlciBvZiBwYWdlcyAob25lIGZ1bGwgdmlld3BvcnQgb2Ygc2xpZGVzIGlzIG9uZSBcInBhZ2VcIilcbiAgICAgKi9cbiAgICB2YXIgZ2V0UGFnZXJRdHkgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBwYWdlclF0eSA9IDAsXG4gICAgICBicmVha1BvaW50ID0gMCxcbiAgICAgIGNvdW50ZXIgPSAwO1xuICAgICAgLy8gaWYgbW92ZVNsaWRlcyBpcyBzcGVjaWZpZWQgYnkgdGhlIHVzZXJcbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MubW92ZVNsaWRlcyA+IDApIHtcbiAgICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5pbmZpbml0ZUxvb3ApIHtcbiAgICAgICAgICBwYWdlclF0eSA9IE1hdGguY2VpbChzbGlkZXIuY2hpbGRyZW4ubGVuZ3RoIC8gZ2V0TW92ZUJ5KCkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIHdoZW4gYnJlYWtwb2ludCBnb2VzIGFib3ZlIGNoaWxkcmVuIGxlbmd0aCwgY291bnRlciBpcyB0aGUgbnVtYmVyIG9mIHBhZ2VzXG4gICAgICAgICAgd2hpbGUgKGJyZWFrUG9pbnQgPCBzbGlkZXIuY2hpbGRyZW4ubGVuZ3RoKSB7XG4gICAgICAgICAgICArK3BhZ2VyUXR5O1xuICAgICAgICAgICAgYnJlYWtQb2ludCA9IGNvdW50ZXIgKyBnZXROdW1iZXJTbGlkZXNTaG93aW5nKCk7XG4gICAgICAgICAgICBjb3VudGVyICs9IHNsaWRlci5zZXR0aW5ncy5tb3ZlU2xpZGVzIDw9IGdldE51bWJlclNsaWRlc1Nob3dpbmcoKSA/IHNsaWRlci5zZXR0aW5ncy5tb3ZlU2xpZGVzIDogZ2V0TnVtYmVyU2xpZGVzU2hvd2luZygpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgLy8gaWYgbW92ZVNsaWRlcyBpcyAwIChhdXRvKSBkaXZpZGUgY2hpbGRyZW4gbGVuZ3RoIGJ5IHNpZGVzIHNob3dpbmcsIHRoZW4gcm91bmQgdXBcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHBhZ2VyUXR5ID0gTWF0aC5jZWlsKHNsaWRlci5jaGlsZHJlbi5sZW5ndGggLyBnZXROdW1iZXJTbGlkZXNTaG93aW5nKCkpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHBhZ2VyUXR5O1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBudW1iZXIgb2YgaW5kaXZpZHVhbCBzbGlkZXMgYnkgd2hpY2ggdG8gc2hpZnQgdGhlIHNsaWRlclxuICAgICAqL1xuICAgIHZhciBnZXRNb3ZlQnkgPSBmdW5jdGlvbigpIHtcbiAgICAgIC8vIGlmIG1vdmVTbGlkZXMgd2FzIHNldCBieSB0aGUgdXNlciBhbmQgbW92ZVNsaWRlcyBpcyBsZXNzIHRoYW4gbnVtYmVyIG9mIHNsaWRlcyBzaG93aW5nXG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLm1vdmVTbGlkZXMgPiAwICYmIHNsaWRlci5zZXR0aW5ncy5tb3ZlU2xpZGVzIDw9IGdldE51bWJlclNsaWRlc1Nob3dpbmcoKSkge1xuICAgICAgICByZXR1cm4gc2xpZGVyLnNldHRpbmdzLm1vdmVTbGlkZXM7XG4gICAgICB9XG4gICAgICAvLyBpZiBtb3ZlU2xpZGVzIGlzIDAgKGF1dG8pXG4gICAgICByZXR1cm4gZ2V0TnVtYmVyU2xpZGVzU2hvd2luZygpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBzbGlkZXIncyAoZWwpIGxlZnQgb3IgdG9wIHBvc2l0aW9uXG4gICAgICovXG4gICAgdmFyIHNldFNsaWRlUG9zaXRpb24gPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBwb3NpdGlvbiwgbGFzdENoaWxkLCBsYXN0U2hvd2luZ0luZGV4O1xuICAgICAgLy8gaWYgbGFzdCBzbGlkZSwgbm90IGluZmluaXRlIGxvb3AsIGFuZCBudW1iZXIgb2YgY2hpbGRyZW4gaXMgbGFyZ2VyIHRoYW4gc3BlY2lmaWVkIG1heFNsaWRlc1xuICAgICAgaWYgKHNsaWRlci5jaGlsZHJlbi5sZW5ndGggPiBzbGlkZXIuc2V0dGluZ3MubWF4U2xpZGVzICYmIHNsaWRlci5hY3RpdmUubGFzdCAmJiAhc2xpZGVyLnNldHRpbmdzLmluZmluaXRlTG9vcCkge1xuICAgICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLm1vZGUgPT09ICdob3Jpem9udGFsJykge1xuICAgICAgICAgIC8vIGdldCB0aGUgbGFzdCBjaGlsZCdzIHBvc2l0aW9uXG4gICAgICAgICAgbGFzdENoaWxkID0gc2xpZGVyLmNoaWxkcmVuLmxhc3QoKTtcbiAgICAgICAgICBwb3NpdGlvbiA9IGxhc3RDaGlsZC5wb3NpdGlvbigpO1xuICAgICAgICAgIC8vIHNldCB0aGUgbGVmdCBwb3NpdGlvblxuICAgICAgICAgIHNldFBvc2l0aW9uUHJvcGVydHkoLShwb3NpdGlvbi5sZWZ0IC0gKHNsaWRlci52aWV3cG9ydC53aWR0aCgpIC0gbGFzdENoaWxkLm91dGVyV2lkdGgoKSkpLCAncmVzZXQnLCAwKTtcbiAgICAgICAgfSBlbHNlIGlmIChzbGlkZXIuc2V0dGluZ3MubW9kZSA9PT0gJ3ZlcnRpY2FsJykge1xuICAgICAgICAgIC8vIGdldCB0aGUgbGFzdCBzaG93aW5nIGluZGV4J3MgcG9zaXRpb25cbiAgICAgICAgICBsYXN0U2hvd2luZ0luZGV4ID0gc2xpZGVyLmNoaWxkcmVuLmxlbmd0aCAtIHNsaWRlci5zZXR0aW5ncy5taW5TbGlkZXM7XG4gICAgICAgICAgcG9zaXRpb24gPSBzbGlkZXIuY2hpbGRyZW4uZXEobGFzdFNob3dpbmdJbmRleCkucG9zaXRpb24oKTtcbiAgICAgICAgICAvLyBzZXQgdGhlIHRvcCBwb3NpdGlvblxuICAgICAgICAgIHNldFBvc2l0aW9uUHJvcGVydHkoLXBvc2l0aW9uLnRvcCwgJ3Jlc2V0JywgMCk7XG4gICAgICAgIH1cbiAgICAgIC8vIGlmIG5vdCBsYXN0IHNsaWRlXG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBnZXQgdGhlIHBvc2l0aW9uIG9mIHRoZSBmaXJzdCBzaG93aW5nIHNsaWRlXG4gICAgICAgIHBvc2l0aW9uID0gc2xpZGVyLmNoaWxkcmVuLmVxKHNsaWRlci5hY3RpdmUuaW5kZXggKiBnZXRNb3ZlQnkoKSkucG9zaXRpb24oKTtcbiAgICAgICAgLy8gY2hlY2sgZm9yIGxhc3Qgc2xpZGVcbiAgICAgICAgaWYgKHNsaWRlci5hY3RpdmUuaW5kZXggPT09IGdldFBhZ2VyUXR5KCkgLSAxKSB7IHNsaWRlci5hY3RpdmUubGFzdCA9IHRydWU7IH1cbiAgICAgICAgLy8gc2V0IHRoZSByZXNwZWN0aXZlIHBvc2l0aW9uXG4gICAgICAgIGlmIChwb3NpdGlvbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5tb2RlID09PSAnaG9yaXpvbnRhbCcpIHsgc2V0UG9zaXRpb25Qcm9wZXJ0eSgtcG9zaXRpb24ubGVmdCwgJ3Jlc2V0JywgMCk7IH1cbiAgICAgICAgICBlbHNlIGlmIChzbGlkZXIuc2V0dGluZ3MubW9kZSA9PT0gJ3ZlcnRpY2FsJykgeyBzZXRQb3NpdGlvblByb3BlcnR5KC1wb3NpdGlvbi50b3AsICdyZXNldCcsIDApOyB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgZWwncyBhbmltYXRpbmcgcHJvcGVydHkgcG9zaXRpb24gKHdoaWNoIGluIHR1cm4gd2lsbCBzb21ldGltZXMgYW5pbWF0ZSBlbCkuXG4gICAgICogSWYgdXNpbmcgQ1NTLCBzZXRzIHRoZSB0cmFuc2Zvcm0gcHJvcGVydHkuIElmIG5vdCB1c2luZyBDU1MsIHNldHMgdGhlIHRvcCAvIGxlZnQgcHJvcGVydHkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdmFsdWUgKGludClcbiAgICAgKiAgLSB0aGUgYW5pbWF0aW5nIHByb3BlcnR5J3MgdmFsdWVcbiAgICAgKlxuICAgICAqIEBwYXJhbSB0eXBlIChzdHJpbmcpICdzbGlkZScsICdyZXNldCcsICd0aWNrZXInXG4gICAgICogIC0gdGhlIHR5cGUgb2YgaW5zdGFuY2UgZm9yIHdoaWNoIHRoZSBmdW5jdGlvbiBpcyBiZWluZ1xuICAgICAqXG4gICAgICogQHBhcmFtIGR1cmF0aW9uIChpbnQpXG4gICAgICogIC0gdGhlIGFtb3VudCBvZiB0aW1lIChpbiBtcykgdGhlIHRyYW5zaXRpb24gc2hvdWxkIG9jY3VweVxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtcyAoYXJyYXkpIG9wdGlvbmFsXG4gICAgICogIC0gYW4gb3B0aW9uYWwgcGFyYW1ldGVyIGNvbnRhaW5pbmcgYW55IHZhcmlhYmxlcyB0aGF0IG5lZWQgdG8gYmUgcGFzc2VkIGluXG4gICAgICovXG4gICAgdmFyIHNldFBvc2l0aW9uUHJvcGVydHkgPSBmdW5jdGlvbih2YWx1ZSwgdHlwZSwgZHVyYXRpb24sIHBhcmFtcykge1xuICAgICAgdmFyIGFuaW1hdGVPYmosIHByb3BWYWx1ZTtcbiAgICAgIC8vIHVzZSBDU1MgdHJhbnNmb3JtXG4gICAgICBpZiAoc2xpZGVyLnVzaW5nQ1NTKSB7XG4gICAgICAgIC8vIGRldGVybWluZSB0aGUgdHJhbnNsYXRlM2QgdmFsdWVcbiAgICAgICAgcHJvcFZhbHVlID0gc2xpZGVyLnNldHRpbmdzLm1vZGUgPT09ICd2ZXJ0aWNhbCcgPyAndHJhbnNsYXRlM2QoMCwgJyArIHZhbHVlICsgJ3B4LCAwKScgOiAndHJhbnNsYXRlM2QoJyArIHZhbHVlICsgJ3B4LCAwLCAwKSc7XG4gICAgICAgIC8vIGFkZCB0aGUgQ1NTIHRyYW5zaXRpb24tZHVyYXRpb25cbiAgICAgICAgZWwuY3NzKCctJyArIHNsaWRlci5jc3NQcmVmaXggKyAnLXRyYW5zaXRpb24tZHVyYXRpb24nLCBkdXJhdGlvbiAvIDEwMDAgKyAncycpO1xuICAgICAgICBpZiAodHlwZSA9PT0gJ3NsaWRlJykge1xuICAgICAgICAgIC8vIHNldCB0aGUgcHJvcGVydHkgdmFsdWVcbiAgICAgICAgICBlbC5jc3Moc2xpZGVyLmFuaW1Qcm9wLCBwcm9wVmFsdWUpO1xuICAgICAgICAgIGlmIChkdXJhdGlvbiAhPT0gMCkge1xuICAgICAgICAgICAgLy8gYmluZCBhIGNhbGxiYWNrIG1ldGhvZCAtIGV4ZWN1dGVzIHdoZW4gQ1NTIHRyYW5zaXRpb24gY29tcGxldGVzXG4gICAgICAgICAgICBlbC5iaW5kKCd0cmFuc2l0aW9uZW5kIHdlYmtpdFRyYW5zaXRpb25FbmQgb1RyYW5zaXRpb25FbmQgTVNUcmFuc2l0aW9uRW5kJywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICAvL21ha2Ugc3VyZSBpdCdzIHRoZSBjb3JyZWN0IG9uZVxuICAgICAgICAgICAgICBpZiAoISQoZS50YXJnZXQpLmlzKGVsKSkgeyByZXR1cm47IH1cbiAgICAgICAgICAgICAgLy8gdW5iaW5kIHRoZSBjYWxsYmFja1xuICAgICAgICAgICAgICBlbC51bmJpbmQoJ3RyYW5zaXRpb25lbmQgd2Via2l0VHJhbnNpdGlvbkVuZCBvVHJhbnNpdGlvbkVuZCBNU1RyYW5zaXRpb25FbmQnKTtcbiAgICAgICAgICAgICAgdXBkYXRlQWZ0ZXJTbGlkZVRyYW5zaXRpb24oKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gZWxzZSB7IC8vZHVyYXRpb24gPSAwXG4gICAgICAgICAgICB1cGRhdGVBZnRlclNsaWRlVHJhbnNpdGlvbigpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAncmVzZXQnKSB7XG4gICAgICAgICAgZWwuY3NzKHNsaWRlci5hbmltUHJvcCwgcHJvcFZhbHVlKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAndGlja2VyJykge1xuICAgICAgICAgIC8vIG1ha2UgdGhlIHRyYW5zaXRpb24gdXNlICdsaW5lYXInXG4gICAgICAgICAgZWwuY3NzKCctJyArIHNsaWRlci5jc3NQcmVmaXggKyAnLXRyYW5zaXRpb24tdGltaW5nLWZ1bmN0aW9uJywgJ2xpbmVhcicpO1xuICAgICAgICAgIGVsLmNzcyhzbGlkZXIuYW5pbVByb3AsIHByb3BWYWx1ZSk7XG4gICAgICAgICAgaWYgKGR1cmF0aW9uICE9PSAwKSB7XG4gICAgICAgICAgICBlbC5iaW5kKCd0cmFuc2l0aW9uZW5kIHdlYmtpdFRyYW5zaXRpb25FbmQgb1RyYW5zaXRpb25FbmQgTVNUcmFuc2l0aW9uRW5kJywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICAvL21ha2Ugc3VyZSBpdCdzIHRoZSBjb3JyZWN0IG9uZVxuICAgICAgICAgICAgICBpZiAoISQoZS50YXJnZXQpLmlzKGVsKSkgeyByZXR1cm47IH1cbiAgICAgICAgICAgICAgLy8gdW5iaW5kIHRoZSBjYWxsYmFja1xuICAgICAgICAgICAgICBlbC51bmJpbmQoJ3RyYW5zaXRpb25lbmQgd2Via2l0VHJhbnNpdGlvbkVuZCBvVHJhbnNpdGlvbkVuZCBNU1RyYW5zaXRpb25FbmQnKTtcbiAgICAgICAgICAgICAgLy8gcmVzZXQgdGhlIHBvc2l0aW9uXG4gICAgICAgICAgICAgIHNldFBvc2l0aW9uUHJvcGVydHkocGFyYW1zLnJlc2V0VmFsdWUsICdyZXNldCcsIDApO1xuICAgICAgICAgICAgICAvLyBzdGFydCB0aGUgbG9vcCBhZ2FpblxuICAgICAgICAgICAgICB0aWNrZXJMb29wKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2UgeyAvL2R1cmF0aW9uID0gMFxuICAgICAgICAgICAgc2V0UG9zaXRpb25Qcm9wZXJ0eShwYXJhbXMucmVzZXRWYWx1ZSwgJ3Jlc2V0JywgMCk7XG4gICAgICAgICAgICB0aWNrZXJMb29wKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAvLyB1c2UgSlMgYW5pbWF0ZVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYW5pbWF0ZU9iaiA9IHt9O1xuICAgICAgICBhbmltYXRlT2JqW3NsaWRlci5hbmltUHJvcF0gPSB2YWx1ZTtcbiAgICAgICAgaWYgKHR5cGUgPT09ICdzbGlkZScpIHtcbiAgICAgICAgICBlbC5hbmltYXRlKGFuaW1hdGVPYmosIGR1cmF0aW9uLCBzbGlkZXIuc2V0dGluZ3MuZWFzaW5nLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHVwZGF0ZUFmdGVyU2xpZGVUcmFuc2l0aW9uKCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ3Jlc2V0Jykge1xuICAgICAgICAgIGVsLmNzcyhzbGlkZXIuYW5pbVByb3AsIHZhbHVlKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAndGlja2VyJykge1xuICAgICAgICAgIGVsLmFuaW1hdGUoYW5pbWF0ZU9iaiwgZHVyYXRpb24sICdsaW5lYXInLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHNldFBvc2l0aW9uUHJvcGVydHkocGFyYW1zLnJlc2V0VmFsdWUsICdyZXNldCcsIDApO1xuICAgICAgICAgICAgLy8gcnVuIHRoZSByZWN1cnNpdmUgbG9vcCBhZnRlciBhbmltYXRpb25cbiAgICAgICAgICAgIHRpY2tlckxvb3AoKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBQb3B1bGF0ZXMgdGhlIHBhZ2VyIHdpdGggcHJvcGVyIGFtb3VudCBvZiBwYWdlc1xuICAgICAqL1xuICAgIHZhciBwb3B1bGF0ZVBhZ2VyID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcGFnZXJIdG1sID0gJycsXG4gICAgICBsaW5rQ29udGVudCA9ICcnLFxuICAgICAgcGFnZXJRdHkgPSBnZXRQYWdlclF0eSgpO1xuICAgICAgLy8gbG9vcCB0aHJvdWdoIGVhY2ggcGFnZXIgaXRlbVxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYWdlclF0eTsgaSsrKSB7XG4gICAgICAgIGxpbmtDb250ZW50ID0gJyc7XG4gICAgICAgIC8vIGlmIGEgYnVpbGRQYWdlciBmdW5jdGlvbiBpcyBzdXBwbGllZCwgdXNlIGl0IHRvIGdldCBwYWdlciBsaW5rIHZhbHVlLCBlbHNlIHVzZSBpbmRleCArIDFcbiAgICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5idWlsZFBhZ2VyICYmICQuaXNGdW5jdGlvbihzbGlkZXIuc2V0dGluZ3MuYnVpbGRQYWdlcikgfHwgc2xpZGVyLnNldHRpbmdzLnBhZ2VyQ3VzdG9tKSB7XG4gICAgICAgICAgbGlua0NvbnRlbnQgPSBzbGlkZXIuc2V0dGluZ3MuYnVpbGRQYWdlcihpKTtcbiAgICAgICAgICBzbGlkZXIucGFnZXJFbC5hZGRDbGFzcygnYngtY3VzdG9tLXBhZ2VyJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbGlua0NvbnRlbnQgPSBpICsgMTtcbiAgICAgICAgICBzbGlkZXIucGFnZXJFbC5hZGRDbGFzcygnYngtZGVmYXVsdC1wYWdlcicpO1xuICAgICAgICB9XG4gICAgICAgIC8vIHZhciBsaW5rQ29udGVudCA9IHNsaWRlci5zZXR0aW5ncy5idWlsZFBhZ2VyICYmICQuaXNGdW5jdGlvbihzbGlkZXIuc2V0dGluZ3MuYnVpbGRQYWdlcikgPyBzbGlkZXIuc2V0dGluZ3MuYnVpbGRQYWdlcihpKSA6IGkgKyAxO1xuICAgICAgICAvLyBhZGQgdGhlIG1hcmt1cCB0byB0aGUgc3RyaW5nXG4gICAgICAgIHBhZ2VySHRtbCArPSAnPGRpdiBjbGFzcz1cImJ4LXBhZ2VyLWl0ZW1cIj48YSBocmVmPVwiXCIgZGF0YS1zbGlkZS1pbmRleD1cIicgKyBpICsgJ1wiIGNsYXNzPVwiYngtcGFnZXItbGlua1wiPicgKyBsaW5rQ29udGVudCArICc8L2E+PC9kaXY+JztcbiAgICAgIH1cbiAgICAgIC8vIHBvcHVsYXRlIHRoZSBwYWdlciBlbGVtZW50IHdpdGggcGFnZXIgbGlua3NcbiAgICAgIHNsaWRlci5wYWdlckVsLmh0bWwocGFnZXJIdG1sKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQXBwZW5kcyB0aGUgcGFnZXIgdG8gdGhlIGNvbnRyb2xzIGVsZW1lbnRcbiAgICAgKi9cbiAgICB2YXIgYXBwZW5kUGFnZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgIGlmICghc2xpZGVyLnNldHRpbmdzLnBhZ2VyQ3VzdG9tKSB7XG4gICAgICAgIC8vIGNyZWF0ZSB0aGUgcGFnZXIgRE9NIGVsZW1lbnRcbiAgICAgICAgc2xpZGVyLnBhZ2VyRWwgPSAkKCc8ZGl2IGNsYXNzPVwiYngtcGFnZXJcIiAvPicpO1xuICAgICAgICAvLyBpZiBhIHBhZ2VyIHNlbGVjdG9yIHdhcyBzdXBwbGllZCwgcG9wdWxhdGUgaXQgd2l0aCB0aGUgcGFnZXJcbiAgICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5wYWdlclNlbGVjdG9yKSB7XG4gICAgICAgICAgJChzbGlkZXIuc2V0dGluZ3MucGFnZXJTZWxlY3RvcikuaHRtbChzbGlkZXIucGFnZXJFbCk7XG4gICAgICAgIC8vIGlmIG5vIHBhZ2VyIHNlbGVjdG9yIHdhcyBzdXBwbGllZCwgYWRkIGl0IGFmdGVyIHRoZSB3cmFwcGVyXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2xpZGVyLmNvbnRyb2xzLmVsLmFkZENsYXNzKCdieC1oYXMtcGFnZXInKS5hcHBlbmQoc2xpZGVyLnBhZ2VyRWwpO1xuICAgICAgICB9XG4gICAgICAgIC8vIHBvcHVsYXRlIHRoZSBwYWdlclxuICAgICAgICBwb3B1bGF0ZVBhZ2VyKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzbGlkZXIucGFnZXJFbCA9ICQoc2xpZGVyLnNldHRpbmdzLnBhZ2VyQ3VzdG9tKTtcbiAgICAgIH1cbiAgICAgIC8vIGFzc2lnbiB0aGUgcGFnZXIgY2xpY2sgYmluZGluZ1xuICAgICAgc2xpZGVyLnBhZ2VyRWwub24oJ2NsaWNrIHRvdWNoZW5kJywgJ2EnLCBjbGlja1BhZ2VyQmluZCk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEFwcGVuZHMgcHJldiAvIG5leHQgY29udHJvbHMgdG8gdGhlIGNvbnRyb2xzIGVsZW1lbnRcbiAgICAgKi9cbiAgICB2YXIgYXBwZW5kQ29udHJvbHMgPSBmdW5jdGlvbigpIHtcbiAgICAgIHNsaWRlci5jb250cm9scy5uZXh0ID0gJCgnPGEgY2xhc3M9XCJieC1uZXh0XCIgaHJlZj1cIlwiPicgKyBzbGlkZXIuc2V0dGluZ3MubmV4dFRleHQgKyAnPC9hPicpO1xuICAgICAgc2xpZGVyLmNvbnRyb2xzLnByZXYgPSAkKCc8YSBjbGFzcz1cImJ4LXByZXZcIiBocmVmPVwiXCI+JyArIHNsaWRlci5zZXR0aW5ncy5wcmV2VGV4dCArICc8L2E+Jyk7XG4gICAgICAvLyBiaW5kIGNsaWNrIGFjdGlvbnMgdG8gdGhlIGNvbnRyb2xzXG4gICAgICBzbGlkZXIuY29udHJvbHMubmV4dC5iaW5kKCdjbGljayB0b3VjaGVuZCcsIGNsaWNrTmV4dEJpbmQpO1xuICAgICAgc2xpZGVyLmNvbnRyb2xzLnByZXYuYmluZCgnY2xpY2sgdG91Y2hlbmQnLCBjbGlja1ByZXZCaW5kKTtcbiAgICAgIC8vIGlmIG5leHRTZWxlY3RvciB3YXMgc3VwcGxpZWQsIHBvcHVsYXRlIGl0XG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLm5leHRTZWxlY3Rvcikge1xuICAgICAgICAkKHNsaWRlci5zZXR0aW5ncy5uZXh0U2VsZWN0b3IpLmFwcGVuZChzbGlkZXIuY29udHJvbHMubmV4dCk7XG4gICAgICB9XG4gICAgICAvLyBpZiBwcmV2U2VsZWN0b3Igd2FzIHN1cHBsaWVkLCBwb3B1bGF0ZSBpdFxuICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5wcmV2U2VsZWN0b3IpIHtcbiAgICAgICAgJChzbGlkZXIuc2V0dGluZ3MucHJldlNlbGVjdG9yKS5hcHBlbmQoc2xpZGVyLmNvbnRyb2xzLnByZXYpO1xuICAgICAgfVxuICAgICAgLy8gaWYgbm8gY3VzdG9tIHNlbGVjdG9ycyB3ZXJlIHN1cHBsaWVkXG4gICAgICBpZiAoIXNsaWRlci5zZXR0aW5ncy5uZXh0U2VsZWN0b3IgJiYgIXNsaWRlci5zZXR0aW5ncy5wcmV2U2VsZWN0b3IpIHtcbiAgICAgICAgLy8gYWRkIHRoZSBjb250cm9scyB0byB0aGUgRE9NXG4gICAgICAgIHNsaWRlci5jb250cm9scy5kaXJlY3Rpb25FbCA9ICQoJzxkaXYgY2xhc3M9XCJieC1jb250cm9scy1kaXJlY3Rpb25cIiAvPicpO1xuICAgICAgICAvLyBhZGQgdGhlIGNvbnRyb2wgZWxlbWVudHMgdG8gdGhlIGRpcmVjdGlvbkVsXG4gICAgICAgIHNsaWRlci5jb250cm9scy5kaXJlY3Rpb25FbC5hcHBlbmQoc2xpZGVyLmNvbnRyb2xzLnByZXYpLmFwcGVuZChzbGlkZXIuY29udHJvbHMubmV4dCk7XG4gICAgICAgIC8vIHNsaWRlci52aWV3cG9ydC5hcHBlbmQoc2xpZGVyLmNvbnRyb2xzLmRpcmVjdGlvbkVsKTtcbiAgICAgICAgc2xpZGVyLmNvbnRyb2xzLmVsLmFkZENsYXNzKCdieC1oYXMtY29udHJvbHMtZGlyZWN0aW9uJykuYXBwZW5kKHNsaWRlci5jb250cm9scy5kaXJlY3Rpb25FbCk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEFwcGVuZHMgc3RhcnQgLyBzdG9wIGF1dG8gY29udHJvbHMgdG8gdGhlIGNvbnRyb2xzIGVsZW1lbnRcbiAgICAgKi9cbiAgICB2YXIgYXBwZW5kQ29udHJvbHNBdXRvID0gZnVuY3Rpb24oKSB7XG4gICAgICBzbGlkZXIuY29udHJvbHMuc3RhcnQgPSAkKCc8ZGl2IGNsYXNzPVwiYngtY29udHJvbHMtYXV0by1pdGVtXCI+PGEgY2xhc3M9XCJieC1zdGFydFwiIGhyZWY9XCJcIj4nICsgc2xpZGVyLnNldHRpbmdzLnN0YXJ0VGV4dCArICc8L2E+PC9kaXY+Jyk7XG4gICAgICBzbGlkZXIuY29udHJvbHMuc3RvcCA9ICQoJzxkaXYgY2xhc3M9XCJieC1jb250cm9scy1hdXRvLWl0ZW1cIj48YSBjbGFzcz1cImJ4LXN0b3BcIiBocmVmPVwiXCI+JyArIHNsaWRlci5zZXR0aW5ncy5zdG9wVGV4dCArICc8L2E+PC9kaXY+Jyk7XG4gICAgICAvLyBhZGQgdGhlIGNvbnRyb2xzIHRvIHRoZSBET01cbiAgICAgIHNsaWRlci5jb250cm9scy5hdXRvRWwgPSAkKCc8ZGl2IGNsYXNzPVwiYngtY29udHJvbHMtYXV0b1wiIC8+Jyk7XG4gICAgICAvLyBiaW5kIGNsaWNrIGFjdGlvbnMgdG8gdGhlIGNvbnRyb2xzXG4gICAgICBzbGlkZXIuY29udHJvbHMuYXV0b0VsLm9uKCdjbGljaycsICcuYngtc3RhcnQnLCBjbGlja1N0YXJ0QmluZCk7XG4gICAgICBzbGlkZXIuY29udHJvbHMuYXV0b0VsLm9uKCdjbGljaycsICcuYngtc3RvcCcsIGNsaWNrU3RvcEJpbmQpO1xuICAgICAgLy8gaWYgYXV0b0NvbnRyb2xzQ29tYmluZSwgaW5zZXJ0IG9ubHkgdGhlIFwic3RhcnRcIiBjb250cm9sXG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmF1dG9Db250cm9sc0NvbWJpbmUpIHtcbiAgICAgICAgc2xpZGVyLmNvbnRyb2xzLmF1dG9FbC5hcHBlbmQoc2xpZGVyLmNvbnRyb2xzLnN0YXJ0KTtcbiAgICAgIC8vIGlmIGF1dG9Db250cm9sc0NvbWJpbmUgaXMgZmFsc2UsIGluc2VydCBib3RoIGNvbnRyb2xzXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzbGlkZXIuY29udHJvbHMuYXV0b0VsLmFwcGVuZChzbGlkZXIuY29udHJvbHMuc3RhcnQpLmFwcGVuZChzbGlkZXIuY29udHJvbHMuc3RvcCk7XG4gICAgICB9XG4gICAgICAvLyBpZiBhdXRvIGNvbnRyb2xzIHNlbGVjdG9yIHdhcyBzdXBwbGllZCwgcG9wdWxhdGUgaXQgd2l0aCB0aGUgY29udHJvbHNcbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MuYXV0b0NvbnRyb2xzU2VsZWN0b3IpIHtcbiAgICAgICAgJChzbGlkZXIuc2V0dGluZ3MuYXV0b0NvbnRyb2xzU2VsZWN0b3IpLmh0bWwoc2xpZGVyLmNvbnRyb2xzLmF1dG9FbCk7XG4gICAgICAvLyBpZiBhdXRvIGNvbnRyb2xzIHNlbGVjdG9yIHdhcyBub3Qgc3VwcGxpZWQsIGFkZCBpdCBhZnRlciB0aGUgd3JhcHBlclxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2xpZGVyLmNvbnRyb2xzLmVsLmFkZENsYXNzKCdieC1oYXMtY29udHJvbHMtYXV0bycpLmFwcGVuZChzbGlkZXIuY29udHJvbHMuYXV0b0VsKTtcbiAgICAgIH1cbiAgICAgIC8vIHVwZGF0ZSB0aGUgYXV0byBjb250cm9sc1xuICAgICAgdXBkYXRlQXV0b0NvbnRyb2xzKHNsaWRlci5zZXR0aW5ncy5hdXRvU3RhcnQgPyAnc3RvcCcgOiAnc3RhcnQnKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQXBwZW5kcyBpbWFnZSBjYXB0aW9ucyB0byB0aGUgRE9NXG4gICAgICovXG4gICAgdmFyIGFwcGVuZENhcHRpb25zID0gZnVuY3Rpb24oKSB7XG4gICAgICAvLyBjeWNsZSB0aHJvdWdoIGVhY2ggY2hpbGRcbiAgICAgIHNsaWRlci5jaGlsZHJlbi5lYWNoKGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgICAgIC8vIGdldCB0aGUgaW1hZ2UgdGl0bGUgYXR0cmlidXRlXG4gICAgICAgIHZhciB0aXRsZSA9ICQodGhpcykuZmluZCgnaW1nOmZpcnN0JykuYXR0cigndGl0bGUnKTtcbiAgICAgICAgLy8gYXBwZW5kIHRoZSBjYXB0aW9uXG4gICAgICAgIGlmICh0aXRsZSAhPT0gdW5kZWZpbmVkICYmICgnJyArIHRpdGxlKS5sZW5ndGgpIHtcbiAgICAgICAgICAkKHRoaXMpLmFwcGVuZCgnPGRpdiBjbGFzcz1cImJ4LWNhcHRpb25cIj48c3Bhbj4nICsgdGl0bGUgKyAnPC9zcGFuPjwvZGl2PicpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQ2xpY2sgbmV4dCBiaW5kaW5nXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZSAoZXZlbnQpXG4gICAgICogIC0gRE9NIGV2ZW50IG9iamVjdFxuICAgICAqL1xuICAgIHZhciBjbGlja05leHRCaW5kID0gZnVuY3Rpb24oZSkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgaWYgKHNsaWRlci5jb250cm9scy5lbC5oYXNDbGFzcygnZGlzYWJsZWQnKSkgeyByZXR1cm47IH1cbiAgICAgIC8vIGlmIGF1dG8gc2hvdyBpcyBydW5uaW5nLCBzdG9wIGl0XG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmF1dG8gJiYgc2xpZGVyLnNldHRpbmdzLnN0b3BBdXRvT25DbGljaykgeyBlbC5zdG9wQXV0bygpOyB9XG4gICAgICBlbC5nb1RvTmV4dFNsaWRlKCk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIENsaWNrIHByZXYgYmluZGluZ1xuICAgICAqXG4gICAgICogQHBhcmFtIGUgKGV2ZW50KVxuICAgICAqICAtIERPTSBldmVudCBvYmplY3RcbiAgICAgKi9cbiAgICB2YXIgY2xpY2tQcmV2QmluZCA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGlmIChzbGlkZXIuY29udHJvbHMuZWwuaGFzQ2xhc3MoJ2Rpc2FibGVkJykpIHsgcmV0dXJuOyB9XG4gICAgICAvLyBpZiBhdXRvIHNob3cgaXMgcnVubmluZywgc3RvcCBpdFxuICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5hdXRvICYmIHNsaWRlci5zZXR0aW5ncy5zdG9wQXV0b09uQ2xpY2spIHsgZWwuc3RvcEF1dG8oKTsgfVxuICAgICAgZWwuZ29Ub1ByZXZTbGlkZSgpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBDbGljayBzdGFydCBiaW5kaW5nXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZSAoZXZlbnQpXG4gICAgICogIC0gRE9NIGV2ZW50IG9iamVjdFxuICAgICAqL1xuICAgIHZhciBjbGlja1N0YXJ0QmluZCA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIGVsLnN0YXJ0QXV0bygpO1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBDbGljayBzdG9wIGJpbmRpbmdcbiAgICAgKlxuICAgICAqIEBwYXJhbSBlIChldmVudClcbiAgICAgKiAgLSBET00gZXZlbnQgb2JqZWN0XG4gICAgICovXG4gICAgdmFyIGNsaWNrU3RvcEJpbmQgPSBmdW5jdGlvbihlKSB7XG4gICAgICBlbC5zdG9wQXV0bygpO1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBDbGljayBwYWdlciBiaW5kaW5nXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZSAoZXZlbnQpXG4gICAgICogIC0gRE9NIGV2ZW50IG9iamVjdFxuICAgICAqL1xuICAgIHZhciBjbGlja1BhZ2VyQmluZCA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIHZhciBwYWdlckxpbmssIHBhZ2VySW5kZXg7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBpZiAoc2xpZGVyLmNvbnRyb2xzLmVsLmhhc0NsYXNzKCdkaXNhYmxlZCcpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIC8vIGlmIGF1dG8gc2hvdyBpcyBydW5uaW5nLCBzdG9wIGl0XG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmF1dG8gICYmIHNsaWRlci5zZXR0aW5ncy5zdG9wQXV0b09uQ2xpY2spIHsgZWwuc3RvcEF1dG8oKTsgfVxuICAgICAgcGFnZXJMaW5rID0gJChlLmN1cnJlbnRUYXJnZXQpO1xuICAgICAgaWYgKHBhZ2VyTGluay5hdHRyKCdkYXRhLXNsaWRlLWluZGV4JykgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBwYWdlckluZGV4ID0gcGFyc2VJbnQocGFnZXJMaW5rLmF0dHIoJ2RhdGEtc2xpZGUtaW5kZXgnKSk7XG4gICAgICAgIC8vIGlmIGNsaWNrZWQgcGFnZXIgbGluayBpcyBub3QgYWN0aXZlLCBjb250aW51ZSB3aXRoIHRoZSBnb1RvU2xpZGUgY2FsbFxuICAgICAgICBpZiAocGFnZXJJbmRleCAhPT0gc2xpZGVyLmFjdGl2ZS5pbmRleCkgeyBlbC5nb1RvU2xpZGUocGFnZXJJbmRleCk7IH1cbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogVXBkYXRlcyB0aGUgcGFnZXIgbGlua3Mgd2l0aCBhbiBhY3RpdmUgY2xhc3NcbiAgICAgKlxuICAgICAqIEBwYXJhbSBzbGlkZUluZGV4IChpbnQpXG4gICAgICogIC0gaW5kZXggb2Ygc2xpZGUgdG8gbWFrZSBhY3RpdmVcbiAgICAgKi9cbiAgICB2YXIgdXBkYXRlUGFnZXJBY3RpdmUgPSBmdW5jdGlvbihzbGlkZUluZGV4KSB7XG4gICAgICAvLyBpZiBcInNob3J0XCIgcGFnZXIgdHlwZVxuICAgICAgdmFyIGxlbiA9IHNsaWRlci5jaGlsZHJlbi5sZW5ndGg7IC8vIG5iIG9mIGNoaWxkcmVuXG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLnBhZ2VyVHlwZSA9PT0gJ3Nob3J0Jykge1xuICAgICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLm1heFNsaWRlcyA+IDEpIHtcbiAgICAgICAgICBsZW4gPSBNYXRoLmNlaWwoc2xpZGVyLmNoaWxkcmVuLmxlbmd0aCAvIHNsaWRlci5zZXR0aW5ncy5tYXhTbGlkZXMpO1xuICAgICAgICB9XG4gICAgICAgIHNsaWRlci5wYWdlckVsLmh0bWwoKHNsaWRlSW5kZXggKyAxKSArIHNsaWRlci5zZXR0aW5ncy5wYWdlclNob3J0U2VwYXJhdG9yICsgbGVuKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgLy8gcmVtb3ZlIGFsbCBwYWdlciBhY3RpdmUgY2xhc3Nlc1xuICAgICAgc2xpZGVyLnBhZ2VyRWwuZmluZCgnYScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbiAgICAgIC8vIGFwcGx5IHRoZSBhY3RpdmUgY2xhc3MgZm9yIGFsbCBwYWdlcnNcbiAgICAgIHNsaWRlci5wYWdlckVsLmVhY2goZnVuY3Rpb24oaSwgZWwpIHsgJChlbCkuZmluZCgnYScpLmVxKHNsaWRlSW5kZXgpLmFkZENsYXNzKCdhY3RpdmUnKTsgfSk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFBlcmZvcm1zIG5lZWRlZCBhY3Rpb25zIGFmdGVyIGEgc2xpZGUgdHJhbnNpdGlvblxuICAgICAqL1xuICAgIHZhciB1cGRhdGVBZnRlclNsaWRlVHJhbnNpdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgLy8gaWYgaW5maW5pdGUgbG9vcCBpcyB0cnVlXG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmluZmluaXRlTG9vcCkge1xuICAgICAgICB2YXIgcG9zaXRpb24gPSAnJztcbiAgICAgICAgLy8gZmlyc3Qgc2xpZGVcbiAgICAgICAgaWYgKHNsaWRlci5hY3RpdmUuaW5kZXggPT09IDApIHtcbiAgICAgICAgICAvLyBzZXQgdGhlIG5ldyBwb3NpdGlvblxuICAgICAgICAgIHBvc2l0aW9uID0gc2xpZGVyLmNoaWxkcmVuLmVxKDApLnBvc2l0aW9uKCk7XG4gICAgICAgIC8vIGNhcm91c2VsLCBsYXN0IHNsaWRlXG4gICAgICAgIH0gZWxzZSBpZiAoc2xpZGVyLmFjdGl2ZS5pbmRleCA9PT0gZ2V0UGFnZXJRdHkoKSAtIDEgJiYgc2xpZGVyLmNhcm91c2VsKSB7XG4gICAgICAgICAgcG9zaXRpb24gPSBzbGlkZXIuY2hpbGRyZW4uZXEoKGdldFBhZ2VyUXR5KCkgLSAxKSAqIGdldE1vdmVCeSgpKS5wb3NpdGlvbigpO1xuICAgICAgICAvLyBsYXN0IHNsaWRlXG4gICAgICAgIH0gZWxzZSBpZiAoc2xpZGVyLmFjdGl2ZS5pbmRleCA9PT0gc2xpZGVyLmNoaWxkcmVuLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICBwb3NpdGlvbiA9IHNsaWRlci5jaGlsZHJlbi5lcShzbGlkZXIuY2hpbGRyZW4ubGVuZ3RoIC0gMSkucG9zaXRpb24oKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocG9zaXRpb24pIHtcbiAgICAgICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLm1vZGUgPT09ICdob3Jpem9udGFsJykgeyBzZXRQb3NpdGlvblByb3BlcnR5KC1wb3NpdGlvbi5sZWZ0LCAncmVzZXQnLCAwKTsgfVxuICAgICAgICAgIGVsc2UgaWYgKHNsaWRlci5zZXR0aW5ncy5tb2RlID09PSAndmVydGljYWwnKSB7IHNldFBvc2l0aW9uUHJvcGVydHkoLXBvc2l0aW9uLnRvcCwgJ3Jlc2V0JywgMCk7IH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgLy8gZGVjbGFyZSB0aGF0IHRoZSB0cmFuc2l0aW9uIGlzIGNvbXBsZXRlXG4gICAgICBzbGlkZXIud29ya2luZyA9IGZhbHNlO1xuICAgICAgLy8gb25TbGlkZUFmdGVyIGNhbGxiYWNrXG4gICAgICBzbGlkZXIuc2V0dGluZ3Mub25TbGlkZUFmdGVyLmNhbGwoZWwsIHNsaWRlci5jaGlsZHJlbi5lcShzbGlkZXIuYWN0aXZlLmluZGV4KSwgc2xpZGVyLm9sZEluZGV4LCBzbGlkZXIuYWN0aXZlLmluZGV4KTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogVXBkYXRlcyB0aGUgYXV0byBjb250cm9scyBzdGF0ZSAoZWl0aGVyIGFjdGl2ZSwgb3IgY29tYmluZWQgc3dpdGNoKVxuICAgICAqXG4gICAgICogQHBhcmFtIHN0YXRlIChzdHJpbmcpIFwic3RhcnRcIiwgXCJzdG9wXCJcbiAgICAgKiAgLSB0aGUgbmV3IHN0YXRlIG9mIHRoZSBhdXRvIHNob3dcbiAgICAgKi9cbiAgICB2YXIgdXBkYXRlQXV0b0NvbnRyb2xzID0gZnVuY3Rpb24oc3RhdGUpIHtcbiAgICAgIC8vIGlmIGF1dG9Db250cm9sc0NvbWJpbmUgaXMgdHJ1ZSwgcmVwbGFjZSB0aGUgY3VycmVudCBjb250cm9sIHdpdGggdGhlIG5ldyBzdGF0ZVxuICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5hdXRvQ29udHJvbHNDb21iaW5lKSB7XG4gICAgICAgIHNsaWRlci5jb250cm9scy5hdXRvRWwuaHRtbChzbGlkZXIuY29udHJvbHNbc3RhdGVdKTtcbiAgICAgIC8vIGlmIGF1dG9Db250cm9sc0NvbWJpbmUgaXMgZmFsc2UsIGFwcGx5IHRoZSBcImFjdGl2ZVwiIGNsYXNzIHRvIHRoZSBhcHByb3ByaWF0ZSBjb250cm9sXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzbGlkZXIuY29udHJvbHMuYXV0b0VsLmZpbmQoJ2EnKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgIHNsaWRlci5jb250cm9scy5hdXRvRWwuZmluZCgnYTpub3QoLmJ4LScgKyBzdGF0ZSArICcpJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGVzIHRoZSBkaXJlY3Rpb24gY29udHJvbHMgKGNoZWNrcyBpZiBlaXRoZXIgc2hvdWxkIGJlIGhpZGRlbilcbiAgICAgKi9cbiAgICB2YXIgdXBkYXRlRGlyZWN0aW9uQ29udHJvbHMgPSBmdW5jdGlvbigpIHtcbiAgICAgIGlmIChnZXRQYWdlclF0eSgpID09PSAxKSB7XG4gICAgICAgIHNsaWRlci5jb250cm9scy5wcmV2LmFkZENsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICBzbGlkZXIuY29udHJvbHMubmV4dC5hZGRDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgIH0gZWxzZSBpZiAoIXNsaWRlci5zZXR0aW5ncy5pbmZpbml0ZUxvb3AgJiYgc2xpZGVyLnNldHRpbmdzLmhpZGVDb250cm9sT25FbmQpIHtcbiAgICAgICAgLy8gaWYgZmlyc3Qgc2xpZGVcbiAgICAgICAgaWYgKHNsaWRlci5hY3RpdmUuaW5kZXggPT09IDApIHtcbiAgICAgICAgICBzbGlkZXIuY29udHJvbHMucHJldi5hZGRDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgICBzbGlkZXIuY29udHJvbHMubmV4dC5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgLy8gaWYgbGFzdCBzbGlkZVxuICAgICAgICB9IGVsc2UgaWYgKHNsaWRlci5hY3RpdmUuaW5kZXggPT09IGdldFBhZ2VyUXR5KCkgLSAxKSB7XG4gICAgICAgICAgc2xpZGVyLmNvbnRyb2xzLm5leHQuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICAgICAgc2xpZGVyLmNvbnRyb2xzLnByZXYucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICAgIC8vIGlmIGFueSBzbGlkZSBpbiB0aGUgbWlkZGxlXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2xpZGVyLmNvbnRyb2xzLnByZXYucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICAgICAgc2xpZGVyLmNvbnRyb2xzLm5leHQucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogSW5pdGlhbGl6ZXMgdGhlIGF1dG8gcHJvY2Vzc1xuICAgICAqL1xuICAgIHZhciBpbml0QXV0byA9IGZ1bmN0aW9uKCkge1xuICAgICAgLy8gaWYgYXV0b0RlbGF5IHdhcyBzdXBwbGllZCwgbGF1bmNoIHRoZSBhdXRvIHNob3cgdXNpbmcgYSBzZXRUaW1lb3V0KCkgY2FsbFxuICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5hdXRvRGVsYXkgPiAwKSB7XG4gICAgICAgIHZhciB0aW1lb3V0ID0gc2V0VGltZW91dChlbC5zdGFydEF1dG8sIHNsaWRlci5zZXR0aW5ncy5hdXRvRGVsYXkpO1xuICAgICAgLy8gaWYgYXV0b0RlbGF5IHdhcyBub3Qgc3VwcGxpZWQsIHN0YXJ0IHRoZSBhdXRvIHNob3cgbm9ybWFsbHlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGVsLnN0YXJ0QXV0bygpO1xuXG4gICAgICAgIC8vYWRkIGZvY3VzIGFuZCBibHVyIGV2ZW50cyB0byBlbnN1cmUgaXRzIHJ1bm5pbmcgaWYgdGltZW91dCBnZXRzIHBhdXNlZFxuICAgICAgICAkKHdpbmRvdykuZm9jdXMoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgZWwuc3RhcnRBdXRvKCk7XG4gICAgICAgIH0pLmJsdXIoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgZWwuc3RvcEF1dG8oKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICAvLyBpZiBhdXRvSG92ZXIgaXMgcmVxdWVzdGVkXG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmF1dG9Ib3Zlcikge1xuICAgICAgICAvLyBvbiBlbCBob3ZlclxuICAgICAgICBlbC5ob3ZlcihmdW5jdGlvbigpIHtcbiAgICAgICAgICAvLyBpZiB0aGUgYXV0byBzaG93IGlzIGN1cnJlbnRseSBwbGF5aW5nIChoYXMgYW4gYWN0aXZlIGludGVydmFsKVxuICAgICAgICAgIGlmIChzbGlkZXIuaW50ZXJ2YWwpIHtcbiAgICAgICAgICAgIC8vIHN0b3AgdGhlIGF1dG8gc2hvdyBhbmQgcGFzcyB0cnVlIGFyZ3VtZW50IHdoaWNoIHdpbGwgcHJldmVudCBjb250cm9sIHVwZGF0ZVxuICAgICAgICAgICAgZWwuc3RvcEF1dG8odHJ1ZSk7XG4gICAgICAgICAgICAvLyBjcmVhdGUgYSBuZXcgYXV0b1BhdXNlZCB2YWx1ZSB3aGljaCB3aWxsIGJlIHVzZWQgYnkgdGhlIHJlbGF0aXZlIFwibW91c2VvdXRcIiBldmVudFxuICAgICAgICAgICAgc2xpZGVyLmF1dG9QYXVzZWQgPSB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgLy8gaWYgdGhlIGF1dG9QYXVzZWQgdmFsdWUgd2FzIGNyZWF0ZWQgYmUgdGhlIHByaW9yIFwibW91c2VvdmVyXCIgZXZlbnRcbiAgICAgICAgICBpZiAoc2xpZGVyLmF1dG9QYXVzZWQpIHtcbiAgICAgICAgICAgIC8vIHN0YXJ0IHRoZSBhdXRvIHNob3cgYW5kIHBhc3MgdHJ1ZSBhcmd1bWVudCB3aGljaCB3aWxsIHByZXZlbnQgY29udHJvbCB1cGRhdGVcbiAgICAgICAgICAgIGVsLnN0YXJ0QXV0byh0cnVlKTtcbiAgICAgICAgICAgIC8vIHJlc2V0IHRoZSBhdXRvUGF1c2VkIHZhbHVlXG4gICAgICAgICAgICBzbGlkZXIuYXV0b1BhdXNlZCA9IG51bGw7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogSW5pdGlhbGl6ZXMgdGhlIHRpY2tlciBwcm9jZXNzXG4gICAgICovXG4gICAgdmFyIGluaXRUaWNrZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBzdGFydFBvc2l0aW9uID0gMCxcbiAgICAgIHBvc2l0aW9uLCB0cmFuc2Zvcm0sIHZhbHVlLCBpZHgsIHJhdGlvLCBwcm9wZXJ0eSwgbmV3U3BlZWQsIHRvdGFsRGltZW5zO1xuICAgICAgLy8gaWYgYXV0b0RpcmVjdGlvbiBpcyBcIm5leHRcIiwgYXBwZW5kIGEgY2xvbmUgb2YgdGhlIGVudGlyZSBzbGlkZXJcbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MuYXV0b0RpcmVjdGlvbiA9PT0gJ25leHQnKSB7XG4gICAgICAgIGVsLmFwcGVuZChzbGlkZXIuY2hpbGRyZW4uY2xvbmUoKS5hZGRDbGFzcygnYngtY2xvbmUnKSk7XG4gICAgICAvLyBpZiBhdXRvRGlyZWN0aW9uIGlzIFwicHJldlwiLCBwcmVwZW5kIGEgY2xvbmUgb2YgdGhlIGVudGlyZSBzbGlkZXIsIGFuZCBzZXQgdGhlIGxlZnQgcG9zaXRpb25cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGVsLnByZXBlbmQoc2xpZGVyLmNoaWxkcmVuLmNsb25lKCkuYWRkQ2xhc3MoJ2J4LWNsb25lJykpO1xuICAgICAgICBwb3NpdGlvbiA9IHNsaWRlci5jaGlsZHJlbi5maXJzdCgpLnBvc2l0aW9uKCk7XG4gICAgICAgIHN0YXJ0UG9zaXRpb24gPSBzbGlkZXIuc2V0dGluZ3MubW9kZSA9PT0gJ2hvcml6b250YWwnID8gLXBvc2l0aW9uLmxlZnQgOiAtcG9zaXRpb24udG9wO1xuICAgICAgfVxuICAgICAgc2V0UG9zaXRpb25Qcm9wZXJ0eShzdGFydFBvc2l0aW9uLCAncmVzZXQnLCAwKTtcbiAgICAgIC8vIGRvIG5vdCBhbGxvdyBjb250cm9scyBpbiB0aWNrZXIgbW9kZVxuICAgICAgc2xpZGVyLnNldHRpbmdzLnBhZ2VyID0gZmFsc2U7XG4gICAgICBzbGlkZXIuc2V0dGluZ3MuY29udHJvbHMgPSBmYWxzZTtcbiAgICAgIHNsaWRlci5zZXR0aW5ncy5hdXRvQ29udHJvbHMgPSBmYWxzZTtcbiAgICAgIC8vIGlmIGF1dG9Ib3ZlciBpcyByZXF1ZXN0ZWRcbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MudGlja2VySG92ZXIpIHtcbiAgICAgICAgaWYgKHNsaWRlci51c2luZ0NTUykge1xuICAgICAgICAgIGlkeCA9IHNsaWRlci5zZXR0aW5ncy5tb2RlID09PSAnaG9yaXpvbnRhbCcgPyA0IDogNTtcbiAgICAgICAgICBzbGlkZXIudmlld3BvcnQuaG92ZXIoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0cmFuc2Zvcm0gPSBlbC5jc3MoJy0nICsgc2xpZGVyLmNzc1ByZWZpeCArICctdHJhbnNmb3JtJyk7XG4gICAgICAgICAgICB2YWx1ZSA9IHBhcnNlRmxvYXQodHJhbnNmb3JtLnNwbGl0KCcsJylbaWR4XSk7XG4gICAgICAgICAgICBzZXRQb3NpdGlvblByb3BlcnR5KHZhbHVlLCAncmVzZXQnLCAwKTtcbiAgICAgICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRvdGFsRGltZW5zID0gMDtcbiAgICAgICAgICAgIHNsaWRlci5jaGlsZHJlbi5lYWNoKGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgICAgICAgICAgIHRvdGFsRGltZW5zICs9IHNsaWRlci5zZXR0aW5ncy5tb2RlID09PSAnaG9yaXpvbnRhbCcgPyAkKHRoaXMpLm91dGVyV2lkdGgodHJ1ZSkgOiAkKHRoaXMpLm91dGVySGVpZ2h0KHRydWUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvLyBjYWxjdWxhdGUgdGhlIHNwZWVkIHJhdGlvICh1c2VkIHRvIGRldGVybWluZSB0aGUgbmV3IHNwZWVkIHRvIGZpbmlzaCB0aGUgcGF1c2VkIGFuaW1hdGlvbilcbiAgICAgICAgICAgIHJhdGlvID0gc2xpZGVyLnNldHRpbmdzLnNwZWVkIC8gdG90YWxEaW1lbnM7XG4gICAgICAgICAgICAvLyBkZXRlcm1pbmUgd2hpY2ggcHJvcGVydHkgdG8gdXNlXG4gICAgICAgICAgICBwcm9wZXJ0eSA9IHNsaWRlci5zZXR0aW5ncy5tb2RlID09PSAnaG9yaXpvbnRhbCcgPyAnbGVmdCcgOiAndG9wJztcbiAgICAgICAgICAgIC8vIGNhbGN1bGF0ZSB0aGUgbmV3IHNwZWVkXG4gICAgICAgICAgICBuZXdTcGVlZCA9IHJhdGlvICogKHRvdGFsRGltZW5zIC0gKE1hdGguYWJzKHBhcnNlSW50KHZhbHVlKSkpKTtcbiAgICAgICAgICAgIHRpY2tlckxvb3AobmV3U3BlZWQpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIG9uIGVsIGhvdmVyXG4gICAgICAgICAgc2xpZGVyLnZpZXdwb3J0LmhvdmVyKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgZWwuc3RvcCgpO1xuICAgICAgICAgIH0sIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgLy8gY2FsY3VsYXRlIHRoZSB0b3RhbCB3aWR0aCBvZiBjaGlsZHJlbiAodXNlZCB0byBjYWxjdWxhdGUgdGhlIHNwZWVkIHJhdGlvKVxuICAgICAgICAgICAgdG90YWxEaW1lbnMgPSAwO1xuICAgICAgICAgICAgc2xpZGVyLmNoaWxkcmVuLmVhY2goZnVuY3Rpb24oaW5kZXgpIHtcbiAgICAgICAgICAgICAgdG90YWxEaW1lbnMgKz0gc2xpZGVyLnNldHRpbmdzLm1vZGUgPT09ICdob3Jpem9udGFsJyA/ICQodGhpcykub3V0ZXJXaWR0aCh0cnVlKSA6ICQodGhpcykub3V0ZXJIZWlnaHQodHJ1ZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vIGNhbGN1bGF0ZSB0aGUgc3BlZWQgcmF0aW8gKHVzZWQgdG8gZGV0ZXJtaW5lIHRoZSBuZXcgc3BlZWQgdG8gZmluaXNoIHRoZSBwYXVzZWQgYW5pbWF0aW9uKVxuICAgICAgICAgICAgcmF0aW8gPSBzbGlkZXIuc2V0dGluZ3Muc3BlZWQgLyB0b3RhbERpbWVucztcbiAgICAgICAgICAgIC8vIGRldGVybWluZSB3aGljaCBwcm9wZXJ0eSB0byB1c2VcbiAgICAgICAgICAgIHByb3BlcnR5ID0gc2xpZGVyLnNldHRpbmdzLm1vZGUgPT09ICdob3Jpem9udGFsJyA/ICdsZWZ0JyA6ICd0b3AnO1xuICAgICAgICAgICAgLy8gY2FsY3VsYXRlIHRoZSBuZXcgc3BlZWRcbiAgICAgICAgICAgIG5ld1NwZWVkID0gcmF0aW8gKiAodG90YWxEaW1lbnMgLSAoTWF0aC5hYnMocGFyc2VJbnQoZWwuY3NzKHByb3BlcnR5KSkpKSk7XG4gICAgICAgICAgICB0aWNrZXJMb29wKG5ld1NwZWVkKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgLy8gc3RhcnQgdGhlIHRpY2tlciBsb29wXG4gICAgICB0aWNrZXJMb29wKCk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFJ1bnMgYSBjb250aW51b3VzIGxvb3AsIG5ld3MgdGlja2VyLXN0eWxlXG4gICAgICovXG4gICAgdmFyIHRpY2tlckxvb3AgPSBmdW5jdGlvbihyZXN1bWVTcGVlZCkge1xuICAgICAgdmFyIHNwZWVkID0gcmVzdW1lU3BlZWQgPyByZXN1bWVTcGVlZCA6IHNsaWRlci5zZXR0aW5ncy5zcGVlZCxcbiAgICAgIHBvc2l0aW9uID0ge2xlZnQ6IDAsIHRvcDogMH0sXG4gICAgICByZXNldCA9IHtsZWZ0OiAwLCB0b3A6IDB9LFxuICAgICAgYW5pbWF0ZVByb3BlcnR5LCByZXNldFZhbHVlLCBwYXJhbXM7XG5cbiAgICAgIC8vIGlmIFwibmV4dFwiIGFuaW1hdGUgbGVmdCBwb3NpdGlvbiB0byBsYXN0IGNoaWxkLCB0aGVuIHJlc2V0IGxlZnQgdG8gMFxuICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5hdXRvRGlyZWN0aW9uID09PSAnbmV4dCcpIHtcbiAgICAgICAgcG9zaXRpb24gPSBlbC5maW5kKCcuYngtY2xvbmUnKS5maXJzdCgpLnBvc2l0aW9uKCk7XG4gICAgICAvLyBpZiBcInByZXZcIiBhbmltYXRlIGxlZnQgcG9zaXRpb24gdG8gMCwgdGhlbiByZXNldCBsZWZ0IHRvIGZpcnN0IG5vbi1jbG9uZSBjaGlsZFxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzZXQgPSBzbGlkZXIuY2hpbGRyZW4uZmlyc3QoKS5wb3NpdGlvbigpO1xuICAgICAgfVxuICAgICAgYW5pbWF0ZVByb3BlcnR5ID0gc2xpZGVyLnNldHRpbmdzLm1vZGUgPT09ICdob3Jpem9udGFsJyA/IC1wb3NpdGlvbi5sZWZ0IDogLXBvc2l0aW9uLnRvcDtcbiAgICAgIHJlc2V0VmFsdWUgPSBzbGlkZXIuc2V0dGluZ3MubW9kZSA9PT0gJ2hvcml6b250YWwnID8gLXJlc2V0LmxlZnQgOiAtcmVzZXQudG9wO1xuICAgICAgcGFyYW1zID0ge3Jlc2V0VmFsdWU6IHJlc2V0VmFsdWV9O1xuICAgICAgc2V0UG9zaXRpb25Qcm9wZXJ0eShhbmltYXRlUHJvcGVydHksICd0aWNrZXInLCBzcGVlZCwgcGFyYW1zKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQ2hlY2sgaWYgZWwgaXMgb24gc2NyZWVuXG4gICAgICovXG4gICAgdmFyIGlzT25TY3JlZW4gPSBmdW5jdGlvbihlbCkge1xuICAgICAgdmFyIHdpbiA9ICQod2luZG93KSxcbiAgICAgIHZpZXdwb3J0ID0ge1xuICAgICAgICB0b3A6IHdpbi5zY3JvbGxUb3AoKSxcbiAgICAgICAgbGVmdDogd2luLnNjcm9sbExlZnQoKVxuICAgICAgfSxcbiAgICAgIGJvdW5kcyA9IGVsLm9mZnNldCgpO1xuXG4gICAgICB2aWV3cG9ydC5yaWdodCA9IHZpZXdwb3J0LmxlZnQgKyB3aW4ud2lkdGgoKTtcbiAgICAgIHZpZXdwb3J0LmJvdHRvbSA9IHZpZXdwb3J0LnRvcCArIHdpbi5oZWlnaHQoKTtcbiAgICAgIGJvdW5kcy5yaWdodCA9IGJvdW5kcy5sZWZ0ICsgZWwub3V0ZXJXaWR0aCgpO1xuICAgICAgYm91bmRzLmJvdHRvbSA9IGJvdW5kcy50b3AgKyBlbC5vdXRlckhlaWdodCgpO1xuXG4gICAgICByZXR1cm4gKCEodmlld3BvcnQucmlnaHQgPCBib3VuZHMubGVmdCB8fCB2aWV3cG9ydC5sZWZ0ID4gYm91bmRzLnJpZ2h0IHx8IHZpZXdwb3J0LmJvdHRvbSA8IGJvdW5kcy50b3AgfHwgdmlld3BvcnQudG9wID4gYm91bmRzLmJvdHRvbSkpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBJbml0aWFsaXplcyBrZXlib2FyZCBldmVudHNcbiAgICAgKi9cbiAgICB2YXIga2V5UHJlc3MgPSBmdW5jdGlvbihlKSB7XG4gICAgICB2YXIgYWN0aXZlRWxlbWVudFRhZyA9IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQudGFnTmFtZS50b0xvd2VyQ2FzZSgpLFxuICAgICAgdGFnRmlsdGVycyA9ICdpbnB1dHx0ZXh0YXJlYScsXG4gICAgICBwID0gbmV3IFJlZ0V4cChhY3RpdmVFbGVtZW50VGFnLFsnaSddKSxcbiAgICAgIHJlc3VsdCA9IHAuZXhlYyh0YWdGaWx0ZXJzKTtcblxuICAgICAgaWYgKHJlc3VsdCA9PSBudWxsICYmIGlzT25TY3JlZW4oZWwpKSB7XG4gICAgICAgIGlmIChlLmtleUNvZGUgPT09IDM5KSB7XG4gICAgICAgICAgY2xpY2tOZXh0QmluZChlKTtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0gZWxzZSBpZiAoZS5rZXlDb2RlID09PSAzNykge1xuICAgICAgICAgIGNsaWNrUHJldkJpbmQoZSk7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEluaXRpYWxpemVzIHRvdWNoIGV2ZW50c1xuICAgICAqL1xuICAgIHZhciBpbml0VG91Y2ggPSBmdW5jdGlvbigpIHtcbiAgICAgIC8vIGluaXRpYWxpemUgb2JqZWN0IHRvIGNvbnRhaW4gYWxsIHRvdWNoIHZhbHVlc1xuICAgICAgc2xpZGVyLnRvdWNoID0ge1xuICAgICAgICBzdGFydDoge3g6IDAsIHk6IDB9LFxuICAgICAgICBlbmQ6IHt4OiAwLCB5OiAwfVxuICAgICAgfTtcbiAgICAgIHNsaWRlci52aWV3cG9ydC5iaW5kKCd0b3VjaHN0YXJ0IE1TUG9pbnRlckRvd24gcG9pbnRlcmRvd24nLCBvblRvdWNoU3RhcnQpO1xuXG4gICAgICAvL2ZvciBicm93c2VycyB0aGF0IGhhdmUgaW1wbGVtZW50ZWQgcG9pbnRlciBldmVudHMgYW5kIGZpcmUgYSBjbGljayBhZnRlclxuICAgICAgLy9ldmVyeSBwb2ludGVydXAgcmVnYXJkbGVzcyBvZiB3aGV0aGVyIHBvaW50ZXJ1cCBpcyBvbiBzYW1lIHNjcmVlbiBsb2NhdGlvbiBhcyBwb2ludGVyZG93biBvciBub3RcbiAgICAgIHNsaWRlci52aWV3cG9ydC5vbignY2xpY2snLCAnLmJ4c2xpZGVyIGEnLCBmdW5jdGlvbihlKSB7XG4gICAgICAgIGlmIChzbGlkZXIudmlld3BvcnQuaGFzQ2xhc3MoJ2NsaWNrLWRpc2FibGVkJykpIHtcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgc2xpZGVyLnZpZXdwb3J0LnJlbW92ZUNsYXNzKCdjbGljay1kaXNhYmxlZCcpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogRXZlbnQgaGFuZGxlciBmb3IgXCJ0b3VjaHN0YXJ0XCJcbiAgICAgKlxuICAgICAqIEBwYXJhbSBlIChldmVudClcbiAgICAgKiAgLSBET00gZXZlbnQgb2JqZWN0XG4gICAgICovXG4gICAgdmFyIG9uVG91Y2hTdGFydCA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIC8vZGlzYWJsZSBzbGlkZXIgY29udHJvbHMgd2hpbGUgdXNlciBpcyBpbnRlcmFjdGluZyB3aXRoIHNsaWRlcyB0byBhdm9pZCBzbGlkZXIgZnJlZXplIHRoYXQgaGFwcGVucyBvbiB0b3VjaCBkZXZpY2VzIHdoZW4gYSBzbGlkZSBzd2lwZSBoYXBwZW5zIGltbWVkaWF0ZWx5IGFmdGVyIGludGVyYWN0aW5nIHdpdGggc2xpZGVyIGNvbnRyb2xzXG4gICAgICBzbGlkZXIuY29udHJvbHMuZWwuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XG5cbiAgICAgIGlmIChzbGlkZXIud29ya2luZykge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHNsaWRlci5jb250cm9scy5lbC5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIHJlY29yZCB0aGUgb3JpZ2luYWwgcG9zaXRpb24gd2hlbiB0b3VjaCBzdGFydHNcbiAgICAgICAgc2xpZGVyLnRvdWNoLm9yaWdpbmFsUG9zID0gZWwucG9zaXRpb24oKTtcbiAgICAgICAgdmFyIG9yaWcgPSBlLm9yaWdpbmFsRXZlbnQsXG4gICAgICAgIHRvdWNoUG9pbnRzID0gKHR5cGVvZiBvcmlnLmNoYW5nZWRUb3VjaGVzICE9PSAndW5kZWZpbmVkJykgPyBvcmlnLmNoYW5nZWRUb3VjaGVzIDogW29yaWddO1xuICAgICAgICAvLyByZWNvcmQgdGhlIHN0YXJ0aW5nIHRvdWNoIHgsIHkgY29vcmRpbmF0ZXNcbiAgICAgICAgc2xpZGVyLnRvdWNoLnN0YXJ0LnggPSB0b3VjaFBvaW50c1swXS5wYWdlWDtcbiAgICAgICAgc2xpZGVyLnRvdWNoLnN0YXJ0LnkgPSB0b3VjaFBvaW50c1swXS5wYWdlWTtcblxuICAgICAgICBpZiAoc2xpZGVyLnZpZXdwb3J0LmdldCgwKS5zZXRQb2ludGVyQ2FwdHVyZSkge1xuICAgICAgICAgIHNsaWRlci5wb2ludGVySWQgPSBvcmlnLnBvaW50ZXJJZDtcbiAgICAgICAgICBzbGlkZXIudmlld3BvcnQuZ2V0KDApLnNldFBvaW50ZXJDYXB0dXJlKHNsaWRlci5wb2ludGVySWQpO1xuICAgICAgICB9XG4gICAgICAgIC8vIGJpbmQgYSBcInRvdWNobW92ZVwiIGV2ZW50IHRvIHRoZSB2aWV3cG9ydFxuICAgICAgICBzbGlkZXIudmlld3BvcnQuYmluZCgndG91Y2htb3ZlIE1TUG9pbnRlck1vdmUgcG9pbnRlcm1vdmUnLCBvblRvdWNoTW92ZSk7XG4gICAgICAgIC8vIGJpbmQgYSBcInRvdWNoZW5kXCIgZXZlbnQgdG8gdGhlIHZpZXdwb3J0XG4gICAgICAgIHNsaWRlci52aWV3cG9ydC5iaW5kKCd0b3VjaGVuZCBNU1BvaW50ZXJVcCBwb2ludGVydXAnLCBvblRvdWNoRW5kKTtcbiAgICAgICAgc2xpZGVyLnZpZXdwb3J0LmJpbmQoJ01TUG9pbnRlckNhbmNlbCBwb2ludGVyY2FuY2VsJywgb25Qb2ludGVyQ2FuY2VsKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQ2FuY2VsIFBvaW50ZXIgZm9yIFdpbmRvd3MgUGhvbmVcbiAgICAgKlxuICAgICAqIEBwYXJhbSBlIChldmVudClcbiAgICAgKiAgLSBET00gZXZlbnQgb2JqZWN0XG4gICAgICovXG4gICAgdmFyIG9uUG9pbnRlckNhbmNlbCA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIC8qIG9uUG9pbnRlckNhbmNlbCBoYW5kbGVyIGlzIG5lZWRlZCB0byBkZWFsIHdpdGggc2l0dWF0aW9ucyB3aGVuIGEgdG91Y2hlbmRcbiAgICAgIGRvZXNuJ3QgZmlyZSBhZnRlciBhIHRvdWNoc3RhcnQgKHRoaXMgaGFwcGVucyBvbiB3aW5kb3dzIHBob25lcyBvbmx5KSAqL1xuICAgICAgc2V0UG9zaXRpb25Qcm9wZXJ0eShzbGlkZXIudG91Y2gub3JpZ2luYWxQb3MubGVmdCwgJ3Jlc2V0JywgMCk7XG5cbiAgICAgIC8vcmVtb3ZlIGhhbmRsZXJzXG4gICAgICBzbGlkZXIuY29udHJvbHMuZWwucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICBzbGlkZXIudmlld3BvcnQudW5iaW5kKCdNU1BvaW50ZXJDYW5jZWwgcG9pbnRlcmNhbmNlbCcsIG9uUG9pbnRlckNhbmNlbCk7XG4gICAgICBzbGlkZXIudmlld3BvcnQudW5iaW5kKCd0b3VjaG1vdmUgTVNQb2ludGVyTW92ZSBwb2ludGVybW92ZScsIG9uVG91Y2hNb3ZlKTtcbiAgICAgIHNsaWRlci52aWV3cG9ydC51bmJpbmQoJ3RvdWNoZW5kIE1TUG9pbnRlclVwIHBvaW50ZXJ1cCcsIG9uVG91Y2hFbmQpO1xuICAgICAgaWYgKHNsaWRlci52aWV3cG9ydC5nZXQoMCkucmVsZWFzZVBvaW50ZXJDYXB0dXJlKSB7XG4gICAgICAgIHNsaWRlci52aWV3cG9ydC5nZXQoMCkucmVsZWFzZVBvaW50ZXJDYXB0dXJlKHNsaWRlci5wb2ludGVySWQpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBFdmVudCBoYW5kbGVyIGZvciBcInRvdWNobW92ZVwiXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZSAoZXZlbnQpXG4gICAgICogIC0gRE9NIGV2ZW50IG9iamVjdFxuICAgICAqL1xuICAgIHZhciBvblRvdWNoTW92ZSA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIHZhciBvcmlnID0gZS5vcmlnaW5hbEV2ZW50LFxuICAgICAgdG91Y2hQb2ludHMgPSAodHlwZW9mIG9yaWcuY2hhbmdlZFRvdWNoZXMgIT09ICd1bmRlZmluZWQnKSA/IG9yaWcuY2hhbmdlZFRvdWNoZXMgOiBbb3JpZ10sXG4gICAgICAvLyBpZiBzY3JvbGxpbmcgb24geSBheGlzLCBkbyBub3QgcHJldmVudCBkZWZhdWx0XG4gICAgICB4TW92ZW1lbnQgPSBNYXRoLmFicyh0b3VjaFBvaW50c1swXS5wYWdlWCAtIHNsaWRlci50b3VjaC5zdGFydC54KSxcbiAgICAgIHlNb3ZlbWVudCA9IE1hdGguYWJzKHRvdWNoUG9pbnRzWzBdLnBhZ2VZIC0gc2xpZGVyLnRvdWNoLnN0YXJ0LnkpLFxuICAgICAgdmFsdWUgPSAwLFxuICAgICAgY2hhbmdlID0gMDtcblxuICAgICAgLy8geCBheGlzIHN3aXBlXG4gICAgICBpZiAoKHhNb3ZlbWVudCAqIDMpID4geU1vdmVtZW50ICYmIHNsaWRlci5zZXR0aW5ncy5wcmV2ZW50RGVmYXVsdFN3aXBlWCkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAvLyB5IGF4aXMgc3dpcGVcbiAgICAgIH0gZWxzZSBpZiAoKHlNb3ZlbWVudCAqIDMpID4geE1vdmVtZW50ICYmIHNsaWRlci5zZXR0aW5ncy5wcmV2ZW50RGVmYXVsdFN3aXBlWSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB9XG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLm1vZGUgIT09ICdmYWRlJyAmJiBzbGlkZXIuc2V0dGluZ3Mub25lVG9PbmVUb3VjaCkge1xuICAgICAgICAvLyBpZiBob3Jpem9udGFsLCBkcmFnIGFsb25nIHggYXhpc1xuICAgICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLm1vZGUgPT09ICdob3Jpem9udGFsJykge1xuICAgICAgICAgIGNoYW5nZSA9IHRvdWNoUG9pbnRzWzBdLnBhZ2VYIC0gc2xpZGVyLnRvdWNoLnN0YXJ0Lng7XG4gICAgICAgICAgdmFsdWUgPSBzbGlkZXIudG91Y2gub3JpZ2luYWxQb3MubGVmdCArIGNoYW5nZTtcbiAgICAgICAgLy8gaWYgdmVydGljYWwsIGRyYWcgYWxvbmcgeSBheGlzXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY2hhbmdlID0gdG91Y2hQb2ludHNbMF0ucGFnZVkgLSBzbGlkZXIudG91Y2guc3RhcnQueTtcbiAgICAgICAgICB2YWx1ZSA9IHNsaWRlci50b3VjaC5vcmlnaW5hbFBvcy50b3AgKyBjaGFuZ2U7XG4gICAgICAgIH1cbiAgICAgICAgc2V0UG9zaXRpb25Qcm9wZXJ0eSh2YWx1ZSwgJ3Jlc2V0JywgMCk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEV2ZW50IGhhbmRsZXIgZm9yIFwidG91Y2hlbmRcIlxuICAgICAqXG4gICAgICogQHBhcmFtIGUgKGV2ZW50KVxuICAgICAqICAtIERPTSBldmVudCBvYmplY3RcbiAgICAgKi9cbiAgICB2YXIgb25Ub3VjaEVuZCA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIHNsaWRlci52aWV3cG9ydC51bmJpbmQoJ3RvdWNobW92ZSBNU1BvaW50ZXJNb3ZlIHBvaW50ZXJtb3ZlJywgb25Ub3VjaE1vdmUpO1xuICAgICAgLy9lbmFibGUgc2xpZGVyIGNvbnRyb2xzIGFzIHNvb24gYXMgdXNlciBzdG9wcyBpbnRlcmFjaW5nIHdpdGggc2xpZGVzXG4gICAgICBzbGlkZXIuY29udHJvbHMuZWwucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICB2YXIgb3JpZyAgICA9IGUub3JpZ2luYWxFdmVudCxcbiAgICAgIHRvdWNoUG9pbnRzID0gKHR5cGVvZiBvcmlnLmNoYW5nZWRUb3VjaGVzICE9PSAndW5kZWZpbmVkJykgPyBvcmlnLmNoYW5nZWRUb3VjaGVzIDogW29yaWddLFxuICAgICAgdmFsdWUgICAgICAgPSAwLFxuICAgICAgZGlzdGFuY2UgICAgPSAwO1xuICAgICAgLy8gcmVjb3JkIGVuZCB4LCB5IHBvc2l0aW9uc1xuICAgICAgc2xpZGVyLnRvdWNoLmVuZC54ID0gdG91Y2hQb2ludHNbMF0ucGFnZVg7XG4gICAgICBzbGlkZXIudG91Y2guZW5kLnkgPSB0b3VjaFBvaW50c1swXS5wYWdlWTtcbiAgICAgIC8vIGlmIGZhZGUgbW9kZSwgY2hlY2sgaWYgYWJzb2x1dGUgeCBkaXN0YW5jZSBjbGVhcnMgdGhlIHRocmVzaG9sZFxuICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5tb2RlID09PSAnZmFkZScpIHtcbiAgICAgICAgZGlzdGFuY2UgPSBNYXRoLmFicyhzbGlkZXIudG91Y2guc3RhcnQueCAtIHNsaWRlci50b3VjaC5lbmQueCk7XG4gICAgICAgIGlmIChkaXN0YW5jZSA+PSBzbGlkZXIuc2V0dGluZ3Muc3dpcGVUaHJlc2hvbGQpIHtcbiAgICAgICAgICBpZiAoc2xpZGVyLnRvdWNoLnN0YXJ0LnggPiBzbGlkZXIudG91Y2guZW5kLngpIHtcbiAgICAgICAgICAgIGVsLmdvVG9OZXh0U2xpZGUoKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZWwuZ29Ub1ByZXZTbGlkZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbC5zdG9wQXV0bygpO1xuICAgICAgICB9XG4gICAgICAvLyBub3QgZmFkZSBtb2RlXG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBjYWxjdWxhdGUgZGlzdGFuY2UgYW5kIGVsJ3MgYW5pbWF0ZSBwcm9wZXJ0eVxuICAgICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLm1vZGUgPT09ICdob3Jpem9udGFsJykge1xuICAgICAgICAgIGRpc3RhbmNlID0gc2xpZGVyLnRvdWNoLmVuZC54IC0gc2xpZGVyLnRvdWNoLnN0YXJ0Lng7XG4gICAgICAgICAgdmFsdWUgPSBzbGlkZXIudG91Y2gub3JpZ2luYWxQb3MubGVmdDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBkaXN0YW5jZSA9IHNsaWRlci50b3VjaC5lbmQueSAtIHNsaWRlci50b3VjaC5zdGFydC55O1xuICAgICAgICAgIHZhbHVlID0gc2xpZGVyLnRvdWNoLm9yaWdpbmFsUG9zLnRvcDtcbiAgICAgICAgfVxuICAgICAgICAvLyBpZiBub3QgaW5maW5pdGUgbG9vcCBhbmQgZmlyc3QgLyBsYXN0IHNsaWRlLCBkbyBub3QgYXR0ZW1wdCBhIHNsaWRlIHRyYW5zaXRpb25cbiAgICAgICAgaWYgKCFzbGlkZXIuc2V0dGluZ3MuaW5maW5pdGVMb29wICYmICgoc2xpZGVyLmFjdGl2ZS5pbmRleCA9PT0gMCAmJiBkaXN0YW5jZSA+IDApIHx8IChzbGlkZXIuYWN0aXZlLmxhc3QgJiYgZGlzdGFuY2UgPCAwKSkpIHtcbiAgICAgICAgICBzZXRQb3NpdGlvblByb3BlcnR5KHZhbHVlLCAncmVzZXQnLCAyMDApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIGNoZWNrIGlmIGRpc3RhbmNlIGNsZWFycyB0aHJlc2hvbGRcbiAgICAgICAgICBpZiAoTWF0aC5hYnMoZGlzdGFuY2UpID49IHNsaWRlci5zZXR0aW5ncy5zd2lwZVRocmVzaG9sZCkge1xuICAgICAgICAgICAgaWYgKGRpc3RhbmNlIDwgMCkge1xuICAgICAgICAgICAgICBlbC5nb1RvTmV4dFNsaWRlKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBlbC5nb1RvUHJldlNsaWRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbC5zdG9wQXV0bygpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBlbC5hbmltYXRlKHByb3BlcnR5LCAyMDApO1xuICAgICAgICAgICAgc2V0UG9zaXRpb25Qcm9wZXJ0eSh2YWx1ZSwgJ3Jlc2V0JywgMjAwKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHNsaWRlci52aWV3cG9ydC51bmJpbmQoJ3RvdWNoZW5kIE1TUG9pbnRlclVwIHBvaW50ZXJ1cCcsIG9uVG91Y2hFbmQpO1xuICAgICAgaWYgKHNsaWRlci52aWV3cG9ydC5nZXQoMCkucmVsZWFzZVBvaW50ZXJDYXB0dXJlKSB7XG4gICAgICAgIHNsaWRlci52aWV3cG9ydC5nZXQoMCkucmVsZWFzZVBvaW50ZXJDYXB0dXJlKHNsaWRlci5wb2ludGVySWQpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBXaW5kb3cgcmVzaXplIGV2ZW50IGNhbGxiYWNrXG4gICAgICovXG4gICAgdmFyIHJlc2l6ZVdpbmRvdyA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIC8vIGRvbid0IGRvIGFueXRoaW5nIGlmIHNsaWRlciBpc24ndCBpbml0aWFsaXplZC5cbiAgICAgIGlmICghc2xpZGVyLmluaXRpYWxpemVkKSB7IHJldHVybjsgfVxuICAgICAgLy8gRGVsYXkgaWYgc2xpZGVyIHdvcmtpbmcuXG4gICAgICBpZiAoc2xpZGVyLndvcmtpbmcpIHtcbiAgICAgICAgd2luZG93LnNldFRpbWVvdXQocmVzaXplV2luZG93LCAxMCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBnZXQgdGhlIG5ldyB3aW5kb3cgZGltZW5zIChhZ2FpbiwgdGhhbmsgeW91IElFKVxuICAgICAgICB2YXIgd2luZG93V2lkdGhOZXcgPSAkKHdpbmRvdykud2lkdGgoKSxcbiAgICAgICAgd2luZG93SGVpZ2h0TmV3ID0gJCh3aW5kb3cpLmhlaWdodCgpO1xuICAgICAgICAvLyBtYWtlIHN1cmUgdGhhdCBpdCBpcyBhIHRydWUgd2luZG93IHJlc2l6ZVxuICAgICAgICAvLyAqd2UgbXVzdCBjaGVjayB0aGlzIGJlY2F1c2Ugb3VyIGRpbm9zYXVyIGZyaWVuZCBJRSBmaXJlcyBhIHdpbmRvdyByZXNpemUgZXZlbnQgd2hlbiBjZXJ0YWluIERPTSBlbGVtZW50c1xuICAgICAgICAvLyBhcmUgcmVzaXplZC4gQ2FuIHlvdSBqdXN0IGRpZSBhbHJlYWR5PypcbiAgICAgICAgaWYgKHdpbmRvd1dpZHRoICE9PSB3aW5kb3dXaWR0aE5ldyB8fCB3aW5kb3dIZWlnaHQgIT09IHdpbmRvd0hlaWdodE5ldykge1xuICAgICAgICAgIC8vIHNldCB0aGUgbmV3IHdpbmRvdyBkaW1lbnNcbiAgICAgICAgICB3aW5kb3dXaWR0aCA9IHdpbmRvd1dpZHRoTmV3O1xuICAgICAgICAgIHdpbmRvd0hlaWdodCA9IHdpbmRvd0hlaWdodE5ldztcbiAgICAgICAgICAvLyB1cGRhdGUgYWxsIGR5bmFtaWMgZWxlbWVudHNcbiAgICAgICAgICBlbC5yZWRyYXdTbGlkZXIoKTtcbiAgICAgICAgICAvLyBDYWxsIHVzZXIgcmVzaXplIGhhbmRsZXJcbiAgICAgICAgICBzbGlkZXIuc2V0dGluZ3Mub25TbGlkZXJSZXNpemUuY2FsbChlbCwgc2xpZGVyLmFjdGl2ZS5pbmRleCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQWRkcyBhbiBhcmlhLWhpZGRlbj10cnVlIGF0dHJpYnV0ZSB0byBlYWNoIGVsZW1lbnRcbiAgICAgKlxuICAgICAqIEBwYXJhbSBzdGFydFZpc2libGVJbmRleCAoaW50KVxuICAgICAqICAtIHRoZSBmaXJzdCB2aXNpYmxlIGVsZW1lbnQncyBpbmRleFxuICAgICAqL1xuICAgIHZhciBhcHBseUFyaWFIaWRkZW5BdHRyaWJ1dGVzID0gZnVuY3Rpb24oc3RhcnRWaXNpYmxlSW5kZXgpIHtcbiAgICAgIHZhciBudW1iZXJPZlNsaWRlc1Nob3dpbmcgPSBnZXROdW1iZXJTbGlkZXNTaG93aW5nKCk7XG4gICAgICAvLyBvbmx5IGFwcGx5IGF0dHJpYnV0ZXMgaWYgdGhlIHNldHRpbmcgaXMgZW5hYmxlZCBhbmQgbm90IGluIHRpY2tlciBtb2RlXG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmFyaWFIaWRkZW4gJiYgIXNsaWRlci5zZXR0aW5ncy50aWNrZXIpIHtcbiAgICAgICAgLy8gYWRkIGFyaWEtaGlkZGVuPXRydWUgdG8gYWxsIGVsZW1lbnRzXG4gICAgICAgIHNsaWRlci5jaGlsZHJlbi5hdHRyKCdhcmlhLWhpZGRlbicsICd0cnVlJyk7XG4gICAgICAgIC8vIGdldCB0aGUgdmlzaWJsZSBlbGVtZW50cyBhbmQgY2hhbmdlIHRvIGFyaWEtaGlkZGVuPWZhbHNlXG4gICAgICAgIHNsaWRlci5jaGlsZHJlbi5zbGljZShzdGFydFZpc2libGVJbmRleCwgc3RhcnRWaXNpYmxlSW5kZXggKyBudW1iZXJPZlNsaWRlc1Nob3dpbmcpLmF0dHIoJ2FyaWEtaGlkZGVuJywgJ2ZhbHNlJyk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgaW5kZXggYWNjb3JkaW5nIHRvIHByZXNlbnQgcGFnZSByYW5nZVxuICAgICAqXG4gICAgICogQHBhcmFtIHNsaWRlT25kZXggKGludClcbiAgICAgKiAgLSB0aGUgZGVzaXJlZCBzbGlkZSBpbmRleFxuICAgICAqL1xuICAgIHZhciBzZXRTbGlkZUluZGV4ID0gZnVuY3Rpb24oc2xpZGVJbmRleCkge1xuICAgICAgaWYgKHNsaWRlSW5kZXggPCAwKSB7XG4gICAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MuaW5maW5pdGVMb29wKSB7XG4gICAgICAgICAgcmV0dXJuIGdldFBhZ2VyUXR5KCkgLSAxO1xuICAgICAgICB9ZWxzZSB7XG4gICAgICAgICAgLy93ZSBkb24ndCBnbyB0byB1bmRlZmluZWQgc2xpZGVzXG4gICAgICAgICAgcmV0dXJuIHNsaWRlci5hY3RpdmUuaW5kZXg7XG4gICAgICAgIH1cbiAgICAgIC8vIGlmIHNsaWRlSW5kZXggaXMgZ3JlYXRlciB0aGFuIGNoaWxkcmVuIGxlbmd0aCwgc2V0IGFjdGl2ZSBpbmRleCB0byAwICh0aGlzIGhhcHBlbnMgZHVyaW5nIGluZmluaXRlIGxvb3ApXG4gICAgICB9IGVsc2UgaWYgKHNsaWRlSW5kZXggPj0gZ2V0UGFnZXJRdHkoKSkge1xuICAgICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmluZmluaXRlTG9vcCkge1xuICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vd2UgZG9uJ3QgbW92ZSB0byB1bmRlZmluZWQgcGFnZXNcbiAgICAgICAgICByZXR1cm4gc2xpZGVyLmFjdGl2ZS5pbmRleDtcbiAgICAgICAgfVxuICAgICAgLy8gc2V0IGFjdGl2ZSBpbmRleCB0byByZXF1ZXN0ZWQgc2xpZGVcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBzbGlkZUluZGV4O1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAqID0gUFVCTElDIEZVTkNUSU9OU1xuICAgICAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICovXG5cbiAgICAvKipcbiAgICAgKiBQZXJmb3JtcyBzbGlkZSB0cmFuc2l0aW9uIHRvIHRoZSBzcGVjaWZpZWQgc2xpZGVcbiAgICAgKlxuICAgICAqIEBwYXJhbSBzbGlkZUluZGV4IChpbnQpXG4gICAgICogIC0gdGhlIGRlc3RpbmF0aW9uIHNsaWRlJ3MgaW5kZXggKHplcm8tYmFzZWQpXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZGlyZWN0aW9uIChzdHJpbmcpXG4gICAgICogIC0gSU5URVJOQUwgVVNFIE9OTFkgLSB0aGUgZGlyZWN0aW9uIG9mIHRyYXZlbCAoXCJwcmV2XCIgLyBcIm5leHRcIilcbiAgICAgKi9cbiAgICBlbC5nb1RvU2xpZGUgPSBmdW5jdGlvbihzbGlkZUluZGV4LCBkaXJlY3Rpb24pIHtcbiAgICAgIC8vIG9uU2xpZGVCZWZvcmUsIG9uU2xpZGVOZXh0LCBvblNsaWRlUHJldiBjYWxsYmFja3NcbiAgICAgIC8vIEFsbG93IHRyYW5zaXRpb24gY2FuY2VsaW5nIGJhc2VkIG9uIHJldHVybmVkIHZhbHVlXG4gICAgICB2YXIgcGVyZm9ybVRyYW5zaXRpb24gPSB0cnVlLFxuICAgICAgbW92ZUJ5ID0gMCxcbiAgICAgIHBvc2l0aW9uID0ge2xlZnQ6IDAsIHRvcDogMH0sXG4gICAgICBsYXN0Q2hpbGQgPSBudWxsLFxuICAgICAgbGFzdFNob3dpbmdJbmRleCwgZXEsIHZhbHVlLCByZXF1ZXN0RWw7XG4gICAgICAvLyBzdG9yZSB0aGUgb2xkIGluZGV4XG4gICAgICBzbGlkZXIub2xkSW5kZXggPSBzbGlkZXIuYWN0aXZlLmluZGV4O1xuICAgICAgLy9zZXQgbmV3IGluZGV4XG4gICAgICBzbGlkZXIuYWN0aXZlLmluZGV4ID0gc2V0U2xpZGVJbmRleChzbGlkZUluZGV4KTtcblxuICAgICAgLy8gaWYgcGx1Z2luIGlzIGN1cnJlbnRseSBpbiBtb3Rpb24sIGlnbm9yZSByZXF1ZXN0XG4gICAgICBpZiAoc2xpZGVyLndvcmtpbmcgfHwgc2xpZGVyLmFjdGl2ZS5pbmRleCA9PT0gc2xpZGVyLm9sZEluZGV4KSB7IHJldHVybjsgfVxuICAgICAgLy8gZGVjbGFyZSB0aGF0IHBsdWdpbiBpcyBpbiBtb3Rpb25cbiAgICAgIHNsaWRlci53b3JraW5nID0gdHJ1ZTtcblxuICAgICAgcGVyZm9ybVRyYW5zaXRpb24gPSBzbGlkZXIuc2V0dGluZ3Mub25TbGlkZUJlZm9yZS5jYWxsKGVsLCBzbGlkZXIuY2hpbGRyZW4uZXEoc2xpZGVyLmFjdGl2ZS5pbmRleCksIHNsaWRlci5vbGRJbmRleCwgc2xpZGVyLmFjdGl2ZS5pbmRleCk7XG5cbiAgICAgIC8vIElmIHRyYW5zaXRpb25zIGNhbmNlbGVkLCByZXNldCBhbmQgcmV0dXJuXG4gICAgICBpZiAodHlwZW9mIChwZXJmb3JtVHJhbnNpdGlvbikgIT09ICd1bmRlZmluZWQnICYmICFwZXJmb3JtVHJhbnNpdGlvbikge1xuICAgICAgICBzbGlkZXIuYWN0aXZlLmluZGV4ID0gc2xpZGVyLm9sZEluZGV4OyAvLyByZXN0b3JlIG9sZCBpbmRleFxuICAgICAgICBzbGlkZXIud29ya2luZyA9IGZhbHNlOyAvLyBpcyBub3QgaW4gbW90aW9uXG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKGRpcmVjdGlvbiA9PT0gJ25leHQnKSB7XG4gICAgICAgIC8vIFByZXZlbnQgY2FuY2VsaW5nIGluIGZ1dHVyZSBmdW5jdGlvbnMgb3IgbGFjayB0aGVyZS1vZiBmcm9tIG5lZ2F0aW5nIHByZXZpb3VzIGNvbW1hbmRzIHRvIGNhbmNlbFxuICAgICAgICBpZiAoIXNsaWRlci5zZXR0aW5ncy5vblNsaWRlTmV4dC5jYWxsKGVsLCBzbGlkZXIuY2hpbGRyZW4uZXEoc2xpZGVyLmFjdGl2ZS5pbmRleCksIHNsaWRlci5vbGRJbmRleCwgc2xpZGVyLmFjdGl2ZS5pbmRleCkpIHtcbiAgICAgICAgICBwZXJmb3JtVHJhbnNpdGlvbiA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gJ3ByZXYnKSB7XG4gICAgICAgIC8vIFByZXZlbnQgY2FuY2VsaW5nIGluIGZ1dHVyZSBmdW5jdGlvbnMgb3IgbGFjayB0aGVyZS1vZiBmcm9tIG5lZ2F0aW5nIHByZXZpb3VzIGNvbW1hbmRzIHRvIGNhbmNlbFxuICAgICAgICBpZiAoIXNsaWRlci5zZXR0aW5ncy5vblNsaWRlUHJldi5jYWxsKGVsLCBzbGlkZXIuY2hpbGRyZW4uZXEoc2xpZGVyLmFjdGl2ZS5pbmRleCksIHNsaWRlci5vbGRJbmRleCwgc2xpZGVyLmFjdGl2ZS5pbmRleCkpIHtcbiAgICAgICAgICBwZXJmb3JtVHJhbnNpdGlvbiA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIGNoZWNrIGlmIGxhc3Qgc2xpZGVcbiAgICAgIHNsaWRlci5hY3RpdmUubGFzdCA9IHNsaWRlci5hY3RpdmUuaW5kZXggPj0gZ2V0UGFnZXJRdHkoKSAtIDE7XG4gICAgICAvLyB1cGRhdGUgdGhlIHBhZ2VyIHdpdGggYWN0aXZlIGNsYXNzXG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLnBhZ2VyIHx8IHNsaWRlci5zZXR0aW5ncy5wYWdlckN1c3RvbSkgeyB1cGRhdGVQYWdlckFjdGl2ZShzbGlkZXIuYWN0aXZlLmluZGV4KTsgfVxuICAgICAgLy8gLy8gY2hlY2sgZm9yIGRpcmVjdGlvbiBjb250cm9sIHVwZGF0ZVxuICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5jb250cm9scykgeyB1cGRhdGVEaXJlY3Rpb25Db250cm9scygpOyB9XG4gICAgICAvLyBpZiBzbGlkZXIgaXMgc2V0IHRvIG1vZGU6IFwiZmFkZVwiXG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLm1vZGUgPT09ICdmYWRlJykge1xuICAgICAgICAvLyBpZiBhZGFwdGl2ZUhlaWdodCBpcyB0cnVlIGFuZCBuZXh0IGhlaWdodCBpcyBkaWZmZXJlbnQgZnJvbSBjdXJyZW50IGhlaWdodCwgYW5pbWF0ZSB0byB0aGUgbmV3IGhlaWdodFxuICAgICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmFkYXB0aXZlSGVpZ2h0ICYmIHNsaWRlci52aWV3cG9ydC5oZWlnaHQoKSAhPT0gZ2V0Vmlld3BvcnRIZWlnaHQoKSkge1xuICAgICAgICAgIHNsaWRlci52aWV3cG9ydC5hbmltYXRlKHtoZWlnaHQ6IGdldFZpZXdwb3J0SGVpZ2h0KCl9LCBzbGlkZXIuc2V0dGluZ3MuYWRhcHRpdmVIZWlnaHRTcGVlZCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gZmFkZSBvdXQgdGhlIHZpc2libGUgY2hpbGQgYW5kIHJlc2V0IGl0cyB6LWluZGV4IHZhbHVlXG4gICAgICAgIHNsaWRlci5jaGlsZHJlbi5maWx0ZXIoJzp2aXNpYmxlJykuZmFkZU91dChzbGlkZXIuc2V0dGluZ3Muc3BlZWQpLmNzcyh7ekluZGV4OiAwfSk7XG4gICAgICAgIC8vIGZhZGUgaW4gdGhlIG5ld2x5IHJlcXVlc3RlZCBzbGlkZVxuICAgICAgICBzbGlkZXIuY2hpbGRyZW4uZXEoc2xpZGVyLmFjdGl2ZS5pbmRleCkuY3NzKCd6SW5kZXgnLCBzbGlkZXIuc2V0dGluZ3Muc2xpZGVaSW5kZXggKyAxKS5mYWRlSW4oc2xpZGVyLnNldHRpbmdzLnNwZWVkLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAkKHRoaXMpLmNzcygnekluZGV4Jywgc2xpZGVyLnNldHRpbmdzLnNsaWRlWkluZGV4KTtcbiAgICAgICAgICB1cGRhdGVBZnRlclNsaWRlVHJhbnNpdGlvbigpO1xuICAgICAgICB9KTtcbiAgICAgIC8vIHNsaWRlciBtb2RlIGlzIG5vdCBcImZhZGVcIlxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gaWYgYWRhcHRpdmVIZWlnaHQgaXMgdHJ1ZSBhbmQgbmV4dCBoZWlnaHQgaXMgZGlmZmVyZW50IGZyb20gY3VycmVudCBoZWlnaHQsIGFuaW1hdGUgdG8gdGhlIG5ldyBoZWlnaHRcbiAgICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5hZGFwdGl2ZUhlaWdodCAmJiBzbGlkZXIudmlld3BvcnQuaGVpZ2h0KCkgIT09IGdldFZpZXdwb3J0SGVpZ2h0KCkpIHtcbiAgICAgICAgICBzbGlkZXIudmlld3BvcnQuYW5pbWF0ZSh7aGVpZ2h0OiBnZXRWaWV3cG9ydEhlaWdodCgpfSwgc2xpZGVyLnNldHRpbmdzLmFkYXB0aXZlSGVpZ2h0U3BlZWQpO1xuICAgICAgICB9XG4gICAgICAgIC8vIGlmIGNhcm91c2VsIGFuZCBub3QgaW5maW5pdGUgbG9vcFxuICAgICAgICBpZiAoIXNsaWRlci5zZXR0aW5ncy5pbmZpbml0ZUxvb3AgJiYgc2xpZGVyLmNhcm91c2VsICYmIHNsaWRlci5hY3RpdmUubGFzdCkge1xuICAgICAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MubW9kZSA9PT0gJ2hvcml6b250YWwnKSB7XG4gICAgICAgICAgICAvLyBnZXQgdGhlIGxhc3QgY2hpbGQgcG9zaXRpb25cbiAgICAgICAgICAgIGxhc3RDaGlsZCA9IHNsaWRlci5jaGlsZHJlbi5lcShzbGlkZXIuY2hpbGRyZW4ubGVuZ3RoIC0gMSk7XG4gICAgICAgICAgICBwb3NpdGlvbiA9IGxhc3RDaGlsZC5wb3NpdGlvbigpO1xuICAgICAgICAgICAgLy8gY2FsY3VsYXRlIHRoZSBwb3NpdGlvbiBvZiB0aGUgbGFzdCBzbGlkZVxuICAgICAgICAgICAgbW92ZUJ5ID0gc2xpZGVyLnZpZXdwb3J0LndpZHRoKCkgLSBsYXN0Q2hpbGQub3V0ZXJXaWR0aCgpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBnZXQgbGFzdCBzaG93aW5nIGluZGV4IHBvc2l0aW9uXG4gICAgICAgICAgICBsYXN0U2hvd2luZ0luZGV4ID0gc2xpZGVyLmNoaWxkcmVuLmxlbmd0aCAtIHNsaWRlci5zZXR0aW5ncy5taW5TbGlkZXM7XG4gICAgICAgICAgICBwb3NpdGlvbiA9IHNsaWRlci5jaGlsZHJlbi5lcShsYXN0U2hvd2luZ0luZGV4KS5wb3NpdGlvbigpO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvLyBob3Jpem9udGFsIGNhcm91c2VsLCBnb2luZyBwcmV2aW91cyB3aGlsZSBvbiBmaXJzdCBzbGlkZSAoaW5maW5pdGVMb29wIG1vZGUpXG4gICAgICAgIH0gZWxzZSBpZiAoc2xpZGVyLmNhcm91c2VsICYmIHNsaWRlci5hY3RpdmUubGFzdCAmJiBkaXJlY3Rpb24gPT09ICdwcmV2Jykge1xuICAgICAgICAgIC8vIGdldCB0aGUgbGFzdCBjaGlsZCBwb3NpdGlvblxuICAgICAgICAgIGVxID0gc2xpZGVyLnNldHRpbmdzLm1vdmVTbGlkZXMgPT09IDEgPyBzbGlkZXIuc2V0dGluZ3MubWF4U2xpZGVzIC0gZ2V0TW92ZUJ5KCkgOiAoKGdldFBhZ2VyUXR5KCkgLSAxKSAqIGdldE1vdmVCeSgpKSAtIChzbGlkZXIuY2hpbGRyZW4ubGVuZ3RoIC0gc2xpZGVyLnNldHRpbmdzLm1heFNsaWRlcyk7XG4gICAgICAgICAgbGFzdENoaWxkID0gZWwuY2hpbGRyZW4oJy5ieC1jbG9uZScpLmVxKGVxKTtcbiAgICAgICAgICBwb3NpdGlvbiA9IGxhc3RDaGlsZC5wb3NpdGlvbigpO1xuICAgICAgICAvLyBpZiBpbmZpbml0ZSBsb29wIGFuZCBcIk5leHRcIiBpcyBjbGlja2VkIG9uIHRoZSBsYXN0IHNsaWRlXG4gICAgICAgIH0gZWxzZSBpZiAoZGlyZWN0aW9uID09PSAnbmV4dCcgJiYgc2xpZGVyLmFjdGl2ZS5pbmRleCA9PT0gMCkge1xuICAgICAgICAgIC8vIGdldCB0aGUgbGFzdCBjbG9uZSBwb3NpdGlvblxuICAgICAgICAgIHBvc2l0aW9uID0gZWwuZmluZCgnPiAuYngtY2xvbmUnKS5lcShzbGlkZXIuc2V0dGluZ3MubWF4U2xpZGVzKS5wb3NpdGlvbigpO1xuICAgICAgICAgIHNsaWRlci5hY3RpdmUubGFzdCA9IGZhbHNlO1xuICAgICAgICAvLyBub3JtYWwgbm9uLXplcm8gcmVxdWVzdHNcbiAgICAgICAgfSBlbHNlIGlmIChzbGlkZUluZGV4ID49IDApIHtcbiAgICAgICAgICAvL3BhcnNlSW50IGlzIGFwcGxpZWQgdG8gYWxsb3cgZmxvYXRzIGZvciBzbGlkZXMvcGFnZVxuICAgICAgICAgIHJlcXVlc3RFbCA9IHNsaWRlSW5kZXggKiBwYXJzZUludChnZXRNb3ZlQnkoKSk7XG4gICAgICAgICAgcG9zaXRpb24gPSBzbGlkZXIuY2hpbGRyZW4uZXEocmVxdWVzdEVsKS5wb3NpdGlvbigpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyogSWYgdGhlIHBvc2l0aW9uIGRvZXNuJ3QgZXhpc3RcbiAgICAgICAgICogKGUuZy4gaWYgeW91IGRlc3Ryb3kgdGhlIHNsaWRlciBvbiBhIG5leHQgY2xpY2spLFxuICAgICAgICAgKiBpdCBkb2Vzbid0IHRocm93IGFuIGVycm9yLlxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKHR5cGVvZiAocG9zaXRpb24pICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgIHZhbHVlID0gc2xpZGVyLnNldHRpbmdzLm1vZGUgPT09ICdob3Jpem9udGFsJyA/IC0ocG9zaXRpb24ubGVmdCAtIG1vdmVCeSkgOiAtcG9zaXRpb24udG9wO1xuICAgICAgICAgIC8vIHBsdWdpbiB2YWx1ZXMgdG8gYmUgYW5pbWF0ZWRcbiAgICAgICAgICBzZXRQb3NpdGlvblByb3BlcnR5KHZhbHVlLCAnc2xpZGUnLCBzbGlkZXIuc2V0dGluZ3Muc3BlZWQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNsaWRlci53b3JraW5nID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MuYXJpYUhpZGRlbikgeyBhcHBseUFyaWFIaWRkZW5BdHRyaWJ1dGVzKHNsaWRlci5hY3RpdmUuaW5kZXggKiBnZXRNb3ZlQnkoKSk7IH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogVHJhbnNpdGlvbnMgdG8gdGhlIG5leHQgc2xpZGUgaW4gdGhlIHNob3dcbiAgICAgKi9cbiAgICBlbC5nb1RvTmV4dFNsaWRlID0gZnVuY3Rpb24oKSB7XG4gICAgICAvLyBpZiBpbmZpbml0ZUxvb3AgaXMgZmFsc2UgYW5kIGxhc3QgcGFnZSBpcyBzaG93aW5nLCBkaXNyZWdhcmQgY2FsbFxuICAgICAgaWYgKCFzbGlkZXIuc2V0dGluZ3MuaW5maW5pdGVMb29wICYmIHNsaWRlci5hY3RpdmUubGFzdCkgeyByZXR1cm47IH1cbiAgICAgIHZhciBwYWdlckluZGV4ID0gcGFyc2VJbnQoc2xpZGVyLmFjdGl2ZS5pbmRleCkgKyAxO1xuICAgICAgZWwuZ29Ub1NsaWRlKHBhZ2VySW5kZXgsICduZXh0Jyk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFRyYW5zaXRpb25zIHRvIHRoZSBwcmV2IHNsaWRlIGluIHRoZSBzaG93XG4gICAgICovXG4gICAgZWwuZ29Ub1ByZXZTbGlkZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgLy8gaWYgaW5maW5pdGVMb29wIGlzIGZhbHNlIGFuZCBsYXN0IHBhZ2UgaXMgc2hvd2luZywgZGlzcmVnYXJkIGNhbGxcbiAgICAgIGlmICghc2xpZGVyLnNldHRpbmdzLmluZmluaXRlTG9vcCAmJiBzbGlkZXIuYWN0aXZlLmluZGV4ID09PSAwKSB7IHJldHVybjsgfVxuICAgICAgdmFyIHBhZ2VySW5kZXggPSBwYXJzZUludChzbGlkZXIuYWN0aXZlLmluZGV4KSAtIDE7XG4gICAgICBlbC5nb1RvU2xpZGUocGFnZXJJbmRleCwgJ3ByZXYnKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogU3RhcnRzIHRoZSBhdXRvIHNob3dcbiAgICAgKlxuICAgICAqIEBwYXJhbSBwcmV2ZW50Q29udHJvbFVwZGF0ZSAoYm9vbGVhbilcbiAgICAgKiAgLSBpZiB0cnVlLCBhdXRvIGNvbnRyb2xzIHN0YXRlIHdpbGwgbm90IGJlIHVwZGF0ZWRcbiAgICAgKi9cbiAgICBlbC5zdGFydEF1dG8gPSBmdW5jdGlvbihwcmV2ZW50Q29udHJvbFVwZGF0ZSkge1xuICAgICAgLy8gaWYgYW4gaW50ZXJ2YWwgYWxyZWFkeSBleGlzdHMsIGRpc3JlZ2FyZCBjYWxsXG4gICAgICBpZiAoc2xpZGVyLmludGVydmFsKSB7IHJldHVybjsgfVxuICAgICAgLy8gY3JlYXRlIGFuIGludGVydmFsXG4gICAgICBzbGlkZXIuaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5hdXRvRGlyZWN0aW9uID09PSAnbmV4dCcpIHtcbiAgICAgICAgICBlbC5nb1RvTmV4dFNsaWRlKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZWwuZ29Ub1ByZXZTbGlkZSgpO1xuICAgICAgICB9XG4gICAgICB9LCBzbGlkZXIuc2V0dGluZ3MucGF1c2UpO1xuICAgICAgLy8gaWYgYXV0byBjb250cm9scyBhcmUgZGlzcGxheWVkIGFuZCBwcmV2ZW50Q29udHJvbFVwZGF0ZSBpcyBub3QgdHJ1ZVxuICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5hdXRvQ29udHJvbHMgJiYgcHJldmVudENvbnRyb2xVcGRhdGUgIT09IHRydWUpIHsgdXBkYXRlQXV0b0NvbnRyb2xzKCdzdG9wJyk7IH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogU3RvcHMgdGhlIGF1dG8gc2hvd1xuICAgICAqXG4gICAgICogQHBhcmFtIHByZXZlbnRDb250cm9sVXBkYXRlIChib29sZWFuKVxuICAgICAqICAtIGlmIHRydWUsIGF1dG8gY29udHJvbHMgc3RhdGUgd2lsbCBub3QgYmUgdXBkYXRlZFxuICAgICAqL1xuICAgIGVsLnN0b3BBdXRvID0gZnVuY3Rpb24ocHJldmVudENvbnRyb2xVcGRhdGUpIHtcbiAgICAgIC8vIGlmIG5vIGludGVydmFsIGV4aXN0cywgZGlzcmVnYXJkIGNhbGxcbiAgICAgIGlmICghc2xpZGVyLmludGVydmFsKSB7IHJldHVybjsgfVxuICAgICAgLy8gY2xlYXIgdGhlIGludGVydmFsXG4gICAgICBjbGVhckludGVydmFsKHNsaWRlci5pbnRlcnZhbCk7XG4gICAgICBzbGlkZXIuaW50ZXJ2YWwgPSBudWxsO1xuICAgICAgLy8gaWYgYXV0byBjb250cm9scyBhcmUgZGlzcGxheWVkIGFuZCBwcmV2ZW50Q29udHJvbFVwZGF0ZSBpcyBub3QgdHJ1ZVxuICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5hdXRvQ29udHJvbHMgJiYgcHJldmVudENvbnRyb2xVcGRhdGUgIT09IHRydWUpIHsgdXBkYXRlQXV0b0NvbnRyb2xzKCdzdGFydCcpOyB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgY3VycmVudCBzbGlkZSBpbmRleCAoemVyby1iYXNlZClcbiAgICAgKi9cbiAgICBlbC5nZXRDdXJyZW50U2xpZGUgPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBzbGlkZXIuYWN0aXZlLmluZGV4O1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGN1cnJlbnQgc2xpZGUgZWxlbWVudFxuICAgICAqL1xuICAgIGVsLmdldEN1cnJlbnRTbGlkZUVsZW1lbnQgPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBzbGlkZXIuY2hpbGRyZW4uZXEoc2xpZGVyLmFjdGl2ZS5pbmRleCk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBzbGlkZSBlbGVtZW50XG4gICAgICogQHBhcmFtIGluZGV4IChpbnQpXG4gICAgICogIC0gVGhlIGluZGV4ICh6ZXJvLWJhc2VkKSBvZiB0aGUgZWxlbWVudCB5b3Ugd2FudCByZXR1cm5lZC5cbiAgICAgKi9cbiAgICBlbC5nZXRTbGlkZUVsZW1lbnQgPSBmdW5jdGlvbihpbmRleCkge1xuICAgICAgcmV0dXJuIHNsaWRlci5jaGlsZHJlbi5lcShpbmRleCk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgbnVtYmVyIG9mIHNsaWRlcyBpbiBzaG93XG4gICAgICovXG4gICAgZWwuZ2V0U2xpZGVDb3VudCA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHNsaWRlci5jaGlsZHJlbi5sZW5ndGg7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybiBzbGlkZXIud29ya2luZyB2YXJpYWJsZVxuICAgICAqL1xuICAgIGVsLmlzV29ya2luZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHNsaWRlci53b3JraW5nO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgYWxsIGR5bmFtaWMgc2xpZGVyIGVsZW1lbnRzXG4gICAgICovXG4gICAgZWwucmVkcmF3U2xpZGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAvLyByZXNpemUgYWxsIGNoaWxkcmVuIGluIHJhdGlvIHRvIG5ldyBzY3JlZW4gc2l6ZVxuICAgICAgc2xpZGVyLmNoaWxkcmVuLmFkZChlbC5maW5kKCcuYngtY2xvbmUnKSkub3V0ZXJXaWR0aChnZXRTbGlkZVdpZHRoKCkpO1xuICAgICAgLy8gYWRqdXN0IHRoZSBoZWlnaHRcbiAgICAgIHNsaWRlci52aWV3cG9ydC5jc3MoJ2hlaWdodCcsIGdldFZpZXdwb3J0SGVpZ2h0KCkpO1xuICAgICAgLy8gdXBkYXRlIHRoZSBzbGlkZSBwb3NpdGlvblxuICAgICAgaWYgKCFzbGlkZXIuc2V0dGluZ3MudGlja2VyKSB7IHNldFNsaWRlUG9zaXRpb24oKTsgfVxuICAgICAgLy8gaWYgYWN0aXZlLmxhc3Qgd2FzIHRydWUgYmVmb3JlIHRoZSBzY3JlZW4gcmVzaXplLCB3ZSB3YW50XG4gICAgICAvLyB0byBrZWVwIGl0IGxhc3Qgbm8gbWF0dGVyIHdoYXQgc2NyZWVuIHNpemUgd2UgZW5kIG9uXG4gICAgICBpZiAoc2xpZGVyLmFjdGl2ZS5sYXN0KSB7IHNsaWRlci5hY3RpdmUuaW5kZXggPSBnZXRQYWdlclF0eSgpIC0gMTsgfVxuICAgICAgLy8gaWYgdGhlIGFjdGl2ZSBpbmRleCAocGFnZSkgbm8gbG9uZ2VyIGV4aXN0cyBkdWUgdG8gdGhlIHJlc2l6ZSwgc2ltcGx5IHNldCB0aGUgaW5kZXggYXMgbGFzdFxuICAgICAgaWYgKHNsaWRlci5hY3RpdmUuaW5kZXggPj0gZ2V0UGFnZXJRdHkoKSkgeyBzbGlkZXIuYWN0aXZlLmxhc3QgPSB0cnVlOyB9XG4gICAgICAvLyBpZiBhIHBhZ2VyIGlzIGJlaW5nIGRpc3BsYXllZCBhbmQgYSBjdXN0b20gcGFnZXIgaXMgbm90IGJlaW5nIHVzZWQsIHVwZGF0ZSBpdFxuICAgICAgaWYgKHNsaWRlci5zZXR0aW5ncy5wYWdlciAmJiAhc2xpZGVyLnNldHRpbmdzLnBhZ2VyQ3VzdG9tKSB7XG4gICAgICAgIHBvcHVsYXRlUGFnZXIoKTtcbiAgICAgICAgdXBkYXRlUGFnZXJBY3RpdmUoc2xpZGVyLmFjdGl2ZS5pbmRleCk7XG4gICAgICB9XG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmFyaWFIaWRkZW4pIHsgYXBwbHlBcmlhSGlkZGVuQXR0cmlidXRlcyhzbGlkZXIuYWN0aXZlLmluZGV4ICogZ2V0TW92ZUJ5KCkpOyB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIERlc3Ryb3kgdGhlIGN1cnJlbnQgaW5zdGFuY2Ugb2YgdGhlIHNsaWRlciAocmV2ZXJ0IGV2ZXJ5dGhpbmcgYmFjayB0byBvcmlnaW5hbCBzdGF0ZSlcbiAgICAgKi9cbiAgICBlbC5kZXN0cm95U2xpZGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAvLyBkb24ndCBkbyBhbnl0aGluZyBpZiBzbGlkZXIgaGFzIGFscmVhZHkgYmVlbiBkZXN0cm95ZWRcbiAgICAgIGlmICghc2xpZGVyLmluaXRpYWxpemVkKSB7IHJldHVybjsgfVxuICAgICAgc2xpZGVyLmluaXRpYWxpemVkID0gZmFsc2U7XG4gICAgICAkKCcuYngtY2xvbmUnLCB0aGlzKS5yZW1vdmUoKTtcbiAgICAgIHNsaWRlci5jaGlsZHJlbi5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoJCh0aGlzKS5kYXRhKCdvcmlnU3R5bGUnKSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgJCh0aGlzKS5hdHRyKCdzdHlsZScsICQodGhpcykuZGF0YSgnb3JpZ1N0eWxlJykpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICQodGhpcykucmVtb3ZlQXR0cignc3R5bGUnKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBpZiAoJCh0aGlzKS5kYXRhKCdvcmlnU3R5bGUnKSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHRoaXMuYXR0cignc3R5bGUnLCAkKHRoaXMpLmRhdGEoJ29yaWdTdHlsZScpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICQodGhpcykucmVtb3ZlQXR0cignc3R5bGUnKTtcbiAgICAgIH1cbiAgICAgICQodGhpcykudW53cmFwKCkudW53cmFwKCk7XG4gICAgICBpZiAoc2xpZGVyLmNvbnRyb2xzLmVsKSB7IHNsaWRlci5jb250cm9scy5lbC5yZW1vdmUoKTsgfVxuICAgICAgaWYgKHNsaWRlci5jb250cm9scy5uZXh0KSB7IHNsaWRlci5jb250cm9scy5uZXh0LnJlbW92ZSgpOyB9XG4gICAgICBpZiAoc2xpZGVyLmNvbnRyb2xzLnByZXYpIHsgc2xpZGVyLmNvbnRyb2xzLnByZXYucmVtb3ZlKCk7IH1cbiAgICAgIGlmIChzbGlkZXIucGFnZXJFbCAmJiBzbGlkZXIuc2V0dGluZ3MuY29udHJvbHMgJiYgIXNsaWRlci5zZXR0aW5ncy5wYWdlckN1c3RvbSkgeyBzbGlkZXIucGFnZXJFbC5yZW1vdmUoKTsgfVxuICAgICAgJCgnLmJ4LWNhcHRpb24nLCB0aGlzKS5yZW1vdmUoKTtcbiAgICAgIGlmIChzbGlkZXIuY29udHJvbHMuYXV0b0VsKSB7IHNsaWRlci5jb250cm9scy5hdXRvRWwucmVtb3ZlKCk7IH1cbiAgICAgIGNsZWFySW50ZXJ2YWwoc2xpZGVyLmludGVydmFsKTtcbiAgICAgIGlmIChzbGlkZXIuc2V0dGluZ3MucmVzcG9uc2l2ZSkgeyAkKHdpbmRvdykudW5iaW5kKCdyZXNpemUnLCByZXNpemVXaW5kb3cpOyB9XG4gICAgICBpZiAoc2xpZGVyLnNldHRpbmdzLmtleWJvYXJkRW5hYmxlZCkgeyAkKGRvY3VtZW50KS51bmJpbmQoJ2tleWRvd24nLCBrZXlQcmVzcyk7IH1cbiAgICAgIC8vcmVtb3ZlIHNlbGYgcmVmZXJlbmNlIGluIGRhdGFcbiAgICAgICQodGhpcykucmVtb3ZlRGF0YSgnYnhTbGlkZXInKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUmVsb2FkIHRoZSBzbGlkZXIgKHJldmVydCBhbGwgRE9NIGNoYW5nZXMsIGFuZCByZS1pbml0aWFsaXplKVxuICAgICAqL1xuICAgIGVsLnJlbG9hZFNsaWRlciA9IGZ1bmN0aW9uKHNldHRpbmdzKSB7XG4gICAgICBpZiAoc2V0dGluZ3MgIT09IHVuZGVmaW5lZCkgeyBvcHRpb25zID0gc2V0dGluZ3M7IH1cbiAgICAgIGVsLmRlc3Ryb3lTbGlkZXIoKTtcbiAgICAgIGluaXQoKTtcbiAgICAgIC8vc3RvcmUgcmVmZXJlbmNlIHRvIHNlbGYgaW4gb3JkZXIgdG8gYWNjZXNzIHB1YmxpYyBmdW5jdGlvbnMgbGF0ZXJcbiAgICAgICQoZWwpLmRhdGEoJ2J4U2xpZGVyJywgdGhpcyk7XG4gICAgfTtcblxuICAgIGluaXQoKTtcblxuICAgICQoZWwpLmRhdGEoJ2J4U2xpZGVyJywgdGhpcyk7XG5cbiAgICAvLyByZXR1cm5zIHRoZSBjdXJyZW50IGpRdWVyeSBvYmplY3RcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxufSkoalF1ZXJ5KTtcbiJdfQ==
