var PureSlider=function(){function s(s){this.options=t({},i,s),this.vars={slider:null,slides:[],sliderNav:null,currentSlide:null,currentCursor:null,currentDefined:!1,cursors:[],index:0,max:0,rotate:!0,interval:null,isStarted:!1,hasNav:!1,prevBtn:null,nextBtn:null,hasBtn:!1,direction:this.options.direction,slidesLaps:[],loader:null}}var t=function(s){var t=arguments.length;if(t<2||null==s)return s;for(var i=1;i<t;i++)for(var e=arguments[i],r=function(s){var t=[];for(var i in s)s.hasOwnProperty(i)&&t.push(i);return t}(e),n=0;n<r.length;n++)s[r[n]]=e[r[n]];return s},i={autoplay:!1,laps:3e3,showNav:!0,showBtn:!0,direction:"forward",currentCursorClassName:"ps-current",currentSlideClassName:"ps-current",slideClassName:"ps-slide",slidesClassName:"ps-slides",sliderNavClassName:"ps-slider-nav",prevBtnClassName:"ps-left-nav-btn",prevBtnHtml:"prev",nextBtnClassName:"ps-right-nav-btn",nextBtnHtml:"next",stopOnHover:!0,onBeforeSlideChangeCb:function(){},onAfterSlideChangeCb:function(){},onBeforeStartCb:function(){},onAfterStartCb:function(){},onBeforeStopCb:function(){},onAfterStopCb:function(){},onBeforeInitCb:function(){},onAfterInitCb:function(){}};return s.prototype={init:function(s){this.options.onBeforeInitCb(this),this.vars.slider=s,this.vars.slides=[].slice.call(this.vars.slider.querySelector("."+this.options.slidesClassName).children),this.vars.max=this.vars.slides.length-1,this.createLoader();var t=0,i=this,e=this.vars.slides.length;this.vars.slides.forEach(function(s,r){var n=document.createElement("img");n.addEventListener("load",function(s){n=null,++t==e&&i.initAfterLoading()}),n.src=getComputedStyle(s).backgroundImage.slice(4,-1).replace(/"/g,"")})},createLoader:function(){this.vars.loader=document.createElement("div"),this.vars.loader.innerHTML='<div class="ps-double-bounce1"></div><div class="ps-double-bounce2"></div>',this.vars.loader.classList.add("ps-loader"),this.vars.slider.appendChild(this.vars.loader)},destroyLoader:function(){this.vars.slider.removeChild(this.vars.loader),this.vars.loader=null},initAfterLoading:function(){this.destroyLoader(),this.vars.slides.forEach(function(s,t){s.classList.contains(this.options.currentSlideClassName)&&(this.vars.currentDefined?s.classList.remove(this.options.currentSlideClassName):(this.vars.currentDefined=!0,this.vars.index=t,this.vars.currentSlide=s)),s.hasAttribute("data-slide-laps")?this.vars.slidesLaps.push(1e3*parseInt(s.getAttribute("data-slide-laps"))):this.vars.slidesLaps.push(this.options.laps)},this),this.vars.currentDefined||(this.vars.slides[0].classList.add(this.options.currentSlideClassName),this.vars.currentSlide=this.vars.slides[0]),this.options.showBtn&&(this.buildBtn(),this.vars.hasBtn&&this.initBtnEvents()),this.options.showNav&&this.buildNav(),this.options.autoplay&&(this.vars.rotate=!0),this.setStopOnHover(),this.start(),this.options.onAfterInitCb(this)},setStopOnHover:function(){if(this.options.stopOnHover&&this.options.autoplay){var s=this;this.vars.slider.addEventListener("mouseenter",function(t){t.preventDefault(),s.stop()}),this.vars.slider.addEventListener("mouseleave",function(t){t.preventDefault();var i=window.setTimeout(function(){window.clearTimeout(i),"forward"===s.vars.direction?s.next(!0):s.prev(!0)},s.options.laps/2)})}},buildBtn:function(){this.vars.prevBtn=document.createElement("button"),this.vars.prevBtn.innerHTML=this.options.prevBtnHtml,this.vars.prevBtn.classList.add(this.options.prevBtnClassName),this.vars.slider.appendChild(this.vars.prevBtn),this.vars.nextBtn=document.createElement("button"),this.vars.nextBtn.innerHTML=this.options.nextBtnHtml,this.vars.nextBtn.classList.add(this.options.nextBtnClassName),this.vars.slider.appendChild(this.vars.nextBtn),this.vars.hasBtn=!0},buildNav:function(){var s=document.createElement("div");s.classList.add(this.options.sliderNavClassName);var t=document.createElement("ul");this.vars.slides.forEach(function(s,i){var e=document.createElement("li"),r=document.createElement("a");s.classList.contains(this.options.currentSlideClassName)&&(r.classList.add(this.options.currentCursorClassName),this.vars.currentCursor=r,this.vars.index=i),r.addEventListener("click",this.onClickCursorEvent.bind(this)),this.vars.cursors.push(r),e.appendChild(r),t.appendChild(e)},this),s.appendChild(t),this.vars.slider.appendChild(s),this.vars.hasNav=!0},initBtnEvents:function(){var s=this;this.vars.nextBtn.addEventListener("click",function(t){t.preventDefault(),s.next()}),this.vars.prevBtn.addEventListener("click",function(t){t.preventDefault(),s.prev()})},onClickCursorEvent:function(s){s.preventDefault(),this.stop();var t=s.target,i=this.vars.cursors.indexOf(t);this.gotoSlide(i),this.start()},gotoSlide:function(s){null!==s&&void 0!=s||(s=this.vars.index),this.vars.slides[s]&&this.vars.currentSlide!==this.vars.slides[s]&&(this.vars.index=s,this.vars.hasNav&&(this.vars.currentCursor.classList.remove(this.options.currentCursorClassName),this.vars.currentCursor=this.vars.cursors[this.vars.index],this.vars.currentCursor.classList.add(this.options.currentCursorClassName)),this.vars.currentSlide.classList.remove(this.options.currentSlideClassName),this.vars.currentSlide=this.vars.slides[this.vars.index],this.vars.currentSlide.classList.add(this.options.currentSlideClassName))},next:function(s){this.stop(),null!==s&&void 0!=s||(s=this.vars.rotate),this.vars.index+=1,this.vars.index>this.vars.max&&(this.vars.index=!0===s?0:this.vars.max),this.gotoSlide(),this.start()},prev:function(s){this.stop(),null!==s&&void 0!=s||(s=this.vars.rotate),this.vars.index-=1,this.vars.index<0&&(this.vars.index=!0===s?this.vars.max:0),this.gotoSlide(),this.start()},start:function(){if(this.options.autoplay){this.options.onBeforeStartCb(this),this.vars.isStarted=!0;var s=this;this.vars.interval=window.setInterval(function(){"forward"===s.vars.direction?s.next(s.vars.rotate):s.prev(s.vars.rotate),s.options.onAfterStartCb(this)},this.vars.slidesLaps[this.vars.index])}},stop:function(){this.options.onBeforeStopCb(this),this.vars.isStarted=!1,null!=this.vars.interval&&(window.clearInterval(this.vars.interval),this.vars.interval=null),this.options.onAfterStopCb(this)}},s}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlB1cmVTbGlkZXIuanMiXSwibmFtZXMiOlsiUHVyZVNsaWRlciIsIm9wdGlvbnMiLCJ0aGlzIiwiX2V4dGVuZCIsIkRFRkFVTFRTIiwidmFycyIsInNsaWRlciIsInNsaWRlcyIsInNsaWRlck5hdiIsImN1cnJlbnRTbGlkZSIsImN1cnJlbnRDdXJzb3IiLCJjdXJyZW50RGVmaW5lZCIsImN1cnNvcnMiLCJpbmRleCIsIm1heCIsInJvdGF0ZSIsImludGVydmFsIiwiaXNTdGFydGVkIiwiaGFzTmF2IiwicHJldkJ0biIsIm5leHRCdG4iLCJoYXNCdG4iLCJkaXJlY3Rpb24iLCJzbGlkZXNMYXBzIiwibG9hZGVyIiwib2JqIiwibGVuZ3RoIiwiYXJndW1lbnRzIiwic291cmNlT2JqIiwia2V5cyIsInByb3AiLCJoYXNPd25Qcm9wZXJ0eSIsInB1c2giLCJpIiwiYXV0b3BsYXkiLCJsYXBzIiwic2hvd05hdiIsInNob3dCdG4iLCJjdXJyZW50Q3Vyc29yQ2xhc3NOYW1lIiwiY3VycmVudFNsaWRlQ2xhc3NOYW1lIiwic2xpZGVDbGFzc05hbWUiLCJzbGlkZXNDbGFzc05hbWUiLCJzbGlkZXJOYXZDbGFzc05hbWUiLCJwcmV2QnRuQ2xhc3NOYW1lIiwicHJldkJ0bkh0bWwiLCJuZXh0QnRuQ2xhc3NOYW1lIiwibmV4dEJ0bkh0bWwiLCJzdG9wT25Ib3ZlciIsIm9uQmVmb3JlU2xpZGVDaGFuZ2VDYiIsIm9uQWZ0ZXJTbGlkZUNoYW5nZUNiIiwib25CZWZvcmVTdGFydENiIiwib25BZnRlclN0YXJ0Q2IiLCJvbkJlZm9yZVN0b3BDYiIsIm9uQWZ0ZXJTdG9wQ2IiLCJvbkJlZm9yZUluaXRDYiIsIm9uQWZ0ZXJJbml0Q2IiLCJwcm90b3R5cGUiLCJpbml0IiwiZWxlbWVudCIsInNsaWNlIiwiY2FsbCIsInF1ZXJ5U2VsZWN0b3IiLCJjaGlsZHJlbiIsImNyZWF0ZUxvYWRlciIsInRvdGFsTG9hZGVkIiwic2VsZiIsInRvdGFsVG9Mb2FkIiwiZm9yRWFjaCIsIml0ZW0iLCJpZHgiLCJpbWciLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsImluaXRBZnRlckxvYWRpbmciLCJzcmMiLCJnZXRDb21wdXRlZFN0eWxlIiwiYmFja2dyb3VuZEltYWdlIiwicmVwbGFjZSIsImlubmVySFRNTCIsImNsYXNzTGlzdCIsImFkZCIsImFwcGVuZENoaWxkIiwiZGVzdHJveUxvYWRlciIsInJlbW92ZUNoaWxkIiwiY29udGFpbnMiLCJyZW1vdmUiLCJoYXNBdHRyaWJ1dGUiLCJwYXJzZUludCIsImdldEF0dHJpYnV0ZSIsImJ1aWxkQnRuIiwiaW5pdEJ0bkV2ZW50cyIsImJ1aWxkTmF2Iiwic2V0U3RvcE9uSG92ZXIiLCJzdGFydCIsImV2dCIsInByZXZlbnREZWZhdWx0Iiwic3RvcCIsInRvIiwid2luZG93Iiwic2V0VGltZW91dCIsImNsZWFyVGltZW91dCIsIm5leHQiLCJwcmV2IiwiZGl2IiwidWwiLCJsaSIsImEiLCJvbkNsaWNrQ3Vyc29yRXZlbnQiLCJiaW5kIiwidCIsInRhcmdldCIsImluZGV4T2YiLCJnb3RvU2xpZGUiLCJzZXRJbnRlcnZhbCIsImNsZWFySW50ZXJ2YWwiXSwibWFwcGluZ3MiOiJBQUFBLElBQUlBLFdBQWEsV0EwRGIsU0FBU0EsRUFBV0MsR0FDaEJDLEtBQUtELFFBQVVFLEtBQVlDLEVBQVVILEdBQ3JDQyxLQUFLRyxNQUNEQyxPQUFRLEtBQ1JDLFVBQ0FDLFVBQVcsS0FDWEMsYUFBYyxLQUNkQyxjQUFlLEtBQ2ZDLGdCQUFBQSxFQUNBQyxXQUNBQyxNQUFPLEVBQ1BDLElBQUssRUFDTEMsUUFBQUEsRUFDQUMsU0FBVSxLQUNWQyxXQUFBQSxFQUNBQyxRQUFBQSxFQUNBQyxRQUFTLEtBQ1RDLFFBQVMsS0FDVEMsUUFBQUEsRUFDQUMsVUFBV3BCLEtBQUtELFFBQVFxQixVQUN4QkMsY0FDQUMsT0FBUSxNQTlFaEIsSUFBSXJCLEVBQVUsU0FBVXNCLEdBQ3BCLElBQUlDLEVBQVNDLFVBQVVELE9BQ3ZCLEdB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WmIsS0FBS2dHLE9BQ1UsT0FBWG5GLFFBQUFBLEdBQW1CQSxJQUNuQkEsRUFBU2IsS0FBS0csS0FBS1UsUUFFdkJiLEtBQUtHLEtBQUtRLE9BQVMsRUFDZlgsS0FBS0csS0FBS1EsTUFBUSxJQUVkWCxLQUFLRyxLQUFLUSxPQUFBQSxJQURWRSxFQUNrQmIsS0FBS0csS0FBS1MsSUFFVixHQUcxQlosS0FBS2dILFlBQ0xoSCxLQUFLNkYsU0FFVEEsTUFBTyxXQUNILEdBQUs3RixLQUFLRCxRQUFRaUMsU0FBbEIsQ0FHQWhDLEtBQUtELFFBQVFpRCxnQkFBZ0JoRCxNQUM3QkEsS0FBS0csS0FBS1ksV0FBQUEsRUFDVixJQUFJZ0QsRUFBTy9ELEtBQ1hBLEtBQUtHLEtBQUtXLFNBQVdvRixPQUFPZSxZQUFZLFdBQ1IsWUFBeEJsRCxFQUFLNUQsS0FBS2lCLFVBQ1YyQyxFQUFLc0MsS0FBS3RDLEVBQUs1RCxLQUFLVSxRQUVwQmtELEVBQUt1QyxLQUFLdkMsRUFBSzVELEtBQUtVLFFBRXhCa0QsRUFBS2hFLFFBQVFrRCxlQUFlakQsT0FDN0JBLEtBQUtHLEtBQUtrQixXQUFXckIsS0FBS0csS0FBS1EsVUFFdENxRixLQUFNLFdBQ0ZoRyxLQUFLRCxRQUFRbUQsZUFBZWxELE1BQzVCQSxLQUFLRyxLQUFLWSxXQUFBQSxFQUNnQixNQUF0QmYsS0FBS0csS0FBS1csV0FDVm9GLE9BQU9nQixjQUFjbEgsS0FBS0csS0FBS1csVUFDL0JkLEtBQUtHLEtBQUtXLFNBQVcsTUFFekJkLEtBQUtELFFBQVFvRCxjQUFjbkQsUUFHNUJGLEVBN1NNIiwiZmlsZSI6IlB1cmVTbGlkZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgUHVyZVNsaWRlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIF9leHRlbmQgPSBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgIHZhciBsZW5ndGggPSBhcmd1bWVudHMubGVuZ3RoO1xuICAgICAgICBpZiAobGVuZ3RoIDwgMiB8fCBvYmogPT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBhbGxLZXlzKG9iaikge1xuICAgICAgICAgICAgdmFyIGtleXMgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIHByb3AgaW4gb2JqKSB7XG4gICAgICAgICAgICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShwcm9wKSkge1xuICAgICAgICAgICAgICAgICAgICBrZXlzLnB1c2gocHJvcCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGtleXM7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKHZhciBpbmRleCA9IDE7IGluZGV4IDwgbGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICAgICAgICB2YXIgc291cmNlT2JqID0gYXJndW1lbnRzW2luZGV4XSxcbiAgICAgICAgICAgICAgICBrZXlzID0gYWxsS2V5cyhzb3VyY2VPYmopO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgb2JqW2tleXNbaV1dID0gc291cmNlT2JqW2tleXNbaV1dO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgfTtcbiAgICB2YXIgREVGQVVMVFMgPSB7XG4gICAgICAgIGF1dG9wbGF5OiBmYWxzZSxcbiAgICAgICAgbGFwczogMzAwMCxcbiAgICAgICAgc2hvd05hdjogdHJ1ZSxcbiAgICAgICAgc2hvd0J0bjogdHJ1ZSxcbiAgICAgICAgZGlyZWN0aW9uOiAnZm9yd2FyZCcsIC8vIGJhY2t3YXJkLFxuICAgICAgICBjdXJyZW50Q3Vyc29yQ2xhc3NOYW1lOiAncHMtY3VycmVudCcsXG4gICAgICAgIGN1cnJlbnRTbGlkZUNsYXNzTmFtZTogJ3BzLWN1cnJlbnQnLFxuICAgICAgICBzbGlkZUNsYXNzTmFtZTogJ3BzLXNsaWRlJyxcbiAgICAgICAgc2xpZGVzQ2xhc3NOYW1lOiAncHMtc2xpZGVzJyxcbiAgICAgICAgc2xpZGVyTmF2Q2xhc3NOYW1lOiAncHMtc2xpZGVyLW5hdicsXG4gICAgICAgIHByZXZCdG5DbGFzc05hbWU6ICdwcy1sZWZ0LW5hdi1idG4nLFxuICAgICAgICBwcmV2QnRuSHRtbDogJ3ByZXYnLFxuICAgICAgICBuZXh0QnRuQ2xhc3NOYW1lOiAncHMtcmlnaHQtbmF2LWJ0bicsXG4gICAgICAgIG5leHRCdG5IdG1sOiAnbmV4dCcsXG4gICAgICAgIHN0b3BPbkhvdmVyOiB0cnVlLFxuICAgICAgICBvbkJlZm9yZVNsaWRlQ2hhbmdlQ2I6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgfSxcbiAgICAgICAgb25BZnRlclNsaWRlQ2hhbmdlQ2I6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgfSxcbiAgICAgICAgb25CZWZvcmVTdGFydENiOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIH0sXG4gICAgICAgIG9uQWZ0ZXJTdGFydENiOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIH0sXG4gICAgICAgIG9uQmVmb3JlU3RvcENiOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIH0sXG4gICAgICAgIG9uQWZ0ZXJTdG9wQ2I6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgfSxcbiAgICAgICAgb25CZWZvcmVJbml0Q2I6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgfSxcbiAgICAgICAgb25BZnRlckluaXRDYjogZnVuY3Rpb24gKCkge1xuICAgICAgICB9XG4gICAgfTtcbiAgICBmdW5jdGlvbiBQdXJlU2xpZGVyKG9wdGlvbnMpIHtcbiAgICAgICAgdGhpcy5vcHRpb25zID0gX2V4dGVuZCh7fSwgREVGQVVMVFMsIG9wdGlvbnMpO1xuICAgICAgICB0aGlzLnZhcnMgPSB7XG4gICAgICAgICAgICBzbGlkZXI6IG51bGwsXG4gICAgICAgICAgICBzbGlkZXM6IFtdLFxuICAgICAgICAgICAgc2xpZGVyTmF2OiBudWxsLFxuICAgICAgICAgICAgY3VycmVudFNsaWRlOiBudWxsLFxuICAgICAgICAgICAgY3VycmVudEN1cnNvcjogbnVsbCxcbiAgICAgICAgICAgIGN1cnJlbnREZWZpbmVkOiBmYWxzZSxcbiAgICAgICAgICAgIGN1cnNvcnM6IFtdLFxuICAgICAgICAgICAgaW5kZXg6IDAsXG4gICAgICAgICAgICBtYXg6IDAsXG4gICAgICAgICAgICByb3RhdGU6IHRydWUsXG4gICAgICAgICAgICBpbnRlcnZhbDogbnVsbCxcbiAgICAgICAgICAgIGlzU3RhcnRlZDogZmFsc2UsXG4gICAgICAgICAgICBoYXNOYXY6IGZhbHNlLFxuICAgICAgICAgICAgcHJldkJ0bjogbnVsbCxcbiAgICAgICAgICAgIG5leHRCdG46IG51bGwsXG4gICAgICAgICAgICBoYXNCdG46IGZhbHNlLFxuICAgICAgICAgICAgZGlyZWN0aW9uOiB0aGlzLm9wdGlvbnMuZGlyZWN0aW9uLFxuICAgICAgICAgICAgc2xpZGVzTGFwczogW10sXG4gICAgICAgICAgICBsb2FkZXI6IG51bGxcbiAgICAgICAgfVxuICAgIH1cblxuXG5cbiAgICBQdXJlU2xpZGVyLnByb3RvdHlwZSA9IHtcbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucy5vbkJlZm9yZUluaXRDYih0aGlzKTtcbiAgICAgICAgICAgIHRoaXMudmFycy5zbGlkZXIgPSBlbGVtZW50O1xuICAgICAgICAgICAgdGhpcy52YXJzLnNsaWRlcyA9XG4gICAgICAgICAgICAgICAgW10uc2xpY2UuY2FsbChcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YXJzLnNsaWRlci5xdWVyeVNlbGVjdG9yKCcuJyArIHRoaXMub3B0aW9ucy5zbGlkZXNDbGFzc05hbWUpLmNoaWxkcmVuXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHRoaXMudmFycy5tYXggPSAodGhpcy52YXJzLnNsaWRlcy5sZW5ndGggLSAxKTtcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlTG9hZGVyKCk7XG4gICAgICAgICAgICB2YXIgdG90YWxMb2FkZWQgPSAwLCBzZWxmID0gdGhpcywgdG90YWxUb0xvYWQgPSB0aGlzLnZhcnMuc2xpZGVzLmxlbmd0aDtcbiAgICAgICAgICAgIHRoaXMudmFycy5zbGlkZXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwgaWR4KSB7XG4gICAgICAgICAgICAgICAgdmFyIGltZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xuICAgICAgICAgICAgICAgIGltZy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaW1nID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgdG90YWxMb2FkZWQrKztcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRvdGFsTG9hZGVkID09IHRvdGFsVG9Mb2FkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmluaXRBZnRlckxvYWRpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGltZy5zcmMgPSBnZXRDb21wdXRlZFN0eWxlKGl0ZW0pLmJhY2tncm91bmRJbWFnZS5zbGljZSg0LCAtMSkucmVwbGFjZSgvXCIvZywgXCJcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgY3JlYXRlTG9hZGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLnZhcnMubG9hZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICB0aGlzLnZhcnMubG9hZGVyLmlubmVySFRNTCA9ICc8ZGl2IGNsYXNzPVwicHMtZG91YmxlLWJvdW5jZTFcIj48L2Rpdj48ZGl2IGNsYXNzPVwicHMtZG91YmxlLWJvdW5jZTJcIj48L2Rpdj4nO1xuICAgICAgICAgICAgdGhpcy52YXJzLmxvYWRlci5jbGFzc0xpc3QuYWRkKCdwcy1sb2FkZXInKTtcbiAgICAgICAgICAgIHRoaXMudmFycy5zbGlkZXIuYXBwZW5kQ2hpbGQodGhpcy52YXJzLmxvYWRlcik7XG4gICAgICAgIH0sXG4gICAgICAgIGRlc3Ryb3lMb2FkZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMudmFycy5zbGlkZXIucmVtb3ZlQ2hpbGQodGhpcy52YXJzLmxvYWRlcik7XG4gICAgICAgICAgICB0aGlzLnZhcnMubG9hZGVyID0gbnVsbDtcbiAgICAgICAgfSxcbiAgICAgICAgaW5pdEFmdGVyTG9hZGluZzogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5kZXN0cm95TG9hZGVyKCk7XG4gICAgICAgICAgICB0aGlzLnZhcnMuc2xpZGVzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0sIGlkeCkge1xuICAgICAgICAgICAgICAgIGlmIChpdGVtLmNsYXNzTGlzdC5jb250YWlucyh0aGlzLm9wdGlvbnMuY3VycmVudFNsaWRlQ2xhc3NOYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy52YXJzLmN1cnJlbnREZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5vcHRpb25zLmN1cnJlbnRTbGlkZUNsYXNzTmFtZSlcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmFycy5jdXJyZW50RGVmaW5lZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZhcnMuaW5kZXggPSBpZHg7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZhcnMuY3VycmVudFNsaWRlID0gaXRlbTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoaXRlbS5oYXNBdHRyaWJ1dGUoJ2RhdGEtc2xpZGUtbGFwcycpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmFycy5zbGlkZXNMYXBzLnB1c2goKHBhcnNlSW50KGl0ZW0uZ2V0QXR0cmlidXRlKCdkYXRhLXNsaWRlLWxhcHMnKSkgKiAxMDAwKSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YXJzLnNsaWRlc0xhcHMucHVzaCh0aGlzLm9wdGlvbnMubGFwcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgdGhpcyk7XG4gICAgICAgICAgICBpZiAoIXRoaXMudmFycy5jdXJyZW50RGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHRoaXMudmFycy5zbGlkZXNbMF0uY2xhc3NMaXN0LmFkZCh0aGlzLm9wdGlvbnMuY3VycmVudFNsaWRlQ2xhc3NOYW1lKTtcbiAgICAgICAgICAgICAgICB0aGlzLnZhcnMuY3VycmVudFNsaWRlID0gdGhpcy52YXJzLnNsaWRlc1swXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuc2hvd0J0bikge1xuICAgICAgICAgICAgICAgIHRoaXMuYnVpbGRCdG4oKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy52YXJzLmhhc0J0bikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmluaXRCdG5FdmVudHMoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLnNob3dOYXYpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmJ1aWxkTmF2KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmF1dG9wbGF5KSB7XG4gICAgICAgICAgICAgICAgdGhpcy52YXJzLnJvdGF0ZSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNldFN0b3BPbkhvdmVyKCk7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0KCk7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMub25BZnRlckluaXRDYih0aGlzKTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0U3RvcE9uSG92ZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuc3RvcE9uSG92ZXIgJiYgdGhpcy5vcHRpb25zLmF1dG9wbGF5KSB7XG4gICAgICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXMudmFycy5zbGlkZXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsIGZ1bmN0aW9uIChldnQpIHtcbiAgICAgICAgICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc3RvcCgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMudmFycy5zbGlkZXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIGZ1bmN0aW9uIChldnQpIHtcbiAgICAgICAgICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0byA9IHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQodG8pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYudmFycy5kaXJlY3Rpb24gPT09ICdmb3J3YXJkJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubmV4dCh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5wcmV2KHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LCBzZWxmLm9wdGlvbnMubGFwcyAvIDIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBidWlsZEJ0bjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy52YXJzLnByZXZCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICAgICAgICAgIHRoaXMudmFycy5wcmV2QnRuLmlubmVySFRNTCA9IHRoaXMub3B0aW9ucy5wcmV2QnRuSHRtbDtcbiAgICAgICAgICAgIHRoaXMudmFycy5wcmV2QnRuLmNsYXNzTGlzdC5hZGQodGhpcy5vcHRpb25zLnByZXZCdG5DbGFzc05hbWUpO1xuICAgICAgICAgICAgdGhpcy52YXJzLnNsaWRlci5hcHBlbmRDaGlsZCh0aGlzLnZhcnMucHJldkJ0bik7XG4gICAgICAgICAgICB0aGlzLnZhcnMubmV4dEJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgICAgICAgICAgdGhpcy52YXJzLm5leHRCdG4uaW5uZXJIVE1MID0gdGhpcy5vcHRpb25zLm5leHRCdG5IdG1sO1xuICAgICAgICAgICAgdGhpcy52YXJzLm5leHRCdG4uY2xhc3NMaXN0LmFkZCh0aGlzLm9wdGlvbnMubmV4dEJ0bkNsYXNzTmFtZSk7XG4gICAgICAgICAgICB0aGlzLnZhcnMuc2xpZGVyLmFwcGVuZENoaWxkKHRoaXMudmFycy5uZXh0QnRuKTtcbiAgICAgICAgICAgIHRoaXMudmFycy5oYXNCdG4gPSB0cnVlO1xuICAgICAgICB9LFxuICAgICAgICBidWlsZE5hdjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgZGl2LmNsYXNzTGlzdC5hZGQodGhpcy5vcHRpb25zLnNsaWRlck5hdkNsYXNzTmFtZSk7XG4gICAgICAgICAgICB2YXIgdWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd1bCcpO1xuICAgICAgICAgICAgdGhpcy52YXJzLnNsaWRlcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBpZHgpIHtcbiAgICAgICAgICAgICAgICB2YXIgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xuICAgICAgICAgICAgICAgIHZhciBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuICAgICAgICAgICAgICAgIGlmIChpdGVtLmNsYXNzTGlzdC5jb250YWlucyh0aGlzLm9wdGlvbnMuY3VycmVudFNsaWRlQ2xhc3NOYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICBhLmNsYXNzTGlzdC5hZGQodGhpcy5vcHRpb25zLmN1cnJlbnRDdXJzb3JDbGFzc05hbWUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhcnMuY3VycmVudEN1cnNvciA9IGE7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmFycy5pbmRleCA9IGlkeDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMub25DbGlja0N1cnNvckV2ZW50LmJpbmQodGhpcykpO1xuICAgICAgICAgICAgICAgIHRoaXMudmFycy5jdXJzb3JzLnB1c2goYSk7XG4gICAgICAgICAgICAgICAgbGkuYXBwZW5kQ2hpbGQoYSk7XG4gICAgICAgICAgICAgICAgdWwuYXBwZW5kQ2hpbGQobGkpO1xuICAgICAgICAgICAgfSwgdGhpcyk7XG4gICAgICAgICAgICBkaXYuYXBwZW5kQ2hpbGQodWwpO1xuICAgICAgICAgICAgdGhpcy52YXJzLnNsaWRlci5hcHBlbmRDaGlsZChkaXYpO1xuICAgICAgICAgICAgdGhpcy52YXJzLmhhc05hdiA9IHRydWU7XG4gICAgICAgIH0sXG4gICAgICAgIGluaXRCdG5FdmVudHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMudmFycy5uZXh0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2dCkge1xuICAgICAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIHNlbGYubmV4dCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLnZhcnMucHJldkJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChldnQpIHtcbiAgICAgICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICBzZWxmLnByZXYoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBvbkNsaWNrQ3Vyc29yRXZlbnQ6IGZ1bmN0aW9uIChldnQpIHtcbiAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdGhpcy5zdG9wKCk7XG4gICAgICAgICAgICB2YXIgdCA9IGV2dC50YXJnZXQ7XG4gICAgICAgICAgICB2YXIgaWR4ID0gdGhpcy52YXJzLmN1cnNvcnMuaW5kZXhPZih0KTtcbiAgICAgICAgICAgIHRoaXMuZ290b1NsaWRlKGlkeCk7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0KCk7XG4gICAgICAgIH0sXG4gICAgICAgIGdvdG9TbGlkZTogZnVuY3Rpb24gKGlkeCkge1xuICAgICAgICAgICAgaWYgKGlkeCA9PT0gbnVsbCB8fCBpZHggPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgaWR4ID0gdGhpcy52YXJzLmluZGV4O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMudmFycy5zbGlkZXNbaWR4XSAmJiB0aGlzLnZhcnMuY3VycmVudFNsaWRlICE9PSB0aGlzLnZhcnMuc2xpZGVzW2lkeF0pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnZhcnMuaW5kZXggPSBpZHg7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudmFycy5oYXNOYXYpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YXJzLmN1cnJlbnRDdXJzb3IuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLm9wdGlvbnMuY3VycmVudEN1cnNvckNsYXNzTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmFycy5jdXJyZW50Q3Vyc29yID0gdGhpcy52YXJzLmN1cnNvcnNbdGhpcy52YXJzLmluZGV4XTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YXJzLmN1cnJlbnRDdXJzb3IuY2xhc3NMaXN0LmFkZCh0aGlzLm9wdGlvbnMuY3VycmVudEN1cnNvckNsYXNzTmFtZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMudmFycy5jdXJyZW50U2xpZGUuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLm9wdGlvbnMuY3VycmVudFNsaWRlQ2xhc3NOYW1lKTtcbiAgICAgICAgICAgICAgICB0aGlzLnZhcnMuY3VycmVudFNsaWRlID0gdGhpcy52YXJzLnNsaWRlc1t0aGlzLnZhcnMuaW5kZXhdO1xuICAgICAgICAgICAgICAgIHRoaXMudmFycy5jdXJyZW50U2xpZGUuY2xhc3NMaXN0LmFkZCh0aGlzLm9wdGlvbnMuY3VycmVudFNsaWRlQ2xhc3NOYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgbmV4dDogZnVuY3Rpb24gKHJvdGF0ZSkge1xuICAgICAgICAgICAgdGhpcy5zdG9wKCk7XG4gICAgICAgICAgICBpZiAocm90YXRlID09PSBudWxsIHx8IHJvdGF0ZSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByb3RhdGUgPSB0aGlzLnZhcnMucm90YXRlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnZhcnMuaW5kZXggKz0gMTtcbiAgICAgICAgICAgIGlmICh0aGlzLnZhcnMuaW5kZXggPiB0aGlzLnZhcnMubWF4KSB7XG4gICAgICAgICAgICAgICAgaWYgKHJvdGF0ZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhcnMuaW5kZXggPSAwO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmFycy5pbmRleCA9IHRoaXMudmFycy5tYXg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5nb3RvU2xpZGUoKTtcbiAgICAgICAgICAgIHRoaXMuc3RhcnQoKTtcbiAgICAgICAgfSxcbiAgICAgICAgcHJldjogZnVuY3Rpb24gKHJvdGF0ZSkge1xuICAgICAgICAgICAgdGhpcy5zdG9wKCk7XG4gICAgICAgICAgICBpZiAocm90YXRlID09PSBudWxsIHx8IHJvdGF0ZSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByb3RhdGUgPSB0aGlzLnZhcnMucm90YXRlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnZhcnMuaW5kZXggLT0gMTtcbiAgICAgICAgICAgIGlmICh0aGlzLnZhcnMuaW5kZXggPCAwKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJvdGF0ZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhcnMuaW5kZXggPSB0aGlzLnZhcnMubWF4O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmFycy5pbmRleCA9IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5nb3RvU2xpZGUoKTtcbiAgICAgICAgICAgIHRoaXMuc3RhcnQoKTtcbiAgICAgICAgfSxcbiAgICAgICAgc3RhcnQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5vcHRpb25zLmF1dG9wbGF5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5vcHRpb25zLm9uQmVmb3JlU3RhcnRDYih0aGlzKTtcbiAgICAgICAgICAgIHRoaXMudmFycy5pc1N0YXJ0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgdGhpcy52YXJzLmludGVydmFsID0gd2luZG93LnNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi52YXJzLmRpcmVjdGlvbiA9PT0gJ2ZvcndhcmQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYubmV4dChzZWxmLnZhcnMucm90YXRlKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLnByZXYoc2VsZi52YXJzLnJvdGF0ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHNlbGYub3B0aW9ucy5vbkFmdGVyU3RhcnRDYih0aGlzKTtcbiAgICAgICAgICAgIH0sIHRoaXMudmFycy5zbGlkZXNMYXBzW3RoaXMudmFycy5pbmRleF0pO1xuICAgICAgICB9LFxuICAgICAgICBzdG9wOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMub25CZWZvcmVTdG9wQ2IodGhpcyk7XG4gICAgICAgICAgICB0aGlzLnZhcnMuaXNTdGFydGVkID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAodGhpcy52YXJzLmludGVydmFsICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuY2xlYXJJbnRlcnZhbCh0aGlzLnZhcnMuaW50ZXJ2YWwpO1xuICAgICAgICAgICAgICAgIHRoaXMudmFycy5pbnRlcnZhbCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMub25BZnRlclN0b3BDYih0aGlzKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIFB1cmVTbGlkZXI7XG59KSgpOyJdfQ==
